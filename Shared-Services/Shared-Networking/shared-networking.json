{
  "$schema": "https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "metadata": {
    "_generator": {
      "name": "bicep",
      "version": "0.28.1.47646",
      "templateHash": "13221918787732493381"
    }
  },
  "parameters": {
    "tstenv": {
      "type": "string"
    },
    "envshared": {
      "type": "string",
      "defaultValue": "shared"
    },
    "rg_shared_monitoring": {
      "type": "string"
    },
    "ukslocation": {
      "type": "string"
    },
    "plspringapplbnametst": {
      "type": "string"
    },
    "plspringapplbnameuat": {
      "type": "string"
    },
    "plspringapplbnametrn": {
      "type": "string"
    },
    "plspringapplbnameprod": {
      "type": "string"
    },
    "sharedmonitorsubscription": {
      "type": "string"
    },
    "rg_virtual_network": {
      "type": "string"
    },
    "sharedgateway": {
      "type": "string"
    },
    "tstrgvirtualnetworking": {
      "type": "string"
    },
    "tstsubscription": {
      "type": "string"
    },
    "uatrgvirtualnetworking": {
      "type": "string"
    },
    "uatsubscription": {
      "type": "string"
    },
    "trnrgvirtualnetworking": {
      "type": "string"
    },
    "trnsubscription": {
      "type": "string"
    },
    "prodrgvirtualnetworking": {
      "type": "string"
    },
    "prodsubscription": {
      "type": "string"
    },
    "waftstname": {
      "type": "string"
    },
    "wafuatname": {
      "type": "string"
    },
    "waftrnname": {
      "type": "string"
    },
    "wafprodname": {
      "type": "string"
    },
    "IPAllowListTEST": {
      "type": "array"
    },
    "IPAllowListUAT": {
      "type": "array"
    },
    "IPAllowListTRN": {
      "type": "array"
    },
    "IPAllowListPROD": {
      "type": "array"
    }
  },
  "resources": [
    {
      "type": "Microsoft.Resources/deployments",
      "apiVersion": "2022-09-01",
      "name": "[format('lawop{0}{1}-001', parameters('tstenv'), uniqueString(deployment().name))]",
      "location": "[deployment().location]",
      "properties": {
        "expressionEvaluationOptions": {
          "scope": "inner"
        },
        "mode": "Incremental",
        "parameters": {
          "sharedmonitorsubscription": {
            "value": "[parameters('sharedmonitorsubscription')]"
          },
          "sharedenv": {
            "value": "[parameters('envshared')]"
          },
          "rg_shared_monitoring": {
            "value": "[parameters('rg_shared_monitoring')]"
          },
          "ukslocation": {
            "value": "[parameters('ukslocation')]"
          }
        },
        "template": {
          "$schema": "https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#",
          "contentVersion": "1.0.0.0",
          "metadata": {
            "_generator": {
              "name": "bicep",
              "version": "0.28.1.47646",
              "templateHash": "12061769525881014537"
            }
          },
          "parameters": {
            "sharedenv": {
              "type": "string"
            },
            "ukslocation": {
              "type": "string"
            },
            "rg_shared_monitoring": {
              "type": "string"
            },
            "sharedmonitorsubscription": {
              "type": "string"
            }
          },
          "resources": [
            {
              "type": "Microsoft.Resources/deployments",
              "apiVersion": "2022-09-01",
              "name": "[format('lawop{0}{1}', parameters('sharedenv'), uniqueString(deployment().name))]",
              "subscriptionId": "[parameters('sharedmonitorsubscription')]",
              "resourceGroup": "[parameters('rg_shared_monitoring')]",
              "properties": {
                "expressionEvaluationOptions": {
                  "scope": "inner"
                },
                "mode": "Incremental",
                "parameters": {
                  "name": {
                    "value": "[format('law-{0}-operational-{1}', parameters('sharedenv'), parameters('ukslocation'))]"
                  },
                  "location": {
                    "value": "[parameters('ukslocation')]"
                  },
                  "useResourcePermissions": {
                    "value": true
                  }
                },
                "template": {
                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                  "contentVersion": "1.0.0.0",
                  "metadata": {
                    "_generator": {
                      "name": "bicep",
                      "version": "0.28.1.47646",
                      "templateHash": "15146090840060882086"
                    }
                  },
                  "parameters": {
                    "name": {
                      "type": "string",
                      "metadata": {
                        "description": "Required. Name of the Log Analytics workspace."
                      }
                    },
                    "location": {
                      "type": "string",
                      "defaultValue": "[resourceGroup().location]",
                      "metadata": {
                        "description": "Optional. Location for all resources."
                      }
                    },
                    "serviceTier": {
                      "type": "string",
                      "defaultValue": "PerGB2018",
                      "allowedValues": [
                        "Free",
                        "Standalone",
                        "PerNode",
                        "PerGB2018"
                      ],
                      "metadata": {
                        "description": "Optional. Service Tier: PerGB2018, Free, Standalone, PerGB or PerNode."
                      }
                    },
                    "storageInsightsConfigs": {
                      "type": "array",
                      "defaultValue": [],
                      "metadata": {
                        "description": "Optional. List of storage accounts to be read by the workspace."
                      }
                    },
                    "linkedServices": {
                      "type": "array",
                      "defaultValue": [],
                      "metadata": {
                        "description": "Optional. List of services to be linked."
                      }
                    },
                    "linkedStorageAccounts": {
                      "type": "array",
                      "defaultValue": [],
                      "metadata": {
                        "description": "Conditional. List of Storage Accounts to be linked. Required if 'forceCmkForQuery' is set to 'true' and 'savedSearches' is not empty."
                      }
                    },
                    "savedSearches": {
                      "type": "array",
                      "defaultValue": [],
                      "metadata": {
                        "description": "Optional. Kusto Query Language searches to save."
                      }
                    },
                    "dataSources": {
                      "type": "array",
                      "defaultValue": [],
                      "metadata": {
                        "description": "Optional. LAW data sources to configure."
                      }
                    },
                    "dataRetention": {
                      "type": "int",
                      "defaultValue": 365,
                      "minValue": 0,
                      "maxValue": 730,
                      "metadata": {
                        "description": "Optional. Number of days data will be retained for."
                      }
                    },
                    "dailyQuotaGb": {
                      "type": "int",
                      "defaultValue": -1,
                      "minValue": -1,
                      "metadata": {
                        "description": "Optional. The workspace daily quota for ingestion."
                      }
                    },
                    "publicNetworkAccessForIngestion": {
                      "type": "string",
                      "defaultValue": "Enabled",
                      "allowedValues": [
                        "Enabled",
                        "Disabled"
                      ],
                      "metadata": {
                        "description": "Optional. The network access type for accessing Log Analytics ingestion."
                      }
                    },
                    "publicNetworkAccessForQuery": {
                      "type": "string",
                      "defaultValue": "Enabled",
                      "allowedValues": [
                        "Enabled",
                        "Disabled"
                      ],
                      "metadata": {
                        "description": "Optional. The network access type for accessing Log Analytics query."
                      }
                    },
                    "useResourcePermissions": {
                      "type": "bool",
                      "defaultValue": false,
                      "metadata": {
                        "description": "Optional. Set to 'true' to use resource or workspace permissions and 'false' (or leave empty) to require workspace permissions."
                      }
                    },
                    "diagnosticLogsRetentionInDays": {
                      "type": "int",
                      "defaultValue": 365,
                      "minValue": 0,
                      "maxValue": 365,
                      "metadata": {
                        "description": "Optional. Specifies the number of days that logs will be kept for; a value of 0 will retain data indefinitely."
                      }
                    },
                    "diagnosticStorageAccountId": {
                      "type": "string",
                      "defaultValue": "",
                      "metadata": {
                        "description": "Optional. Resource ID of the diagnostic storage account."
                      }
                    },
                    "diagnosticWorkspaceId": {
                      "type": "string",
                      "defaultValue": "",
                      "metadata": {
                        "description": "Optional. Resource ID of a log analytics workspace."
                      }
                    },
                    "diagnosticEventHubAuthorizationRuleId": {
                      "type": "string",
                      "defaultValue": "",
                      "metadata": {
                        "description": "Optional. Resource ID of the diagnostic event hub authorization rule for the Event Hubs namespace in which the event hub should be created or streamed to."
                      }
                    },
                    "diagnosticEventHubName": {
                      "type": "string",
                      "defaultValue": "",
                      "metadata": {
                        "description": "Optional. Name of the diagnostic event hub within the namespace to which logs are streamed. Without this, an event hub is created for each log category."
                      }
                    },
                    "forceCmkForQuery": {
                      "type": "bool",
                      "defaultValue": true,
                      "metadata": {
                        "description": "Optional. Indicates whether customer managed storage is mandatory for query management."
                      }
                    },
                    "lock": {
                      "type": "string",
                      "defaultValue": "",
                      "allowedValues": [
                        "",
                        "CanNotDelete",
                        "ReadOnly"
                      ],
                      "metadata": {
                        "description": "Optional. Specify the type of lock."
                      }
                    },
                    "roleAssignments": {
                      "type": "array",
                      "defaultValue": [],
                      "metadata": {
                        "description": "Optional. Array of role assignment objects that contain the 'roleDefinitionIdOrName' and 'principalId' to define RBAC role assignments on this resource. In the roleDefinitionIdOrName attribute, you can provide either the display name of the role definition, or its fully qualified ID in the following format: '/providers/Microsoft.Authorization/roleDefinitions/c2f4ef07-c644-48eb-af81-4b1b4947fb11'."
                      }
                    },
                    "tags": {
                      "type": "object",
                      "defaultValue": {},
                      "metadata": {
                        "description": "Optional. Tags of the resource."
                      }
                    },
                    "enableDefaultTelemetry": {
                      "type": "bool",
                      "defaultValue": true,
                      "metadata": {
                        "description": "Optional. Enable telemetry via a Globally Unique Identifier (GUID)."
                      }
                    },
                    "diagnosticLogCategoriesToEnable": {
                      "type": "array",
                      "defaultValue": [
                        "allLogs"
                      ],
                      "allowedValues": [
                        "allLogs",
                        "Audit"
                      ],
                      "metadata": {
                        "description": "Optional. The name of logs that will be streamed. \"allLogs\" includes all possible logs for the resource."
                      }
                    },
                    "diagnosticMetricsToEnable": {
                      "type": "array",
                      "defaultValue": [
                        "AllMetrics"
                      ],
                      "allowedValues": [
                        "AllMetrics"
                      ],
                      "metadata": {
                        "description": "Optional. The name of metrics that will be streamed."
                      }
                    },
                    "diagnosticSettingsName": {
                      "type": "string",
                      "defaultValue": "[format('{0}-diagnosticSettings', parameters('name'))]",
                      "metadata": {
                        "description": "Optional. The name of the diagnostic setting, if deployed."
                      }
                    }
                  },
                  "variables": {
                    "copy": [
                      {
                        "name": "diagnosticsLogsSpecified",
                        "count": "[length(filter(parameters('diagnosticLogCategoriesToEnable'), lambda('item', not(equals(lambdaVariables('item'), 'allLogs')))))]",
                        "input": {
                          "category": "[filter(parameters('diagnosticLogCategoriesToEnable'), lambda('item', not(equals(lambdaVariables('item'), 'allLogs'))))[copyIndex('diagnosticsLogsSpecified')]]",
                          "enabled": true,
                          "retentionPolicy": {
                            "enabled": true,
                            "days": "[parameters('diagnosticLogsRetentionInDays')]"
                          }
                        }
                      },
                      {
                        "name": "diagnosticsMetrics",
                        "count": "[length(parameters('diagnosticMetricsToEnable'))]",
                        "input": {
                          "category": "[parameters('diagnosticMetricsToEnable')[copyIndex('diagnosticsMetrics')]]",
                          "timeGrain": null,
                          "enabled": true,
                          "retentionPolicy": {
                            "enabled": true,
                            "days": "[parameters('diagnosticLogsRetentionInDays')]"
                          }
                        }
                      }
                    ],
                    "diagnosticsLogs": "[if(contains(parameters('diagnosticLogCategoriesToEnable'), 'allLogs'), createArray(createObject('categoryGroup', 'allLogs', 'enabled', true(), 'retentionPolicy', createObject('enabled', true(), 'days', parameters('diagnosticLogsRetentionInDays')))), variables('diagnosticsLogsSpecified'))]",
                    "logAnalyticsSearchVersion": 1,
                    "enableReferencedModulesTelemetry": false
                  },
                  "resources": [
                    {
                      "condition": "[parameters('enableDefaultTelemetry')]",
                      "type": "Microsoft.Resources/deployments",
                      "apiVersion": "2021-04-01",
                      "name": "[format('pid-47ed15a6-730a-4827-bcb4-0fd963ffbd82-{0}', uniqueString(deployment().name, parameters('location')))]",
                      "properties": {
                        "mode": "Incremental",
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "resources": []
                        }
                      }
                    },
                    {
                      "type": "Microsoft.OperationalInsights/workspaces",
                      "apiVersion": "2021-06-01",
                      "name": "[parameters('name')]",
                      "location": "[parameters('location')]",
                      "tags": "[parameters('tags')]",
                      "properties": {
                        "features": {
                          "searchVersion": "[variables('logAnalyticsSearchVersion')]",
                          "enableLogAccessUsingOnlyResourcePermissions": "[parameters('useResourcePermissions')]"
                        },
                        "sku": {
                          "name": "[parameters('serviceTier')]"
                        },
                        "retentionInDays": "[parameters('dataRetention')]",
                        "workspaceCapping": {
                          "dailyQuotaGb": "[parameters('dailyQuotaGb')]"
                        },
                        "publicNetworkAccessForIngestion": "[parameters('publicNetworkAccessForIngestion')]",
                        "publicNetworkAccessForQuery": "[parameters('publicNetworkAccessForQuery')]",
                        "forceCmkForQuery": "[parameters('forceCmkForQuery')]"
                      }
                    },
                    {
                      "condition": "[or(or(or(not(empty(parameters('diagnosticStorageAccountId'))), not(empty(parameters('diagnosticWorkspaceId')))), not(empty(parameters('diagnosticEventHubAuthorizationRuleId')))), not(empty(parameters('diagnosticEventHubName'))))]",
                      "type": "Microsoft.Insights/diagnosticSettings",
                      "apiVersion": "2021-05-01-preview",
                      "scope": "[format('Microsoft.OperationalInsights/workspaces/{0}', parameters('name'))]",
                      "name": "[parameters('diagnosticSettingsName')]",
                      "properties": {
                        "storageAccountId": "[if(not(empty(parameters('diagnosticStorageAccountId'))), parameters('diagnosticStorageAccountId'), null())]",
                        "workspaceId": "[if(not(empty(parameters('diagnosticWorkspaceId'))), parameters('diagnosticWorkspaceId'), null())]",
                        "eventHubAuthorizationRuleId": "[if(not(empty(parameters('diagnosticEventHubAuthorizationRuleId'))), parameters('diagnosticEventHubAuthorizationRuleId'), null())]",
                        "eventHubName": "[if(not(empty(parameters('diagnosticEventHubName'))), parameters('diagnosticEventHubName'), null())]",
                        "metrics": "[variables('diagnosticsMetrics')]",
                        "logs": "[variables('diagnosticsLogs')]"
                      },
                      "dependsOn": [
                        "[resourceId('Microsoft.OperationalInsights/workspaces', parameters('name'))]"
                      ]
                    },
                    {
                      "condition": "[not(empty(parameters('lock')))]",
                      "type": "Microsoft.Authorization/locks",
                      "apiVersion": "2020-05-01",
                      "scope": "[format('Microsoft.OperationalInsights/workspaces/{0}', parameters('name'))]",
                      "name": "[format('{0}-{1}-lock', parameters('name'), parameters('lock'))]",
                      "properties": {
                        "level": "[parameters('lock')]",
                        "notes": "[if(equals(parameters('lock'), 'CanNotDelete'), 'Cannot delete resource or child resources.', 'Cannot modify the resource or child resources.')]"
                      },
                      "dependsOn": [
                        "[resourceId('Microsoft.OperationalInsights/workspaces', parameters('name'))]"
                      ]
                    },
                    {
                      "copy": {
                        "name": "logAnalyticsWorkspace_storageInsightConfigs",
                        "count": "[length(parameters('storageInsightsConfigs'))]"
                      },
                      "type": "Microsoft.Resources/deployments",
                      "apiVersion": "2022-09-01",
                      "name": "[format('{0}-LAW-StorageInsightsConfig-{1}', uniqueString(deployment().name, parameters('location')), copyIndex())]",
                      "properties": {
                        "expressionEvaluationOptions": {
                          "scope": "inner"
                        },
                        "mode": "Incremental",
                        "parameters": {
                          "logAnalyticsWorkspaceName": {
                            "value": "[parameters('name')]"
                          },
                          "containers": "[if(contains(parameters('storageInsightsConfigs')[copyIndex()], 'containers'), createObject('value', parameters('storageInsightsConfigs')[copyIndex()].containers), createObject('value', createArray()))]",
                          "tables": "[if(contains(parameters('storageInsightsConfigs')[copyIndex()], 'tables'), createObject('value', parameters('storageInsightsConfigs')[copyIndex()].tables), createObject('value', createArray()))]",
                          "storageAccountId": {
                            "value": "[parameters('storageInsightsConfigs')[copyIndex()].storageAccountId]"
                          },
                          "enableDefaultTelemetry": {
                            "value": "[variables('enableReferencedModulesTelemetry')]"
                          }
                        },
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "metadata": {
                            "_generator": {
                              "name": "bicep",
                              "version": "0.28.1.47646",
                              "templateHash": "15607679023597358838"
                            }
                          },
                          "parameters": {
                            "logAnalyticsWorkspaceName": {
                              "type": "string",
                              "metadata": {
                                "description": "Conditional. The name of the parent Log Analytics workspace. Required if the template is used in a standalone deployment."
                              }
                            },
                            "name": {
                              "type": "string",
                              "defaultValue": "[format('{0}-stinsconfig', last(split(parameters('storageAccountId'), '/')))]",
                              "metadata": {
                                "description": "Optional. The name of the storage insights config."
                              }
                            },
                            "storageAccountId": {
                              "type": "string",
                              "metadata": {
                                "description": "Required. The Azure Resource Manager ID of the storage account resource."
                              }
                            },
                            "containers": {
                              "type": "array",
                              "defaultValue": [],
                              "metadata": {
                                "description": "Optional. The names of the blob containers that the workspace should read."
                              }
                            },
                            "tables": {
                              "type": "array",
                              "defaultValue": [],
                              "metadata": {
                                "description": "Optional. The names of the Azure tables that the workspace should read."
                              }
                            },
                            "tags": {
                              "type": "object",
                              "defaultValue": {},
                              "metadata": {
                                "description": "Optional. Tags to configure in the resource."
                              }
                            },
                            "enableDefaultTelemetry": {
                              "type": "bool",
                              "defaultValue": true,
                              "metadata": {
                                "description": "Optional. Enable telemetry via a Globally Unique Identifier (GUID)."
                              }
                            }
                          },
                          "resources": [
                            {
                              "condition": "[parameters('enableDefaultTelemetry')]",
                              "type": "Microsoft.Resources/deployments",
                              "apiVersion": "2021-04-01",
                              "name": "[format('pid-47ed15a6-730a-4827-bcb4-0fd963ffbd82-{0}', uniqueString(deployment().name))]",
                              "properties": {
                                "mode": "Incremental",
                                "template": {
                                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                                  "contentVersion": "1.0.0.0",
                                  "resources": []
                                }
                              }
                            },
                            {
                              "type": "Microsoft.OperationalInsights/workspaces/storageInsightConfigs",
                              "apiVersion": "2020-08-01",
                              "name": "[format('{0}/{1}', parameters('logAnalyticsWorkspaceName'), parameters('name'))]",
                              "tags": "[parameters('tags')]",
                              "properties": {
                                "containers": "[parameters('containers')]",
                                "tables": "[parameters('tables')]",
                                "storageAccount": {
                                  "id": "[parameters('storageAccountId')]",
                                  "key": "[listKeys(resourceId('Microsoft.Storage/storageAccounts', parameters('storageAccountId')), '2021-06-01').keys[0].value]"
                                }
                              }
                            }
                          ],
                          "outputs": {
                            "resourceId": {
                              "type": "string",
                              "metadata": {
                                "description": "The resource ID of the deployed storage insights configuration."
                              },
                              "value": "[resourceId('Microsoft.OperationalInsights/workspaces/storageInsightConfigs', parameters('logAnalyticsWorkspaceName'), parameters('name'))]"
                            },
                            "resourceGroupName": {
                              "type": "string",
                              "metadata": {
                                "description": "The resource group where the storage insight configuration is deployed."
                              },
                              "value": "[resourceGroup().name]"
                            },
                            "name": {
                              "type": "string",
                              "metadata": {
                                "description": "The name of the storage insights configuration."
                              },
                              "value": "[parameters('name')]"
                            }
                          }
                        }
                      },
                      "dependsOn": [
                        "[resourceId('Microsoft.OperationalInsights/workspaces', parameters('name'))]"
                      ]
                    },
                    {
                      "copy": {
                        "name": "logAnalyticsWorkspace_linkedServices",
                        "count": "[length(parameters('linkedServices'))]"
                      },
                      "type": "Microsoft.Resources/deployments",
                      "apiVersion": "2022-09-01",
                      "name": "[format('{0}-LAW-LinkedService-{1}', uniqueString(deployment().name, parameters('location')), copyIndex())]",
                      "properties": {
                        "expressionEvaluationOptions": {
                          "scope": "inner"
                        },
                        "mode": "Incremental",
                        "parameters": {
                          "logAnalyticsWorkspaceName": {
                            "value": "[parameters('name')]"
                          },
                          "name": {
                            "value": "[parameters('linkedServices')[copyIndex()].name]"
                          },
                          "resourceId": "[if(contains(parameters('linkedServices')[copyIndex()], 'resourceId'), createObject('value', parameters('linkedServices')[copyIndex()].resourceId), createObject('value', ''))]",
                          "writeAccessResourceId": "[if(contains(parameters('linkedServices')[copyIndex()], 'writeAccessResourceId'), createObject('value', parameters('linkedServices')[copyIndex()].writeAccessResourceId), createObject('value', ''))]",
                          "enableDefaultTelemetry": {
                            "value": "[variables('enableReferencedModulesTelemetry')]"
                          }
                        },
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "metadata": {
                            "_generator": {
                              "name": "bicep",
                              "version": "0.28.1.47646",
                              "templateHash": "14730649560264099569"
                            }
                          },
                          "parameters": {
                            "logAnalyticsWorkspaceName": {
                              "type": "string",
                              "metadata": {
                                "description": "Conditional. The name of the parent Log Analytics workspace. Required if the template is used in a standalone deployment."
                              }
                            },
                            "name": {
                              "type": "string",
                              "metadata": {
                                "description": "Required. Name of the link."
                              }
                            },
                            "resourceId": {
                              "type": "string",
                              "defaultValue": "",
                              "metadata": {
                                "description": "Required. The resource ID of the resource that will be linked to the workspace. This should be used for linking resources which require read access."
                              }
                            },
                            "writeAccessResourceId": {
                              "type": "string",
                              "defaultValue": "",
                              "metadata": {
                                "description": "Optional. The resource ID of the resource that will be linked to the workspace. This should be used for linking resources which require write access."
                              }
                            },
                            "tags": {
                              "type": "object",
                              "defaultValue": {},
                              "metadata": {
                                "description": "Optional. Tags to configure in the resource."
                              }
                            },
                            "enableDefaultTelemetry": {
                              "type": "bool",
                              "defaultValue": true,
                              "metadata": {
                                "description": "Optional. Enable telemetry via a Globally Unique Identifier (GUID)."
                              }
                            }
                          },
                          "resources": [
                            {
                              "condition": "[parameters('enableDefaultTelemetry')]",
                              "type": "Microsoft.Resources/deployments",
                              "apiVersion": "2021-04-01",
                              "name": "[format('pid-47ed15a6-730a-4827-bcb4-0fd963ffbd82-{0}', uniqueString(deployment().name))]",
                              "properties": {
                                "mode": "Incremental",
                                "template": {
                                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                                  "contentVersion": "1.0.0.0",
                                  "resources": []
                                }
                              }
                            },
                            {
                              "type": "Microsoft.OperationalInsights/workspaces/linkedServices",
                              "apiVersion": "2020-08-01",
                              "name": "[format('{0}/{1}', parameters('logAnalyticsWorkspaceName'), parameters('name'))]",
                              "tags": "[parameters('tags')]",
                              "properties": {
                                "resourceId": "[parameters('resourceId')]",
                                "writeAccessResourceId": "[if(empty(parameters('writeAccessResourceId')), null(), parameters('writeAccessResourceId'))]"
                              }
                            }
                          ],
                          "outputs": {
                            "name": {
                              "type": "string",
                              "metadata": {
                                "description": "The name of the deployed linked service."
                              },
                              "value": "[parameters('name')]"
                            },
                            "resourceId": {
                              "type": "string",
                              "metadata": {
                                "description": "The resource ID of the deployed linked service."
                              },
                              "value": "[resourceId('Microsoft.OperationalInsights/workspaces/linkedServices', parameters('logAnalyticsWorkspaceName'), parameters('name'))]"
                            },
                            "resourceGroupName": {
                              "type": "string",
                              "metadata": {
                                "description": "The resource group where the linked service is deployed."
                              },
                              "value": "[resourceGroup().name]"
                            }
                          }
                        }
                      },
                      "dependsOn": [
                        "[resourceId('Microsoft.OperationalInsights/workspaces', parameters('name'))]"
                      ]
                    },
                    {
                      "copy": {
                        "name": "logAnalyticsWorkspace_linkedStorageAccounts",
                        "count": "[length(parameters('linkedStorageAccounts'))]"
                      },
                      "type": "Microsoft.Resources/deployments",
                      "apiVersion": "2022-09-01",
                      "name": "[format('{0}-LAW-LinkedStorageAccount-{1}', uniqueString(deployment().name, parameters('location')), copyIndex())]",
                      "properties": {
                        "expressionEvaluationOptions": {
                          "scope": "inner"
                        },
                        "mode": "Incremental",
                        "parameters": {
                          "logAnalyticsWorkspaceName": {
                            "value": "[parameters('name')]"
                          },
                          "name": {
                            "value": "[parameters('linkedStorageAccounts')[copyIndex()].name]"
                          },
                          "resourceId": {
                            "value": "[parameters('linkedStorageAccounts')[copyIndex()].resourceId]"
                          },
                          "enableDefaultTelemetry": {
                            "value": "[variables('enableReferencedModulesTelemetry')]"
                          }
                        },
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "metadata": {
                            "_generator": {
                              "name": "bicep",
                              "version": "0.28.1.47646",
                              "templateHash": "412603605365296382"
                            }
                          },
                          "parameters": {
                            "logAnalyticsWorkspaceName": {
                              "type": "string",
                              "metadata": {
                                "description": "Conditional. The name of the parent Log Analytics workspace. Required if the template is used in a standalone deployment."
                              }
                            },
                            "name": {
                              "type": "string",
                              "allowedValues": [
                                "Query",
                                "Alerts",
                                "CustomLogs",
                                "AzureWatson"
                              ],
                              "metadata": {
                                "description": "Required. Name of the link."
                              }
                            },
                            "resourceId": {
                              "type": "string",
                              "metadata": {
                                "description": "Required. The resource ID of the resource that will be linked to the workspace. This should be used for linking resources which require read access."
                              }
                            },
                            "enableDefaultTelemetry": {
                              "type": "bool",
                              "defaultValue": true,
                              "metadata": {
                                "description": "Optional. Enable telemetry via a Globally Unique Identifier (GUID)."
                              }
                            }
                          },
                          "resources": [
                            {
                              "condition": "[parameters('enableDefaultTelemetry')]",
                              "type": "Microsoft.Resources/deployments",
                              "apiVersion": "2021-04-01",
                              "name": "[format('pid-47ed15a6-730a-4827-bcb4-0fd963ffbd82-{0}', uniqueString(deployment().name))]",
                              "properties": {
                                "mode": "Incremental",
                                "template": {
                                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                                  "contentVersion": "1.0.0.0",
                                  "resources": []
                                }
                              }
                            },
                            {
                              "type": "Microsoft.OperationalInsights/workspaces/linkedStorageAccounts",
                              "apiVersion": "2020-08-01",
                              "name": "[format('{0}/{1}', parameters('logAnalyticsWorkspaceName'), parameters('name'))]",
                              "properties": {
                                "storageAccountIds": [
                                  "[parameters('resourceId')]"
                                ]
                              }
                            }
                          ],
                          "outputs": {
                            "name": {
                              "type": "string",
                              "metadata": {
                                "description": "The name of the deployed linked storage account."
                              },
                              "value": "[parameters('name')]"
                            },
                            "resourceId": {
                              "type": "string",
                              "metadata": {
                                "description": "The resource ID of the deployed linked storage account."
                              },
                              "value": "[resourceId('Microsoft.OperationalInsights/workspaces/linkedStorageAccounts', parameters('logAnalyticsWorkspaceName'), parameters('name'))]"
                            },
                            "resourceGroupName": {
                              "type": "string",
                              "metadata": {
                                "description": "The resource group where the linked storage account is deployed."
                              },
                              "value": "[resourceGroup().name]"
                            }
                          }
                        }
                      },
                      "dependsOn": [
                        "[resourceId('Microsoft.OperationalInsights/workspaces', parameters('name'))]"
                      ]
                    },
                    {
                      "copy": {
                        "name": "logAnalyticsWorkspace_savedSearches",
                        "count": "[length(parameters('savedSearches'))]"
                      },
                      "type": "Microsoft.Resources/deployments",
                      "apiVersion": "2022-09-01",
                      "name": "[format('{0}-LAW-SavedSearch-{1}', uniqueString(deployment().name, parameters('location')), copyIndex())]",
                      "properties": {
                        "expressionEvaluationOptions": {
                          "scope": "inner"
                        },
                        "mode": "Incremental",
                        "parameters": {
                          "logAnalyticsWorkspaceName": {
                            "value": "[parameters('name')]"
                          },
                          "name": {
                            "value": "[format('{0}{1}', parameters('savedSearches')[copyIndex()].name, uniqueString(deployment().name))]"
                          },
                          "displayName": {
                            "value": "[parameters('savedSearches')[copyIndex()].displayName]"
                          },
                          "category": {
                            "value": "[parameters('savedSearches')[copyIndex()].category]"
                          },
                          "query": {
                            "value": "[parameters('savedSearches')[copyIndex()].query]"
                          },
                          "functionAlias": "[if(contains(parameters('savedSearches')[copyIndex()], 'functionAlias'), createObject('value', parameters('savedSearches')[copyIndex()].functionAlias), createObject('value', ''))]",
                          "functionParameters": "[if(contains(parameters('savedSearches')[copyIndex()], 'functionParameters'), createObject('value', parameters('savedSearches')[copyIndex()].functionParameters), createObject('value', ''))]",
                          "version": "[if(contains(parameters('savedSearches')[copyIndex()], 'version'), createObject('value', parameters('savedSearches')[copyIndex()].version), createObject('value', 2))]",
                          "enableDefaultTelemetry": {
                            "value": "[variables('enableReferencedModulesTelemetry')]"
                          }
                        },
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "metadata": {
                            "_generator": {
                              "name": "bicep",
                              "version": "0.28.1.47646",
                              "templateHash": "6490007951033619489"
                            }
                          },
                          "parameters": {
                            "logAnalyticsWorkspaceName": {
                              "type": "string",
                              "metadata": {
                                "description": "Conditional. The name of the parent Log Analytics workspace. Required if the template is used in a standalone deployment."
                              }
                            },
                            "name": {
                              "type": "string",
                              "metadata": {
                                "description": "Required. Name of the saved search."
                              }
                            },
                            "displayName": {
                              "type": "string",
                              "metadata": {
                                "description": "Required. Display name for the search."
                              }
                            },
                            "category": {
                              "type": "string",
                              "metadata": {
                                "description": "Required. Query category."
                              }
                            },
                            "query": {
                              "type": "string",
                              "metadata": {
                                "description": "Required. Kusto Query to be stored."
                              }
                            },
                            "tags": {
                              "type": "array",
                              "defaultValue": [],
                              "metadata": {
                                "description": "Optional. Tags to configure in the resource."
                              }
                            },
                            "functionAlias": {
                              "type": "string",
                              "defaultValue": "",
                              "metadata": {
                                "description": "Optional. The function alias if query serves as a function."
                              }
                            },
                            "functionParameters": {
                              "type": "string",
                              "defaultValue": "",
                              "metadata": {
                                "description": "Optional. The optional function parameters if query serves as a function. Value should be in the following format: \"param-name1:type1 = default_value1, param-name2:type2 = default_value2\". For more examples and proper syntax please refer to /azure/kusto/query/functions/user-defined-functions."
                              }
                            },
                            "version": {
                              "type": "int",
                              "defaultValue": 2,
                              "metadata": {
                                "description": "Optional. The version number of the query language."
                              }
                            },
                            "enableDefaultTelemetry": {
                              "type": "bool",
                              "defaultValue": true,
                              "metadata": {
                                "description": "Optional. Enable telemetry via a Globally Unique Identifier (GUID)."
                              }
                            }
                          },
                          "resources": [
                            {
                              "condition": "[parameters('enableDefaultTelemetry')]",
                              "type": "Microsoft.Resources/deployments",
                              "apiVersion": "2021-04-01",
                              "name": "[format('pid-47ed15a6-730a-4827-bcb4-0fd963ffbd82-{0}', uniqueString(deployment().name))]",
                              "properties": {
                                "mode": "Incremental",
                                "template": {
                                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                                  "contentVersion": "1.0.0.0",
                                  "resources": []
                                }
                              }
                            },
                            {
                              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
                              "apiVersion": "2020-08-01",
                              "name": "[format('{0}/{1}', parameters('logAnalyticsWorkspaceName'), parameters('name'))]",
                              "properties": {
                                "tags": "[parameters('tags')]",
                                "displayName": "[parameters('displayName')]",
                                "category": "[parameters('category')]",
                                "query": "[parameters('query')]",
                                "functionAlias": "[parameters('functionAlias')]",
                                "functionParameters": "[parameters('functionParameters')]",
                                "version": "[parameters('version')]"
                              }
                            }
                          ],
                          "outputs": {
                            "resourceId": {
                              "type": "string",
                              "metadata": {
                                "description": "The resource ID of the deployed saved search."
                              },
                              "value": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('logAnalyticsWorkspaceName'), parameters('name'))]"
                            },
                            "resourceGroupName": {
                              "type": "string",
                              "metadata": {
                                "description": "The resource group where the saved search is deployed."
                              },
                              "value": "[resourceGroup().name]"
                            },
                            "name": {
                              "type": "string",
                              "metadata": {
                                "description": "The name of the deployed saved search."
                              },
                              "value": "[parameters('name')]"
                            }
                          }
                        }
                      },
                      "dependsOn": [
                        "[resourceId('Microsoft.OperationalInsights/workspaces', parameters('name'))]",
                        "logAnalyticsWorkspace_linkedStorageAccounts"
                      ]
                    },
                    {
                      "copy": {
                        "name": "logAnalyticsWorkspace_dataSources",
                        "count": "[length(parameters('dataSources'))]"
                      },
                      "type": "Microsoft.Resources/deployments",
                      "apiVersion": "2022-09-01",
                      "name": "[format('{0}-LAW-DataSource-{1}', uniqueString(deployment().name, parameters('location')), copyIndex())]",
                      "properties": {
                        "expressionEvaluationOptions": {
                          "scope": "inner"
                        },
                        "mode": "Incremental",
                        "parameters": {
                          "logAnalyticsWorkspaceName": {
                            "value": "[parameters('name')]"
                          },
                          "name": {
                            "value": "[parameters('dataSources')[copyIndex()].name]"
                          },
                          "kind": {
                            "value": "[parameters('dataSources')[copyIndex()].kind]"
                          },
                          "linkedResourceId": "[if(contains(parameters('dataSources')[copyIndex()], 'linkedResourceId'), createObject('value', parameters('dataSources')[copyIndex()].linkedResourceId), createObject('value', ''))]",
                          "eventLogName": "[if(contains(parameters('dataSources')[copyIndex()], 'eventLogName'), createObject('value', parameters('dataSources')[copyIndex()].eventLogName), createObject('value', ''))]",
                          "eventTypes": "[if(contains(parameters('dataSources')[copyIndex()], 'eventTypes'), createObject('value', parameters('dataSources')[copyIndex()].eventTypes), createObject('value', createArray()))]",
                          "objectName": "[if(contains(parameters('dataSources')[copyIndex()], 'objectName'), createObject('value', parameters('dataSources')[copyIndex()].objectName), createObject('value', ''))]",
                          "instanceName": "[if(contains(parameters('dataSources')[copyIndex()], 'instanceName'), createObject('value', parameters('dataSources')[copyIndex()].instanceName), createObject('value', ''))]",
                          "intervalSeconds": "[if(contains(parameters('dataSources')[copyIndex()], 'intervalSeconds'), createObject('value', parameters('dataSources')[copyIndex()].intervalSeconds), createObject('value', 60))]",
                          "counterName": "[if(contains(parameters('dataSources')[copyIndex()], 'counterName'), createObject('value', parameters('dataSources')[copyIndex()].counterName), createObject('value', ''))]",
                          "state": "[if(contains(parameters('dataSources')[copyIndex()], 'state'), createObject('value', parameters('dataSources')[copyIndex()].state), createObject('value', ''))]",
                          "syslogName": "[if(contains(parameters('dataSources')[copyIndex()], 'syslogName'), createObject('value', parameters('dataSources')[copyIndex()].syslogName), createObject('value', ''))]",
                          "syslogSeverities": "[if(contains(parameters('dataSources')[copyIndex()], 'syslogSeverities'), createObject('value', parameters('dataSources')[copyIndex()].syslogSeverities), createObject('value', createArray()))]",
                          "performanceCounters": "[if(contains(parameters('dataSources')[copyIndex()], 'performanceCounters'), createObject('value', parameters('dataSources')[copyIndex()].performanceCounters), createObject('value', createArray()))]",
                          "enableDefaultTelemetry": {
                            "value": "[variables('enableReferencedModulesTelemetry')]"
                          }
                        },
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "metadata": {
                            "_generator": {
                              "name": "bicep",
                              "version": "0.28.1.47646",
                              "templateHash": "11370690368196229535"
                            }
                          },
                          "parameters": {
                            "logAnalyticsWorkspaceName": {
                              "type": "string",
                              "metadata": {
                                "description": "Conditional. The name of the parent Log Analytics workspace. Required if the template is used in a standalone deployment."
                              }
                            },
                            "name": {
                              "type": "string",
                              "metadata": {
                                "description": "Required. Name of the solution."
                              }
                            },
                            "kind": {
                              "type": "string",
                              "defaultValue": "AzureActivityLog",
                              "allowedValues": [
                                "AzureActivityLog",
                                "WindowsEvent",
                                "WindowsPerformanceCounter",
                                "IISLogs",
                                "LinuxSyslog",
                                "LinuxSyslogCollection",
                                "LinuxPerformanceObject",
                                "LinuxPerformanceCollection"
                              ],
                              "metadata": {
                                "description": "Required. The kind of the DataSource."
                              }
                            },
                            "tags": {
                              "type": "object",
                              "defaultValue": {},
                              "metadata": {
                                "description": "Optional. Tags to configure in the resource."
                              }
                            },
                            "linkedResourceId": {
                              "type": "string",
                              "defaultValue": "",
                              "metadata": {
                                "description": "Optional. Resource ID of the resource to be linked."
                              }
                            },
                            "eventLogName": {
                              "type": "string",
                              "defaultValue": "",
                              "metadata": {
                                "description": "Optional. Windows event log name to configure when kind is WindowsEvent."
                              }
                            },
                            "eventTypes": {
                              "type": "array",
                              "defaultValue": [],
                              "metadata": {
                                "description": "Optional. Windows event types to configure when kind is WindowsEvent."
                              }
                            },
                            "objectName": {
                              "type": "string",
                              "defaultValue": "",
                              "metadata": {
                                "description": "Optional. Name of the object to configure when kind is WindowsPerformanceCounter or LinuxPerformanceObject."
                              }
                            },
                            "instanceName": {
                              "type": "string",
                              "defaultValue": "*",
                              "metadata": {
                                "description": "Optional. Name of the instance to configure when kind is WindowsPerformanceCounter or LinuxPerformanceObject."
                              }
                            },
                            "intervalSeconds": {
                              "type": "int",
                              "defaultValue": 60,
                              "metadata": {
                                "description": "Optional. Interval in seconds to configure when kind is WindowsPerformanceCounter or LinuxPerformanceObject."
                              }
                            },
                            "performanceCounters": {
                              "type": "array",
                              "defaultValue": [],
                              "metadata": {
                                "description": "Optional. List of counters to configure when the kind is LinuxPerformanceObject."
                              }
                            },
                            "counterName": {
                              "type": "string",
                              "defaultValue": "",
                              "metadata": {
                                "description": "Optional. Counter name to configure when kind is WindowsPerformanceCounter."
                              }
                            },
                            "state": {
                              "type": "string",
                              "defaultValue": "",
                              "metadata": {
                                "description": "Optional. State to configure when kind is IISLogs or LinuxSyslogCollection or LinuxPerformanceCollection."
                              }
                            },
                            "syslogName": {
                              "type": "string",
                              "defaultValue": "",
                              "metadata": {
                                "description": "Optional. System log to configure when kind is LinuxSyslog."
                              }
                            },
                            "syslogSeverities": {
                              "type": "array",
                              "defaultValue": [],
                              "metadata": {
                                "description": "Optional. Severities to configure when kind is LinuxSyslog."
                              }
                            },
                            "enableDefaultTelemetry": {
                              "type": "bool",
                              "defaultValue": true,
                              "metadata": {
                                "description": "Optional. Enable telemetry via a Globally Unique Identifier (GUID)."
                              }
                            }
                          },
                          "resources": [
                            {
                              "condition": "[parameters('enableDefaultTelemetry')]",
                              "type": "Microsoft.Resources/deployments",
                              "apiVersion": "2021-04-01",
                              "name": "[format('pid-47ed15a6-730a-4827-bcb4-0fd963ffbd82-{0}', uniqueString(deployment().name))]",
                              "properties": {
                                "mode": "Incremental",
                                "template": {
                                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                                  "contentVersion": "1.0.0.0",
                                  "resources": []
                                }
                              }
                            },
                            {
                              "type": "Microsoft.OperationalInsights/workspaces/dataSources",
                              "apiVersion": "2020-08-01",
                              "name": "[format('{0}/{1}', parameters('logAnalyticsWorkspaceName'), parameters('name'))]",
                              "kind": "[parameters('kind')]",
                              "tags": "[parameters('tags')]",
                              "properties": {
                                "linkedResourceId": "[if(and(not(empty(parameters('kind'))), equals(parameters('kind'), 'AzureActivityLog')), parameters('linkedResourceId'), null())]",
                                "eventLogName": "[if(and(not(empty(parameters('kind'))), equals(parameters('kind'), 'WindowsEvent')), parameters('eventLogName'), null())]",
                                "eventTypes": "[if(and(not(empty(parameters('kind'))), equals(parameters('kind'), 'WindowsEvent')), parameters('eventTypes'), null())]",
                                "objectName": "[if(and(not(empty(parameters('kind'))), or(equals(parameters('kind'), 'WindowsPerformanceCounter'), equals(parameters('kind'), 'LinuxPerformanceObject'))), parameters('objectName'), null())]",
                                "instanceName": "[if(and(not(empty(parameters('kind'))), or(equals(parameters('kind'), 'WindowsPerformanceCounter'), equals(parameters('kind'), 'LinuxPerformanceObject'))), parameters('instanceName'), null())]",
                                "intervalSeconds": "[if(and(not(empty(parameters('kind'))), or(equals(parameters('kind'), 'WindowsPerformanceCounter'), equals(parameters('kind'), 'LinuxPerformanceObject'))), parameters('intervalSeconds'), null())]",
                                "counterName": "[if(and(not(empty(parameters('kind'))), equals(parameters('kind'), 'WindowsPerformanceCounter')), parameters('counterName'), null())]",
                                "state": "[if(and(not(empty(parameters('kind'))), or(or(equals(parameters('kind'), 'IISLogs'), equals(parameters('kind'), 'LinuxSyslogCollection')), equals(parameters('kind'), 'LinuxPerformanceCollection'))), parameters('state'), null())]",
                                "syslogName": "[if(and(not(empty(parameters('kind'))), equals(parameters('kind'), 'LinuxSyslog')), parameters('syslogName'), null())]",
                                "syslogSeverities": "[if(and(not(empty(parameters('kind'))), or(equals(parameters('kind'), 'LinuxSyslog'), equals(parameters('kind'), 'LinuxPerformanceObject'))), parameters('syslogSeverities'), null())]",
                                "performanceCounters": "[if(and(not(empty(parameters('kind'))), equals(parameters('kind'), 'LinuxPerformanceObject')), parameters('performanceCounters'), null())]"
                              }
                            }
                          ],
                          "outputs": {
                            "resourceId": {
                              "type": "string",
                              "metadata": {
                                "description": "The resource ID of the deployed data source."
                              },
                              "value": "[resourceId('Microsoft.OperationalInsights/workspaces/dataSources', parameters('logAnalyticsWorkspaceName'), parameters('name'))]"
                            },
                            "resourceGroupName": {
                              "type": "string",
                              "metadata": {
                                "description": "The resource group where the data source is deployed."
                              },
                              "value": "[resourceGroup().name]"
                            },
                            "name": {
                              "type": "string",
                              "metadata": {
                                "description": "The name of the deployed data source."
                              },
                              "value": "[parameters('name')]"
                            }
                          }
                        }
                      },
                      "dependsOn": [
                        "[resourceId('Microsoft.OperationalInsights/workspaces', parameters('name'))]"
                      ]
                    },
                    {
                      "copy": {
                        "name": "logAnalyticsWorkspace_roleAssignments",
                        "count": "[length(parameters('roleAssignments'))]"
                      },
                      "type": "Microsoft.Resources/deployments",
                      "apiVersion": "2022-09-01",
                      "name": "[format('{0}-LAW-Rbac-{1}', uniqueString(deployment().name, parameters('location')), copyIndex())]",
                      "properties": {
                        "expressionEvaluationOptions": {
                          "scope": "inner"
                        },
                        "mode": "Incremental",
                        "parameters": {
                          "description": "[if(contains(parameters('roleAssignments')[copyIndex()], 'description'), createObject('value', parameters('roleAssignments')[copyIndex()].description), createObject('value', ''))]",
                          "principalIds": {
                            "value": "[parameters('roleAssignments')[copyIndex()].principalIds]"
                          },
                          "principalType": "[if(contains(parameters('roleAssignments')[copyIndex()], 'principalType'), createObject('value', parameters('roleAssignments')[copyIndex()].principalType), createObject('value', ''))]",
                          "roleDefinitionIdOrName": {
                            "value": "[parameters('roleAssignments')[copyIndex()].roleDefinitionIdOrName]"
                          },
                          "condition": "[if(contains(parameters('roleAssignments')[copyIndex()], 'condition'), createObject('value', parameters('roleAssignments')[copyIndex()].condition), createObject('value', ''))]",
                          "delegatedManagedIdentityResourceId": "[if(contains(parameters('roleAssignments')[copyIndex()], 'delegatedManagedIdentityResourceId'), createObject('value', parameters('roleAssignments')[copyIndex()].delegatedManagedIdentityResourceId), createObject('value', ''))]",
                          "resourceId": {
                            "value": "[resourceId('Microsoft.OperationalInsights/workspaces', parameters('name'))]"
                          }
                        },
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "metadata": {
                            "_generator": {
                              "name": "bicep",
                              "version": "0.28.1.47646",
                              "templateHash": "11191514442532176358"
                            }
                          },
                          "parameters": {
                            "principalIds": {
                              "type": "array",
                              "metadata": {
                                "description": "Required. The IDs of the principals to assign the role to."
                              }
                            },
                            "roleDefinitionIdOrName": {
                              "type": "string",
                              "metadata": {
                                "description": "Required. The name of the role to assign. If it cannot be found you can specify the role definition ID instead."
                              }
                            },
                            "resourceId": {
                              "type": "string",
                              "metadata": {
                                "description": "Required. The resource ID of the resource to apply the role assignment to."
                              }
                            },
                            "principalType": {
                              "type": "string",
                              "defaultValue": "",
                              "allowedValues": [
                                "ServicePrincipal",
                                "Group",
                                "User",
                                "ForeignGroup",
                                "Device",
                                ""
                              ],
                              "metadata": {
                                "description": "Optional. The principal type of the assigned principal ID."
                              }
                            },
                            "description": {
                              "type": "string",
                              "defaultValue": "",
                              "metadata": {
                                "description": "Optional. The description of the role assignment."
                              }
                            },
                            "condition": {
                              "type": "string",
                              "defaultValue": "",
                              "metadata": {
                                "description": "Optional. The conditions on the role assignment. This limits the resources it can be assigned to. e.g.: @Resource[Microsoft.Storage/storageAccounts/blobServices/containers:ContainerName] StringEqualsIgnoreCase \"foo_storage_container\"."
                              }
                            },
                            "conditionVersion": {
                              "type": "string",
                              "defaultValue": "2.0",
                              "allowedValues": [
                                "2.0"
                              ],
                              "metadata": {
                                "description": "Optional. Version of the condition."
                              }
                            },
                            "delegatedManagedIdentityResourceId": {
                              "type": "string",
                              "defaultValue": "",
                              "metadata": {
                                "description": "Optional. Id of the delegated managed identity resource."
                              }
                            }
                          },
                          "variables": {
                            "builtInRoleNames": {
                              "Automation Contributor": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', 'f353d9bd-d4a6-484e-a77a-8050b599b867')]",
                              "Contributor": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', 'b24988ac-6180-42a0-ab88-20f7382dd24c')]",
                              "Data Purger": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', '150f5e0c-0603-4f03-8c7f-cf70034c4e90')]",
                              "Log Analytics Contributor": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', '92aaf0da-9dab-42b6-94a3-d43ce8d16293')]",
                              "Log Analytics Reader": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', '73c42c96-874c-492b-b04d-ab87d138a893')]",
                              "Managed Application Contributor Role": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', '641177b8-a67a-45b9-a033-47bc880bb21e')]",
                              "Managed Application Operator Role": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', 'c7393b34-138c-406f-901b-d8cf2b17e6ae')]",
                              "Managed Applications Reader": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', 'b9331d33-8a36-4f8c-b097-4f54124fdb44')]",
                              "Microsoft Sentinel Contributor": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', 'ab8e14d6-4a74-4a29-9ba8-549422addade')]",
                              "Microsoft Sentinel Reader": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', '8d289c81-5878-46d4-8554-54e1e3d8b5cb')]",
                              "Microsoft Sentinel Responder": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', '3e150937-b8fe-4cfb-8069-0eaf05ecd056')]",
                              "Monitoring Contributor": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', '749f88d5-cbae-40b8-bcfc-e573ddc772fa')]",
                              "Monitoring Reader": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', '43d0d8ad-25c7-4714-9337-8ba259a9fe05')]",
                              "Owner": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', '8e3af657-a8ff-443c-a75c-2fe8c4bcb635')]",
                              "Reader": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', 'acdd72a7-3385-48ef-bd42-f606fba81ae7')]",
                              "Resource Policy Contributor": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', '36243c78-bf99-498c-9df9-86d9f8d28608')]",
                              "Role Based Access Control Administrator (Preview)": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', 'f58310d9-a9f6-439a-9e8d-f62e7b41a168')]",
                              "Security Admin": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', 'fb1c8493-542b-48eb-b624-b4c8fea62acd')]",
                              "Security Reader": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', '39bc4728-0917-49c7-9d2c-d95423bc2eb4')]",
                              "User Access Administrator": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', '18d7d88d-d35e-4fb5-a5c3-7773c20a72d9')]"
                            }
                          },
                          "resources": [
                            {
                              "copy": {
                                "name": "roleAssignment",
                                "count": "[length(parameters('principalIds'))]"
                              },
                              "type": "Microsoft.Authorization/roleAssignments",
                              "apiVersion": "2022-04-01",
                              "scope": "[format('Microsoft.OperationalInsights/workspaces/{0}', parameters('resourceId'))]",
                              "name": "[guid(resourceId('Microsoft.OperationalInsights/workspaces', parameters('resourceId')), parameters('principalIds')[copyIndex()], parameters('roleDefinitionIdOrName'))]",
                              "properties": {
                                "description": "[parameters('description')]",
                                "roleDefinitionId": "[if(contains(variables('builtInRoleNames'), parameters('roleDefinitionIdOrName')), variables('builtInRoleNames')[parameters('roleDefinitionIdOrName')], parameters('roleDefinitionIdOrName'))]",
                                "principalId": "[parameters('principalIds')[copyIndex()]]",
                                "principalType": "[if(not(empty(parameters('principalType'))), parameters('principalType'), null())]",
                                "condition": "[if(not(empty(parameters('condition'))), parameters('condition'), null())]",
                                "conditionVersion": "[if(and(not(empty(parameters('conditionVersion'))), not(empty(parameters('condition')))), parameters('conditionVersion'), null())]",
                                "delegatedManagedIdentityResourceId": "[if(not(empty(parameters('delegatedManagedIdentityResourceId'))), parameters('delegatedManagedIdentityResourceId'), null())]"
                              }
                            }
                          ]
                        }
                      },
                      "dependsOn": [
                        "[resourceId('Microsoft.OperationalInsights/workspaces', parameters('name'))]"
                      ]
                    }
                  ],
                  "outputs": {
                    "resourceId": {
                      "type": "string",
                      "metadata": {
                        "description": "The resource ID of the deployed log analytics workspace."
                      },
                      "value": "[resourceId('Microsoft.OperationalInsights/workspaces', parameters('name'))]"
                    },
                    "resourceGroupName": {
                      "type": "string",
                      "metadata": {
                        "description": "The resource group of the deployed log analytics workspace."
                      },
                      "value": "[resourceGroup().name]"
                    },
                    "name": {
                      "type": "string",
                      "metadata": {
                        "description": "The name of the deployed log analytics workspace."
                      },
                      "value": "[parameters('name')]"
                    },
                    "logAnalyticsWorkspaceId": {
                      "type": "string",
                      "metadata": {
                        "description": "The ID associated with the workspace."
                      },
                      "value": "[reference(resourceId('Microsoft.OperationalInsights/workspaces', parameters('name')), '2021-06-01').customerId]"
                    },
                    "location": {
                      "type": "string",
                      "metadata": {
                        "description": "The location the resource was deployed into."
                      },
                      "value": "[reference(resourceId('Microsoft.OperationalInsights/workspaces', parameters('name')), '2021-06-01', 'full').location]"
                    }
                  }
                }
              }
            }
          ],
          "outputs": {
            "lawop": {
              "type": "string",
              "metadata": {
                "description": "ResourceID for LAW operations"
              },
              "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('sharedmonitorsubscription'), parameters('rg_shared_monitoring')), 'Microsoft.Resources/deployments', format('lawop{0}{1}', parameters('sharedenv'), uniqueString(deployment().name))), '2022-09-01').outputs.resourceId.value]"
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Resources/deployments",
      "apiVersion": "2022-09-01",
      "name": "[format('{0}-vnet-shared-rg', uniqueString(deployment().name))]",
      "subscriptionId": "[parameters('sharedgateway')]",
      "location": "[deployment().location]",
      "properties": {
        "expressionEvaluationOptions": {
          "scope": "inner"
        },
        "mode": "Incremental",
        "parameters": {
          "name": {
            "value": "[parameters('rg_virtual_network')]"
          },
          "location": {
            "value": "[parameters('ukslocation')]"
          }
        },
        "template": {
          "$schema": "https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#",
          "contentVersion": "1.0.0.0",
          "metadata": {
            "_generator": {
              "name": "bicep",
              "version": "0.28.1.47646",
              "templateHash": "2991372656523395117"
            }
          },
          "parameters": {
            "name": {
              "type": "string",
              "metadata": {
                "description": "Required. The name of the Resource Group."
              }
            },
            "location": {
              "type": "string",
              "defaultValue": "[deployment().location]",
              "metadata": {
                "description": "Optional. Location of the Resource Group. It uses the deployment's location when not provided."
              }
            },
            "tags": {
              "type": "object",
              "defaultValue": {},
              "metadata": {
                "description": "Optional. Tags of the storage account resource."
              }
            },
            "managedBy": {
              "type": "string",
              "defaultValue": "",
              "metadata": {
                "description": "Optional. The ID of the resource that manages this resource group."
              }
            },
            "enableDefaultTelemetry": {
              "type": "bool",
              "defaultValue": true,
              "metadata": {
                "description": "Optional. Enable telemetry via a Globally Unique Identifier (GUID)."
              }
            }
          },
          "resources": [
            {
              "condition": "[parameters('enableDefaultTelemetry')]",
              "type": "Microsoft.Resources/deployments",
              "apiVersion": "2021-04-01",
              "name": "[format('pid-47ed15a6-730a-4827-bcb4-0fd963ffbd82-{0}', uniqueString(deployment().name, parameters('location')))]",
              "location": "[parameters('location')]",
              "properties": {
                "mode": "Incremental",
                "template": {
                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                  "contentVersion": "1.0.0.0",
                  "resources": []
                }
              }
            },
            {
              "type": "Microsoft.Resources/resourceGroups",
              "apiVersion": "2021-04-01",
              "name": "[parameters('name')]",
              "location": "[parameters('location')]",
              "tags": "[parameters('tags')]",
              "managedBy": "[parameters('managedBy')]",
              "properties": {}
            }
          ],
          "outputs": {
            "name": {
              "type": "string",
              "metadata": {
                "description": "The name of the resource group."
              },
              "value": "[parameters('name')]"
            },
            "resourceId": {
              "type": "string",
              "metadata": {
                "description": "The resource ID of the resource group."
              },
              "value": "[subscriptionResourceId('Microsoft.Resources/resourceGroups', parameters('name'))]"
            },
            "location": {
              "type": "string",
              "metadata": {
                "description": "The location the resource was deployed into."
              },
              "value": "[reference(subscriptionResourceId('Microsoft.Resources/resourceGroups', parameters('name')), '2021-04-01', 'full').location]"
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Resources/deployments",
      "apiVersion": "2022-09-01",
      "name": "[format('{0}-afd', uniqueString(deployment().name))]",
      "resourceGroup": "rg-frontdoor",
      "properties": {
        "expressionEvaluationOptions": {
          "scope": "inner"
        },
        "mode": "Incremental",
        "parameters": {
          "wafpolaristestid": {
            "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', subscription().subscriptionId, 'rg-frontdoor'), 'Microsoft.Resources/deployments', format('{0}-afdwafrules-{1}', uniqueString(deployment().name), parameters('envshared'))), '2022-09-01').outputs.wafpolicyidtest.value]"
          },
          "wafpolarisuatid": {
            "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', subscription().subscriptionId, 'rg-frontdoor'), 'Microsoft.Resources/deployments', format('{0}-afdwafrules-{1}', uniqueString(deployment().name), parameters('envshared'))), '2022-09-01').outputs.wafpolicytiduat.value]"
          },
          "wafpolaristrnid": {
            "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', subscription().subscriptionId, 'rg-frontdoor'), 'Microsoft.Resources/deployments', format('{0}-afdwafrules-{1}', uniqueString(deployment().name), parameters('envshared'))), '2022-09-01').outputs.wafpolicyidtrn.value]"
          },
          "wafpolarisprodid": {
            "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', subscription().subscriptionId, 'rg-frontdoor'), 'Microsoft.Resources/deployments', format('{0}-afdwafrules-{1}', uniqueString(deployment().name), parameters('envshared'))), '2022-09-01').outputs.wafpolicyidprod.value]"
          },
          "diagnosticWorkspaceId": {
            "value": "[reference(subscriptionResourceId('Microsoft.Resources/deployments', format('lawop{0}{1}-001', parameters('tstenv'), uniqueString(deployment().name))), '2022-09-01').outputs.lawop.value]"
          },
          "diagnosticWorkspaceIdAudit": {
            "value": "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', 'e7fe7e3e-7874-4903-87be-422595a82d07', 'it-dw-sentinel-logs-production-rg'), 'Microsoft.OperationalInsights/workspaces', 'm365azuresentinel-dw-prod-uks-la')]"
          },
          "profiles_afd_name": {
            "value": "afd-shared-production"
          },
          "privateLinkServices_pl_springapps_polaris_test_externalid": {
            "value": "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('tstsubscription'), parameters('tstrgvirtualnetworking')), 'Microsoft.Network/privateLinkServices', parameters('plspringapplbnametst'))]"
          },
          "privateLinkServices_pl_springapps_polaris_uat_externalid": {
            "value": "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('uatsubscription'), parameters('uatrgvirtualnetworking')), 'Microsoft.Network/privateLinkServices', parameters('plspringapplbnameuat'))]"
          },
          "privateLinkServices_pl_springapps_polaris_trn_externalid": {
            "value": "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('trnsubscription'), parameters('trnrgvirtualnetworking')), 'Microsoft.Network/privateLinkServices', parameters('plspringapplbnametrn'))]"
          },
          "privateLinkServices_pl_springapps_polaris_prod_externalid": {
            "value": "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('prodsubscription'), parameters('prodrgvirtualnetworking')), 'Microsoft.Network/privateLinkServices', parameters('plspringapplbnameprod'))]"
          }
        },
        "template": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "1.0.0.0",
          "metadata": {
            "_generator": {
              "name": "bicep",
              "version": "0.28.1.47646",
              "templateHash": "5102142905331943349"
            }
          },
          "parameters": {
            "profiles_afd_name": {
              "type": "string"
            },
            "privateLinkServices_pl_springapps_polaris_test_externalid": {
              "type": "string"
            },
            "privateLinkServices_pl_springapps_polaris_uat_externalid": {
              "type": "string"
            },
            "privateLinkServices_pl_springapps_polaris_trn_externalid": {
              "type": "string"
            },
            "privateLinkServices_pl_springapps_polaris_prod_externalid": {
              "type": "string"
            },
            "wafpolaristestid": {
              "type": "string"
            },
            "wafpolarisuatid": {
              "type": "string"
            },
            "wafpolaristrnid": {
              "type": "string"
            },
            "wafpolarisprodid": {
              "type": "string"
            },
            "diagnosticLogsRetentionInDays": {
              "type": "int",
              "defaultValue": 365,
              "minValue": 0,
              "maxValue": 365,
              "metadata": {
                "description": "Optional. Specifies the number of days that logs will be kept for; a value of 0 will retain data indefinitely."
              }
            },
            "diagnosticStorageAccountId": {
              "type": "string",
              "defaultValue": "",
              "metadata": {
                "description": "Optional. Resource ID of the diagnostic storage account. For security reasons, it is recommended to set diagnostic settings to send data to either storage account, log analytics workspace or event hub."
              }
            },
            "diagnosticWorkspaceId": {
              "type": "string",
              "defaultValue": "",
              "metadata": {
                "description": "Optional. Resource ID of the diagnostic log analytics workspace. For security reasons, it is recommended to set diagnostic settings to send data to either storage account, log analytics workspace or event hub."
              }
            },
            "diagnosticWorkspaceIdAudit": {
              "type": "string",
              "defaultValue": "",
              "metadata": {
                "description": "Optional. Resource ID of the diagnostic log analytics workspace. For security reasons, it is recommended to set diagnostic settings to send data to either storage account, log analytics workspace or event hub."
              }
            },
            "diagnosticEventHubAuthorizationRuleId": {
              "type": "string",
              "defaultValue": "",
              "metadata": {
                "description": "Optional. Resource ID of the diagnostic event hub authorization rule for the Event Hubs namespace in which the event hub should be created or streamed to."
              }
            },
            "diagnosticEventHubName": {
              "type": "string",
              "defaultValue": "",
              "metadata": {
                "description": "Optional. Name of the diagnostic event hub within the namespace to which logs are streamed. Without this, an event hub is created for each log category. For security reasons, it is recommended to set diagnostic settings to send data to either storage account, log analytics workspace or event hub."
              }
            },
            "diagnosticLogCategoriesToEnable": {
              "type": "array",
              "defaultValue": [
                "allLogs"
              ],
              "allowedValues": [
                "allLogs",
                "FrontdoorAccessLog",
                "FrontdoorWebApplicationFirewallLog"
              ],
              "metadata": {
                "description": "Optional. The name of logs that will be streamed. \"allLogs\" includes all possible logs for the resource."
              }
            },
            "metricsToEnable": {
              "type": "array",
              "defaultValue": [
                "AllMetrics"
              ],
              "allowedValues": [
                "AllMetrics"
              ],
              "metadata": {
                "description": "Optional. The name of metrics that will be streamed."
              }
            }
          },
          "variables": {
            "copy": [
              {
                "name": "diagnosticsLogsSpecified",
                "count": "[length(filter(parameters('diagnosticLogCategoriesToEnable'), lambda('item', not(equals(lambdaVariables('item'), 'allLogs')))))]",
                "input": {
                  "category": "[filter(parameters('diagnosticLogCategoriesToEnable'), lambda('item', not(equals(lambdaVariables('item'), 'allLogs'))))[copyIndex('diagnosticsLogsSpecified')]]",
                  "enabled": true,
                  "retentionPolicy": {
                    "enabled": true,
                    "days": "[parameters('diagnosticLogsRetentionInDays')]"
                  }
                }
              },
              {
                "name": "diagnosticsMetrics",
                "count": "[length(parameters('metricsToEnable'))]",
                "input": {
                  "category": "[parameters('metricsToEnable')[copyIndex('diagnosticsMetrics')]]",
                  "timeGrain": null,
                  "enabled": true,
                  "retentionPolicy": {
                    "enabled": true,
                    "days": "[parameters('diagnosticLogsRetentionInDays')]"
                  }
                }
              }
            ],
            "diagnosticsLogs": "[if(contains(parameters('diagnosticLogCategoriesToEnable'), 'allLogs'), createArray(createObject('categoryGroup', 'allLogs', 'enabled', true(), 'retentionPolicy', createObject('enabled', true(), 'days', parameters('diagnosticLogsRetentionInDays')))), variables('diagnosticsLogsSpecified'))]"
          },
          "resources": [
            {
              "type": "Microsoft.Cdn/profiles",
              "apiVersion": "2022-11-01-preview",
              "name": "[parameters('profiles_afd_name')]",
              "location": "Global",
              "sku": {
                "name": "Premium_AzureFrontDoor"
              },
              "properties": {
                "originResponseTimeoutSeconds": 120,
                "extendedProperties": {}
              }
            },
            {
              "type": "Microsoft.Cdn/profiles/afdEndpoints",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}', parameters('profiles_afd_name'), 'polaris-test')]",
              "location": "Global",
              "properties": {
                "enabledState": "Enabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles', parameters('profiles_afd_name'))]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/afdEndpoints",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}', parameters('profiles_afd_name'), 'polaris-uat')]",
              "location": "Global",
              "properties": {
                "enabledState": "Enabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles', parameters('profiles_afd_name'))]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/afdEndpoints",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}', parameters('profiles_afd_name'), 'polaris-trn')]",
              "location": "Global",
              "properties": {
                "enabledState": "Enabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles', parameters('profiles_afd_name'))]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/afdEndpoints",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}', parameters('profiles_afd_name'), 'polaris-prod')]",
              "location": "Global",
              "properties": {
                "enabledState": "Enabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles', parameters('profiles_afd_name'))]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/customDomains",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}', parameters('profiles_afd_name'), 'test-id-reedinpartnership-co-uk')]",
              "properties": {
                "hostName": "test.id.reedinpartnership.co.uk",
                "tlsSettings": {
                  "certificateType": "ManagedCertificate",
                  "minimumTlsVersion": "TLS12"
                }
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles', parameters('profiles_afd_name'))]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/customDomains",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}', parameters('profiles_afd_name'), 'test-polaris-reedinpartnership-co-uk')]",
              "properties": {
                "hostName": "test.polaris.reedinpartnership.co.uk",
                "tlsSettings": {
                  "certificateType": "ManagedCertificate",
                  "minimumTlsVersion": "TLS12"
                }
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles', parameters('profiles_afd_name'))]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/customDomains",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}', parameters('profiles_afd_name'), 'uat-id-reedinpartnership-co-uk')]",
              "properties": {
                "hostName": "uat.id.reedinpartnership.co.uk",
                "tlsSettings": {
                  "certificateType": "ManagedCertificate",
                  "minimumTlsVersion": "TLS12"
                }
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles', parameters('profiles_afd_name'))]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/customDomains",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}', parameters('profiles_afd_name'), 'uat-polaris-reedinpartnership-co-uk')]",
              "properties": {
                "hostName": "uat.polaris.reedinpartnership.co.uk",
                "tlsSettings": {
                  "certificateType": "ManagedCertificate",
                  "minimumTlsVersion": "TLS12"
                }
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles', parameters('profiles_afd_name'))]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/customDomains",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}', parameters('profiles_afd_name'), 'trn-id-reedinpartnership-co-uk')]",
              "properties": {
                "hostName": "trn.id.reedinpartnership.co.uk",
                "tlsSettings": {
                  "certificateType": "ManagedCertificate",
                  "minimumTlsVersion": "TLS12"
                }
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles', parameters('profiles_afd_name'))]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/customDomains",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}', parameters('profiles_afd_name'), 'trn-polaris-reedinpartnership-co-uk')]",
              "properties": {
                "hostName": "trn.polaris.reedinpartnership.co.uk",
                "tlsSettings": {
                  "certificateType": "ManagedCertificate",
                  "minimumTlsVersion": "TLS12"
                }
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles', parameters('profiles_afd_name'))]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/customDomains",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}', parameters('profiles_afd_name'), 'prod-id-reedinpartnership-co-uk')]",
              "properties": {
                "hostName": "id.reedinpartnership.co.uk",
                "tlsSettings": {
                  "certificateType": "ManagedCertificate",
                  "minimumTlsVersion": "TLS12"
                }
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles', parameters('profiles_afd_name'))]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/customDomains",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}', parameters('profiles_afd_name'), 'prod-polaris-reedinpartnership-co-uk')]",
              "properties": {
                "hostName": "polaris.reedinpartnership.co.uk",
                "tlsSettings": {
                  "certificateType": "ManagedCertificate",
                  "minimumTlsVersion": "TLS12"
                }
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles', parameters('profiles_afd_name'))]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}', parameters('profiles_afd_name'), 'polaris-test-adb2c-custom-ui-origin-group')]",
              "properties": {
                "loadBalancingSettings": {
                  "sampleSize": 4,
                  "successfulSamplesRequired": 3,
                  "additionalLatencyInMilliseconds": 50
                },
                "healthProbeSettings": {
                  "probePath": "/",
                  "probeRequestType": "HEAD",
                  "probeProtocol": "Http",
                  "probeIntervalInSeconds": 100
                },
                "sessionAffinityState": "Disabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles', parameters('profiles_afd_name'))]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}', parameters('profiles_afd_name'), 'polaris-test-adb2c-tenant-origin-group')]",
              "properties": {
                "loadBalancingSettings": {
                  "sampleSize": 4,
                  "successfulSamplesRequired": 3,
                  "additionalLatencyInMilliseconds": 50
                },
                "healthProbeSettings": {
                  "probePath": "/",
                  "probeRequestType": "HEAD",
                  "probeProtocol": "Http",
                  "probeIntervalInSeconds": 100
                },
                "sessionAffinityState": "Disabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles', parameters('profiles_afd_name'))]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}', parameters('profiles_afd_name'), 'polaris-test-frontend-origingroup')]",
              "properties": {
                "loadBalancingSettings": {
                  "sampleSize": 4,
                  "successfulSamplesRequired": 3,
                  "additionalLatencyInMilliseconds": 50
                },
                "healthProbeSettings": {
                  "probePath": "/",
                  "probeRequestType": "HEAD",
                  "probeProtocol": "Https",
                  "probeIntervalInSeconds": 100
                },
                "sessionAffinityState": "Disabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles', parameters('profiles_afd_name'))]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}', parameters('profiles_afd_name'), 'polaris-test-spring-users-origin-group')]",
              "properties": {
                "loadBalancingSettings": {
                  "sampleSize": 4,
                  "successfulSamplesRequired": 3,
                  "additionalLatencyInMilliseconds": 50
                },
                "healthProbeSettings": {
                  "probePath": "/",
                  "probeRequestType": "HEAD",
                  "probeProtocol": "Http",
                  "probeIntervalInSeconds": 240
                },
                "sessionAffinityState": "Disabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles', parameters('profiles_afd_name'))]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}', parameters('profiles_afd_name'), 'polaris-test-spring-courses-origin-group')]",
              "properties": {
                "loadBalancingSettings": {
                  "sampleSize": 4,
                  "successfulSamplesRequired": 3,
                  "additionalLatencyInMilliseconds": 50
                },
                "healthProbeSettings": {
                  "probePath": "/",
                  "probeRequestType": "HEAD",
                  "probeProtocol": "Http",
                  "probeIntervalInSeconds": 240
                },
                "sessionAffinityState": "Disabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles', parameters('profiles_afd_name'))]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}', parameters('profiles_afd_name'), 'polaris-test-spring-participants-origin-group')]",
              "properties": {
                "loadBalancingSettings": {
                  "sampleSize": 4,
                  "successfulSamplesRequired": 3,
                  "additionalLatencyInMilliseconds": 50
                },
                "healthProbeSettings": {
                  "probePath": "/",
                  "probeRequestType": "HEAD",
                  "probeProtocol": "Http",
                  "probeIntervalInSeconds": 240
                },
                "sessionAffinityState": "Disabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles', parameters('profiles_afd_name'))]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}', parameters('profiles_afd_name'), 'polaris-test-spring-communication-origin-group')]",
              "properties": {
                "loadBalancingSettings": {
                  "sampleSize": 4,
                  "successfulSamplesRequired": 3,
                  "additionalLatencyInMilliseconds": 50
                },
                "healthProbeSettings": {
                  "probePath": "/",
                  "probeRequestType": "HEAD",
                  "probeProtocol": "Http",
                  "probeIntervalInSeconds": 240
                },
                "sessionAffinityState": "Disabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles', parameters('profiles_afd_name'))]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}', parameters('profiles_afd_name'), 'polaris-test-spring-directus-origin-group')]",
              "properties": {
                "loadBalancingSettings": {
                  "sampleSize": 4,
                  "successfulSamplesRequired": 3,
                  "additionalLatencyInMilliseconds": 50
                },
                "healthProbeSettings": {
                  "probePath": "/",
                  "probeRequestType": "HEAD",
                  "probeProtocol": "Http",
                  "probeIntervalInSeconds": 240
                },
                "sessionAffinityState": "Disabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles', parameters('profiles_afd_name'))]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}', parameters('profiles_afd_name'), 'polaris-test-spring-calendar-origin-group')]",
              "properties": {
                "loadBalancingSettings": {
                  "sampleSize": 4,
                  "successfulSamplesRequired": 3,
                  "additionalLatencyInMilliseconds": 50
                },
                "healthProbeSettings": {
                  "probePath": "/",
                  "probeRequestType": "HEAD",
                  "probeProtocol": "Http",
                  "probeIntervalInSeconds": 240
                },
                "sessionAffinityState": "Disabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles', parameters('profiles_afd_name'))]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}', parameters('profiles_afd_name'), 'polaris-test-spring-documents-origin-group')]",
              "properties": {
                "loadBalancingSettings": {
                  "sampleSize": 4,
                  "successfulSamplesRequired": 3,
                  "additionalLatencyInMilliseconds": 50
                },
                "healthProbeSettings": {
                  "probePath": "/",
                  "probeRequestType": "HEAD",
                  "probeProtocol": "Http",
                  "probeIntervalInSeconds": 240
                },
                "sessionAffinityState": "Disabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles', parameters('profiles_afd_name'))]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}', parameters('profiles_afd_name'), 'polaris-test-spring-recruitment-origin-group')]",
              "properties": {
                "loadBalancingSettings": {
                  "sampleSize": 4,
                  "successfulSamplesRequired": 3,
                  "additionalLatencyInMilliseconds": 50
                },
                "healthProbeSettings": {
                  "probePath": "/",
                  "probeRequestType": "HEAD",
                  "probeProtocol": "Http",
                  "probeIntervalInSeconds": 240
                },
                "sessionAffinityState": "Disabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles', parameters('profiles_afd_name'))]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}', parameters('profiles_afd_name'), 'polaris-uat-adb2c-custom-ui-origin-group')]",
              "properties": {
                "loadBalancingSettings": {
                  "sampleSize": 4,
                  "successfulSamplesRequired": 3,
                  "additionalLatencyInMilliseconds": 50
                },
                "healthProbeSettings": {
                  "probePath": "/",
                  "probeRequestType": "HEAD",
                  "probeProtocol": "Http",
                  "probeIntervalInSeconds": 100
                },
                "sessionAffinityState": "Disabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles', parameters('profiles_afd_name'))]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}', parameters('profiles_afd_name'), 'polaris-uat-adb2c-tenant-origin-group')]",
              "properties": {
                "loadBalancingSettings": {
                  "sampleSize": 4,
                  "successfulSamplesRequired": 3,
                  "additionalLatencyInMilliseconds": 50
                },
                "healthProbeSettings": {
                  "probePath": "/",
                  "probeRequestType": "HEAD",
                  "probeProtocol": "Http",
                  "probeIntervalInSeconds": 100
                },
                "sessionAffinityState": "Disabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles', parameters('profiles_afd_name'))]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}', parameters('profiles_afd_name'), 'polaris-uat-frontend-origingroup')]",
              "properties": {
                "loadBalancingSettings": {
                  "sampleSize": 4,
                  "successfulSamplesRequired": 3,
                  "additionalLatencyInMilliseconds": 50
                },
                "healthProbeSettings": {
                  "probePath": "/",
                  "probeRequestType": "HEAD",
                  "probeProtocol": "Https",
                  "probeIntervalInSeconds": 100
                },
                "sessionAffinityState": "Disabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles', parameters('profiles_afd_name'))]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}', parameters('profiles_afd_name'), 'polaris-uat-spring-users-origin-group')]",
              "properties": {
                "loadBalancingSettings": {
                  "sampleSize": 4,
                  "successfulSamplesRequired": 3,
                  "additionalLatencyInMilliseconds": 50
                },
                "healthProbeSettings": {
                  "probePath": "/",
                  "probeRequestType": "HEAD",
                  "probeProtocol": "Http",
                  "probeIntervalInSeconds": 240
                },
                "sessionAffinityState": "Disabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles', parameters('profiles_afd_name'))]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}', parameters('profiles_afd_name'), 'polaris-uat-spring-courses-origin-group')]",
              "properties": {
                "loadBalancingSettings": {
                  "sampleSize": 4,
                  "successfulSamplesRequired": 3,
                  "additionalLatencyInMilliseconds": 50
                },
                "healthProbeSettings": {
                  "probePath": "/",
                  "probeRequestType": "HEAD",
                  "probeProtocol": "Http",
                  "probeIntervalInSeconds": 240
                },
                "sessionAffinityState": "Disabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles', parameters('profiles_afd_name'))]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}', parameters('profiles_afd_name'), 'polaris-uat-spring-participants-origin-group')]",
              "properties": {
                "loadBalancingSettings": {
                  "sampleSize": 4,
                  "successfulSamplesRequired": 3,
                  "additionalLatencyInMilliseconds": 50
                },
                "healthProbeSettings": {
                  "probePath": "/",
                  "probeRequestType": "HEAD",
                  "probeProtocol": "Http",
                  "probeIntervalInSeconds": 240
                },
                "sessionAffinityState": "Disabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles', parameters('profiles_afd_name'))]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}', parameters('profiles_afd_name'), 'polaris-uat-spring-communication-origin-group')]",
              "properties": {
                "loadBalancingSettings": {
                  "sampleSize": 4,
                  "successfulSamplesRequired": 3,
                  "additionalLatencyInMilliseconds": 50
                },
                "healthProbeSettings": {
                  "probePath": "/",
                  "probeRequestType": "HEAD",
                  "probeProtocol": "Http",
                  "probeIntervalInSeconds": 240
                },
                "sessionAffinityState": "Disabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles', parameters('profiles_afd_name'))]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}', parameters('profiles_afd_name'), 'polaris-uat-spring-directus-origin-group')]",
              "properties": {
                "loadBalancingSettings": {
                  "sampleSize": 4,
                  "successfulSamplesRequired": 3,
                  "additionalLatencyInMilliseconds": 50
                },
                "healthProbeSettings": {
                  "probePath": "/",
                  "probeRequestType": "HEAD",
                  "probeProtocol": "Http",
                  "probeIntervalInSeconds": 240
                },
                "sessionAffinityState": "Disabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles', parameters('profiles_afd_name'))]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}', parameters('profiles_afd_name'), 'polaris-uat-spring-calendar-origin-group')]",
              "properties": {
                "loadBalancingSettings": {
                  "sampleSize": 4,
                  "successfulSamplesRequired": 3,
                  "additionalLatencyInMilliseconds": 50
                },
                "healthProbeSettings": {
                  "probePath": "/",
                  "probeRequestType": "HEAD",
                  "probeProtocol": "Http",
                  "probeIntervalInSeconds": 240
                },
                "sessionAffinityState": "Disabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles', parameters('profiles_afd_name'))]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}', parameters('profiles_afd_name'), 'polaris-uat-spring-documents-origin-group')]",
              "properties": {
                "loadBalancingSettings": {
                  "sampleSize": 4,
                  "successfulSamplesRequired": 3,
                  "additionalLatencyInMilliseconds": 50
                },
                "healthProbeSettings": {
                  "probePath": "/",
                  "probeRequestType": "HEAD",
                  "probeProtocol": "Http",
                  "probeIntervalInSeconds": 240
                },
                "sessionAffinityState": "Disabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles', parameters('profiles_afd_name'))]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}', parameters('profiles_afd_name'), 'polaris-uat-spring-recruitment-origin-group')]",
              "properties": {
                "loadBalancingSettings": {
                  "sampleSize": 4,
                  "successfulSamplesRequired": 3,
                  "additionalLatencyInMilliseconds": 50
                },
                "healthProbeSettings": {
                  "probePath": "/",
                  "probeRequestType": "HEAD",
                  "probeProtocol": "Http",
                  "probeIntervalInSeconds": 240
                },
                "sessionAffinityState": "Disabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles', parameters('profiles_afd_name'))]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}', parameters('profiles_afd_name'), 'polaris-trn-adb2c-custom-ui-origin-group')]",
              "properties": {
                "loadBalancingSettings": {
                  "sampleSize": 4,
                  "successfulSamplesRequired": 3,
                  "additionalLatencyInMilliseconds": 50
                },
                "healthProbeSettings": {
                  "probePath": "/",
                  "probeRequestType": "HEAD",
                  "probeProtocol": "Http",
                  "probeIntervalInSeconds": 100
                },
                "sessionAffinityState": "Disabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles', parameters('profiles_afd_name'))]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}', parameters('profiles_afd_name'), 'polaris-trn-adb2c-tenant-origin-group')]",
              "properties": {
                "loadBalancingSettings": {
                  "sampleSize": 4,
                  "successfulSamplesRequired": 3,
                  "additionalLatencyInMilliseconds": 50
                },
                "healthProbeSettings": {
                  "probePath": "/",
                  "probeRequestType": "HEAD",
                  "probeProtocol": "Http",
                  "probeIntervalInSeconds": 100
                },
                "sessionAffinityState": "Disabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles', parameters('profiles_afd_name'))]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}', parameters('profiles_afd_name'), 'polaris-trn-frontend-origingroup')]",
              "properties": {
                "loadBalancingSettings": {
                  "sampleSize": 4,
                  "successfulSamplesRequired": 3,
                  "additionalLatencyInMilliseconds": 50
                },
                "healthProbeSettings": {
                  "probePath": "/",
                  "probeRequestType": "HEAD",
                  "probeProtocol": "Https",
                  "probeIntervalInSeconds": 100
                },
                "sessionAffinityState": "Disabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles', parameters('profiles_afd_name'))]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}', parameters('profiles_afd_name'), 'polaris-trn-spring-users-origin-group')]",
              "properties": {
                "loadBalancingSettings": {
                  "sampleSize": 4,
                  "successfulSamplesRequired": 3,
                  "additionalLatencyInMilliseconds": 50
                },
                "healthProbeSettings": {
                  "probePath": "/",
                  "probeRequestType": "HEAD",
                  "probeProtocol": "Http",
                  "probeIntervalInSeconds": 240
                },
                "sessionAffinityState": "Disabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles', parameters('profiles_afd_name'))]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}', parameters('profiles_afd_name'), 'polaris-trn-spring-courses-origin-group')]",
              "properties": {
                "loadBalancingSettings": {
                  "sampleSize": 4,
                  "successfulSamplesRequired": 3,
                  "additionalLatencyInMilliseconds": 50
                },
                "healthProbeSettings": {
                  "probePath": "/",
                  "probeRequestType": "HEAD",
                  "probeProtocol": "Http",
                  "probeIntervalInSeconds": 240
                },
                "sessionAffinityState": "Disabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles', parameters('profiles_afd_name'))]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}', parameters('profiles_afd_name'), 'polaris-trn-spring-participants-origin-group')]",
              "properties": {
                "loadBalancingSettings": {
                  "sampleSize": 4,
                  "successfulSamplesRequired": 3,
                  "additionalLatencyInMilliseconds": 50
                },
                "healthProbeSettings": {
                  "probePath": "/",
                  "probeRequestType": "HEAD",
                  "probeProtocol": "Http",
                  "probeIntervalInSeconds": 240
                },
                "sessionAffinityState": "Disabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles', parameters('profiles_afd_name'))]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}', parameters('profiles_afd_name'), 'polaris-trn-spring-communication-origin-group')]",
              "properties": {
                "loadBalancingSettings": {
                  "sampleSize": 4,
                  "successfulSamplesRequired": 3,
                  "additionalLatencyInMilliseconds": 50
                },
                "healthProbeSettings": {
                  "probePath": "/",
                  "probeRequestType": "HEAD",
                  "probeProtocol": "Http",
                  "probeIntervalInSeconds": 240
                },
                "sessionAffinityState": "Disabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles', parameters('profiles_afd_name'))]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}', parameters('profiles_afd_name'), 'polaris-trn-spring-directus-origin-group')]",
              "properties": {
                "loadBalancingSettings": {
                  "sampleSize": 4,
                  "successfulSamplesRequired": 3,
                  "additionalLatencyInMilliseconds": 50
                },
                "healthProbeSettings": {
                  "probePath": "/",
                  "probeRequestType": "HEAD",
                  "probeProtocol": "Http",
                  "probeIntervalInSeconds": 240
                },
                "sessionAffinityState": "Disabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles', parameters('profiles_afd_name'))]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}', parameters('profiles_afd_name'), 'polaris-trn-spring-calendar-origin-group')]",
              "properties": {
                "loadBalancingSettings": {
                  "sampleSize": 4,
                  "successfulSamplesRequired": 3,
                  "additionalLatencyInMilliseconds": 50
                },
                "healthProbeSettings": {
                  "probePath": "/",
                  "probeRequestType": "HEAD",
                  "probeProtocol": "Http",
                  "probeIntervalInSeconds": 240
                },
                "sessionAffinityState": "Disabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles', parameters('profiles_afd_name'))]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}', parameters('profiles_afd_name'), 'polaris-trn-spring-documents-origin-group')]",
              "properties": {
                "loadBalancingSettings": {
                  "sampleSize": 4,
                  "successfulSamplesRequired": 3,
                  "additionalLatencyInMilliseconds": 50
                },
                "healthProbeSettings": {
                  "probePath": "/",
                  "probeRequestType": "HEAD",
                  "probeProtocol": "Http",
                  "probeIntervalInSeconds": 240
                },
                "sessionAffinityState": "Disabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles', parameters('profiles_afd_name'))]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}', parameters('profiles_afd_name'), 'polaris-trn-spring-recruitment-origin-group')]",
              "properties": {
                "loadBalancingSettings": {
                  "sampleSize": 4,
                  "successfulSamplesRequired": 3,
                  "additionalLatencyInMilliseconds": 50
                },
                "healthProbeSettings": {
                  "probePath": "/",
                  "probeRequestType": "HEAD",
                  "probeProtocol": "Http",
                  "probeIntervalInSeconds": 240
                },
                "sessionAffinityState": "Disabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles', parameters('profiles_afd_name'))]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}', parameters('profiles_afd_name'), 'polaris-prod-adb2c-custom-ui-origin-group')]",
              "properties": {
                "loadBalancingSettings": {
                  "sampleSize": 4,
                  "successfulSamplesRequired": 3,
                  "additionalLatencyInMilliseconds": 50
                },
                "healthProbeSettings": {
                  "probePath": "/",
                  "probeRequestType": "HEAD",
                  "probeProtocol": "Http",
                  "probeIntervalInSeconds": 100
                },
                "sessionAffinityState": "Disabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles', parameters('profiles_afd_name'))]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}', parameters('profiles_afd_name'), 'polaris-prod-adb2c-tenant-origin-group')]",
              "properties": {
                "loadBalancingSettings": {
                  "sampleSize": 4,
                  "successfulSamplesRequired": 3,
                  "additionalLatencyInMilliseconds": 50
                },
                "healthProbeSettings": {
                  "probePath": "/",
                  "probeRequestType": "HEAD",
                  "probeProtocol": "Http",
                  "probeIntervalInSeconds": 100
                },
                "sessionAffinityState": "Disabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles', parameters('profiles_afd_name'))]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}', parameters('profiles_afd_name'), 'polaris-prod-frontend-origingroup')]",
              "properties": {
                "loadBalancingSettings": {
                  "sampleSize": 4,
                  "successfulSamplesRequired": 3,
                  "additionalLatencyInMilliseconds": 50
                },
                "healthProbeSettings": {
                  "probePath": "/",
                  "probeRequestType": "HEAD",
                  "probeProtocol": "Https",
                  "probeIntervalInSeconds": 100
                },
                "sessionAffinityState": "Disabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles', parameters('profiles_afd_name'))]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}', parameters('profiles_afd_name'), 'polaris-prod-spring-users-origin-group')]",
              "properties": {
                "loadBalancingSettings": {
                  "sampleSize": 4,
                  "successfulSamplesRequired": 3,
                  "additionalLatencyInMilliseconds": 50
                },
                "healthProbeSettings": {
                  "probePath": "/",
                  "probeRequestType": "HEAD",
                  "probeProtocol": "Http",
                  "probeIntervalInSeconds": 240
                },
                "sessionAffinityState": "Disabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles', parameters('profiles_afd_name'))]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}', parameters('profiles_afd_name'), 'polaris-prod-spring-courses-origin-group')]",
              "properties": {
                "loadBalancingSettings": {
                  "sampleSize": 4,
                  "successfulSamplesRequired": 3,
                  "additionalLatencyInMilliseconds": 50
                },
                "healthProbeSettings": {
                  "probePath": "/",
                  "probeRequestType": "HEAD",
                  "probeProtocol": "Http",
                  "probeIntervalInSeconds": 240
                },
                "sessionAffinityState": "Disabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles', parameters('profiles_afd_name'))]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}', parameters('profiles_afd_name'), 'polaris-prod-spring-participants-origin-group')]",
              "properties": {
                "loadBalancingSettings": {
                  "sampleSize": 4,
                  "successfulSamplesRequired": 3,
                  "additionalLatencyInMilliseconds": 50
                },
                "healthProbeSettings": {
                  "probePath": "/",
                  "probeRequestType": "HEAD",
                  "probeProtocol": "Http",
                  "probeIntervalInSeconds": 240
                },
                "sessionAffinityState": "Disabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles', parameters('profiles_afd_name'))]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}', parameters('profiles_afd_name'), 'polaris-prod-spring-communication-origin-group')]",
              "properties": {
                "loadBalancingSettings": {
                  "sampleSize": 4,
                  "successfulSamplesRequired": 3,
                  "additionalLatencyInMilliseconds": 50
                },
                "healthProbeSettings": {
                  "probePath": "/",
                  "probeRequestType": "HEAD",
                  "probeProtocol": "Http",
                  "probeIntervalInSeconds": 240
                },
                "sessionAffinityState": "Disabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles', parameters('profiles_afd_name'))]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}', parameters('profiles_afd_name'), 'polaris-prod-spring-directus-origin-group')]",
              "properties": {
                "loadBalancingSettings": {
                  "sampleSize": 4,
                  "successfulSamplesRequired": 3,
                  "additionalLatencyInMilliseconds": 50
                },
                "healthProbeSettings": {
                  "probePath": "/",
                  "probeRequestType": "HEAD",
                  "probeProtocol": "Http",
                  "probeIntervalInSeconds": 240
                },
                "sessionAffinityState": "Disabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles', parameters('profiles_afd_name'))]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}', parameters('profiles_afd_name'), 'polaris-prod-spring-calendar-origin-group')]",
              "properties": {
                "loadBalancingSettings": {
                  "sampleSize": 4,
                  "successfulSamplesRequired": 3,
                  "additionalLatencyInMilliseconds": 50
                },
                "healthProbeSettings": {
                  "probePath": "/",
                  "probeRequestType": "HEAD",
                  "probeProtocol": "Http",
                  "probeIntervalInSeconds": 240
                },
                "sessionAffinityState": "Disabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles', parameters('profiles_afd_name'))]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}', parameters('profiles_afd_name'), 'polaris-prod-spring-documents-origin-group')]",
              "properties": {
                "loadBalancingSettings": {
                  "sampleSize": 4,
                  "successfulSamplesRequired": 3,
                  "additionalLatencyInMilliseconds": 50
                },
                "healthProbeSettings": {
                  "probePath": "/",
                  "probeRequestType": "HEAD",
                  "probeProtocol": "Http",
                  "probeIntervalInSeconds": 240
                },
                "sessionAffinityState": "Disabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles', parameters('profiles_afd_name'))]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}', parameters('profiles_afd_name'), 'polaris-prod-spring-recruitment-origin-group')]",
              "properties": {
                "loadBalancingSettings": {
                  "sampleSize": 4,
                  "successfulSamplesRequired": 3,
                  "additionalLatencyInMilliseconds": 50
                },
                "healthProbeSettings": {
                  "probePath": "/",
                  "probeRequestType": "HEAD",
                  "probeProtocol": "Http",
                  "probeIntervalInSeconds": 240
                },
                "sessionAffinityState": "Disabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles', parameters('profiles_afd_name'))]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups/origins",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-test-adb2c-custom-ui-origin-group', 'polaris-test-adb2c-custom-ui-origin')]",
              "properties": {
                "hostName": "yellow-pond-099d3f303.3.azurestaticapps.net",
                "httpPort": 80,
                "httpsPort": 443,
                "originHostHeader": "yellow-pond-099d3f303.3.azurestaticapps.net",
                "priority": 1,
                "weight": 1000,
                "enabledState": "Enabled",
                "enforceCertificateNameCheck": true
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-test-adb2c-custom-ui-origin-group')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups/origins",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-test-adb2c-tenant-origin-group', 'polaris-test-adb2c-tenant-origin')]",
              "properties": {
                "hostName": "rinppolaristest.b2clogin.com",
                "httpPort": 80,
                "httpsPort": 443,
                "originHostHeader": "rinppolaristest.b2clogin.com",
                "priority": 1,
                "weight": 1000,
                "enabledState": "Enabled",
                "enforceCertificateNameCheck": true
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-test-adb2c-tenant-origin-group')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups/origins",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-test-frontend-origingroup', 'polaris-test-frontend-swa-origin')]",
              "properties": {
                "hostName": "witty-stone-01ed44603.2.azurestaticapps.net",
                "httpPort": 80,
                "httpsPort": 443,
                "originHostHeader": "witty-stone-01ed44603.2.azurestaticapps.net",
                "priority": 1,
                "weight": 1000,
                "enabledState": "Enabled",
                "enforceCertificateNameCheck": true
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-test-frontend-origingroup')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups/origins",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-test-spring-users-origin-group', 'polaris-test-spring-users-origin')]",
              "properties": {
                "hostName": "spring-polaris-test-uksouth-user-service.private.azuremicroservices.io",
                "httpPort": 80,
                "httpsPort": 443,
                "originHostHeader": "spring-polaris-test-uksouth-user-service.private.azuremicroservices.io",
                "priority": 1,
                "weight": 1000,
                "enabledState": "Enabled",
                "sharedPrivateLinkResource": {
                  "privateLink": {
                    "id": "[parameters('privateLinkServices_pl_springapps_polaris_test_externalid')]"
                  },
                  "privateLinkLocation": "uksouth",
                  "requestMessage": "please approve"
                },
                "enforceCertificateNameCheck": true
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-test-spring-users-origin-group')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups/origins",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-test-spring-courses-origin-group', 'polaris-test-spring-courses-origin')]",
              "properties": {
                "hostName": "spring-polaris-test-uksouth-course-service.private.azuremicroservices.io",
                "httpPort": 80,
                "httpsPort": 443,
                "originHostHeader": "spring-polaris-test-uksouth-course-service.private.azuremicroservices.io",
                "priority": 1,
                "weight": 1000,
                "enabledState": "Enabled",
                "sharedPrivateLinkResource": {
                  "privateLink": {
                    "id": "[parameters('privateLinkServices_pl_springapps_polaris_test_externalid')]"
                  },
                  "privateLinkLocation": "uksouth",
                  "requestMessage": "please approve"
                },
                "enforceCertificateNameCheck": true
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-test-spring-courses-origin-group')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups/origins",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-test-spring-participants-origin-group', 'polaris-test-spring-participants-origin')]",
              "properties": {
                "hostName": "spring-polaris-test-uksouth-participant-service.private.azuremicroservices.io",
                "httpPort": 80,
                "httpsPort": 443,
                "originHostHeader": "spring-polaris-test-uksouth-participant-service.private.azuremicroservices.io",
                "priority": 1,
                "weight": 1000,
                "enabledState": "Enabled",
                "sharedPrivateLinkResource": {
                  "privateLink": {
                    "id": "[parameters('privateLinkServices_pl_springapps_polaris_test_externalid')]"
                  },
                  "privateLinkLocation": "uksouth",
                  "requestMessage": "please approve"
                },
                "enforceCertificateNameCheck": true
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-test-spring-participants-origin-group')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups/origins",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-test-spring-communication-origin-group', 'polaris-test-spring-communication-origin')]",
              "properties": {
                "hostName": "spring-polaris-test-uksouth-communication-service.private.azuremicroservices.io",
                "httpPort": 80,
                "httpsPort": 443,
                "originHostHeader": "spring-polaris-test-uksouth-communication-service.private.azuremicroservices.io",
                "priority": 1,
                "weight": 1000,
                "enabledState": "Enabled",
                "sharedPrivateLinkResource": {
                  "privateLink": {
                    "id": "[parameters('privateLinkServices_pl_springapps_polaris_test_externalid')]"
                  },
                  "privateLinkLocation": "uksouth",
                  "requestMessage": "please approve"
                },
                "enforceCertificateNameCheck": true
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-test-spring-communication-origin-group')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups/origins",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-test-spring-directus-origin-group', 'polaris-test-spring-directus-origin')]",
              "properties": {
                "hostName": "spring-polaris-test-uksouth-directus-management-service.private.azuremicroservices.io",
                "httpPort": 80,
                "httpsPort": 443,
                "originHostHeader": "spring-polaris-test-uksouth-directus-management-service.private.azuremicroservices.io",
                "priority": 1,
                "weight": 1000,
                "enabledState": "Enabled",
                "sharedPrivateLinkResource": {
                  "privateLink": {
                    "id": "[parameters('privateLinkServices_pl_springapps_polaris_test_externalid')]"
                  },
                  "privateLinkLocation": "uksouth",
                  "requestMessage": "please approve"
                },
                "enforceCertificateNameCheck": true
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-test-spring-directus-origin-group')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups/origins",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-test-spring-calendar-origin-group', 'polaris-test-spring-calendar-origin')]",
              "properties": {
                "hostName": "spring-polaris-test-uksouth-calendar-service.private.azuremicroservices.io",
                "httpPort": 80,
                "httpsPort": 443,
                "originHostHeader": "spring-polaris-test-uksouth-calendar-service.private.azuremicroservices.io",
                "priority": 1,
                "weight": 1000,
                "enabledState": "Enabled",
                "sharedPrivateLinkResource": {
                  "privateLink": {
                    "id": "[parameters('privateLinkServices_pl_springapps_polaris_test_externalid')]"
                  },
                  "privateLinkLocation": "uksouth",
                  "requestMessage": "please approve"
                },
                "enforceCertificateNameCheck": true
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-test-spring-calendar-origin-group')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups/origins",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-test-spring-documents-origin-group', 'polaris-test-spring-documents-origin')]",
              "properties": {
                "hostName": "spring-polaris-test-uksouth-document-service.private.azuremicroservices.io",
                "httpPort": 80,
                "httpsPort": 443,
                "originHostHeader": "spring-polaris-test-uksouth-document-service.private.azuremicroservices.io",
                "priority": 1,
                "weight": 1000,
                "enabledState": "Enabled",
                "sharedPrivateLinkResource": {
                  "privateLink": {
                    "id": "[parameters('privateLinkServices_pl_springapps_polaris_test_externalid')]"
                  },
                  "privateLinkLocation": "uksouth",
                  "requestMessage": "Polaris Test AFD route documents upload"
                },
                "enforceCertificateNameCheck": true
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-test-spring-documents-origin-group')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups/origins",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-test-spring-recruitment-origin-group', 'polaris-test-spring-recruitment-origin')]",
              "properties": {
                "hostName": "spring-polaris-test-uksouth-recruitment-service.private.azuremicroservices.io",
                "httpPort": 80,
                "httpsPort": 443,
                "originHostHeader": "spring-polaris-test-uksouth-recruitment-service.private.azuremicroservices.io",
                "priority": 1,
                "weight": 1000,
                "enabledState": "Enabled",
                "sharedPrivateLinkResource": {
                  "privateLink": {
                    "id": "[parameters('privateLinkServices_pl_springapps_polaris_test_externalid')]"
                  },
                  "privateLinkLocation": "uksouth",
                  "requestMessage": "Polaris Test AFD route recruitment"
                },
                "enforceCertificateNameCheck": true
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-test-spring-recruitment-origin-group')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups/origins",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-uat-adb2c-custom-ui-origin-group', 'polaris-uat-adb2c-custom-ui-origin')]",
              "properties": {
                "hostName": "lemon-river-068689c03.3.azurestaticapps.net",
                "httpPort": 80,
                "httpsPort": 443,
                "originHostHeader": "lemon-river-068689c03.3.azurestaticapps.net",
                "priority": 1,
                "weight": 1000,
                "enabledState": "Enabled",
                "enforceCertificateNameCheck": true
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-uat-adb2c-custom-ui-origin-group')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups/origins",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-uat-adb2c-tenant-origin-group', 'polaris-uat-adb2c-tenant-origin')]",
              "properties": {
                "hostName": "rinppolarisuat.b2clogin.com",
                "httpPort": 80,
                "httpsPort": 443,
                "originHostHeader": "rinppolarisuat.b2clogin.com",
                "priority": 1,
                "weight": 1000,
                "enabledState": "Enabled",
                "enforceCertificateNameCheck": true
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-uat-adb2c-tenant-origin-group')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups/origins",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-uat-frontend-origingroup', 'polaris-uat-frontend-swa-origin')]",
              "properties": {
                "hostName": "orange-ocean-054363203.3.azurestaticapps.net",
                "httpPort": 80,
                "httpsPort": 443,
                "originHostHeader": "orange-ocean-054363203.3.azurestaticapps.net",
                "priority": 1,
                "weight": 1000,
                "enabledState": "Enabled",
                "enforceCertificateNameCheck": true
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-uat-frontend-origingroup')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups/origins",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-uat-spring-users-origin-group', 'polaris-uat-spring-users-origin')]",
              "properties": {
                "hostName": "spring-polaris-uat-uksouth-user-service.private.azuremicroservices.io",
                "httpPort": 80,
                "httpsPort": 443,
                "originHostHeader": "spring-polaris-uat-uksouth-user-service.private.azuremicroservices.io",
                "priority": 1,
                "weight": 1000,
                "enabledState": "Enabled",
                "sharedPrivateLinkResource": {
                  "privateLink": {
                    "id": "[parameters('privateLinkServices_pl_springapps_polaris_uat_externalid')]"
                  },
                  "privateLinkLocation": "uksouth",
                  "requestMessage": "please approve"
                },
                "enforceCertificateNameCheck": true
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-uat-spring-users-origin-group')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups/origins",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-uat-spring-courses-origin-group', 'polaris-uat-spring-courses-origin')]",
              "properties": {
                "hostName": "spring-polaris-uat-uksouth-course-service.private.azuremicroservices.io",
                "httpPort": 80,
                "httpsPort": 443,
                "originHostHeader": "spring-polaris-uat-uksouth-course-service.private.azuremicroservices.io",
                "priority": 1,
                "weight": 1000,
                "enabledState": "Enabled",
                "sharedPrivateLinkResource": {
                  "privateLink": {
                    "id": "[parameters('privateLinkServices_pl_springapps_polaris_uat_externalid')]"
                  },
                  "privateLinkLocation": "uksouth",
                  "requestMessage": "please approve"
                },
                "enforceCertificateNameCheck": true
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-uat-spring-courses-origin-group')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups/origins",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-uat-spring-participants-origin-group', 'polaris-uat-spring-participants-origin')]",
              "properties": {
                "hostName": "spring-polaris-uat-uksouth-participant-service.private.azuremicroservices.io",
                "httpPort": 80,
                "httpsPort": 443,
                "originHostHeader": "spring-polaris-uat-uksouth-participant-service.private.azuremicroservices.io",
                "priority": 1,
                "weight": 1000,
                "enabledState": "Enabled",
                "sharedPrivateLinkResource": {
                  "privateLink": {
                    "id": "[parameters('privateLinkServices_pl_springapps_polaris_uat_externalid')]"
                  },
                  "privateLinkLocation": "uksouth",
                  "requestMessage": "please approve"
                },
                "enforceCertificateNameCheck": true
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-uat-spring-participants-origin-group')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups/origins",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-uat-spring-communication-origin-group', 'polaris-uat-spring-communication-origin')]",
              "properties": {
                "hostName": "spring-polaris-uat-uksouth-communication-service.private.azuremicroservices.io",
                "httpPort": 80,
                "httpsPort": 443,
                "originHostHeader": "spring-polaris-uat-uksouth-communication-service.private.azuremicroservices.io",
                "priority": 1,
                "weight": 1000,
                "enabledState": "Enabled",
                "sharedPrivateLinkResource": {
                  "privateLink": {
                    "id": "[parameters('privateLinkServices_pl_springapps_polaris_uat_externalid')]"
                  },
                  "privateLinkLocation": "uksouth",
                  "requestMessage": "please approve"
                },
                "enforceCertificateNameCheck": true
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-uat-spring-communication-origin-group')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups/origins",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-uat-spring-directus-origin-group', 'polaris-uat-spring-directus-origin')]",
              "properties": {
                "hostName": "spring-polaris-uat-uksouth-directus-management-service.private.azuremicroservices.io",
                "httpPort": 80,
                "httpsPort": 443,
                "originHostHeader": "spring-polaris-uat-uksouth-directus-management-service.private.azuremicroservices.io",
                "priority": 1,
                "weight": 1000,
                "enabledState": "Enabled",
                "sharedPrivateLinkResource": {
                  "privateLink": {
                    "id": "[parameters('privateLinkServices_pl_springapps_polaris_uat_externalid')]"
                  },
                  "privateLinkLocation": "uksouth",
                  "requestMessage": "please approve"
                },
                "enforceCertificateNameCheck": true
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-uat-spring-directus-origin-group')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups/origins",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-uat-spring-calendar-origin-group', 'polaris-uat-spring-calendar-origin')]",
              "properties": {
                "hostName": "spring-polaris-uat-uksouth-calendar-service.private.azuremicroservices.io",
                "httpPort": 80,
                "httpsPort": 443,
                "originHostHeader": "spring-polaris-uat-uksouth-calendar-service.private.azuremicroservices.io",
                "priority": 1,
                "weight": 1000,
                "enabledState": "Enabled",
                "sharedPrivateLinkResource": {
                  "privateLink": {
                    "id": "[parameters('privateLinkServices_pl_springapps_polaris_uat_externalid')]"
                  },
                  "privateLinkLocation": "uksouth",
                  "requestMessage": "please approve"
                },
                "enforceCertificateNameCheck": true
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-uat-spring-calendar-origin-group')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups/origins",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-uat-spring-documents-origin-group', 'polaris-uat-spring-documents-origin')]",
              "properties": {
                "hostName": "spring-polaris-uat-uksouth-document-service.private.azuremicroservices.io",
                "httpPort": 80,
                "httpsPort": 443,
                "originHostHeader": "spring-polaris-uat-uksouth-document-service.private.azuremicroservices.io",
                "priority": 1,
                "weight": 1000,
                "enabledState": "Enabled",
                "sharedPrivateLinkResource": {
                  "privateLink": {
                    "id": "[parameters('privateLinkServices_pl_springapps_polaris_uat_externalid')]"
                  },
                  "privateLinkLocation": "uksouth",
                  "requestMessage": "Polaris uat AFD route documents upload"
                },
                "enforceCertificateNameCheck": true
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-uat-spring-documents-origin-group')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups/origins",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-uat-spring-recruitment-origin-group', 'polaris-uat-spring-recruitment-origin')]",
              "properties": {
                "hostName": "spring-polaris-uat-uksouth-recruitment-service.private.azuremicroservices.io",
                "httpPort": 80,
                "httpsPort": 443,
                "originHostHeader": "spring-polaris-uat-uksouth-recruitment-service.private.azuremicroservices.io",
                "priority": 1,
                "weight": 1000,
                "enabledState": "Enabled",
                "sharedPrivateLinkResource": {
                  "privateLink": {
                    "id": "[parameters('privateLinkServices_pl_springapps_polaris_uat_externalid')]"
                  },
                  "privateLinkLocation": "uksouth",
                  "requestMessage": "Polaris UAT AFD route recruitment"
                },
                "enforceCertificateNameCheck": true
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-uat-spring-recruitment-origin-group')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups/origins",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-trn-adb2c-custom-ui-origin-group', 'polaris-trn-adb2c-custom-ui-origin')]",
              "properties": {
                "hostName": "lemon-pond-0fbd04d03.4.azurestaticapps.net",
                "httpPort": 80,
                "httpsPort": 443,
                "originHostHeader": "lemon-pond-0fbd04d03.4.azurestaticapps.net",
                "priority": 1,
                "weight": 1000,
                "enabledState": "Enabled",
                "enforceCertificateNameCheck": true
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-trn-adb2c-custom-ui-origin-group')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups/origins",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-trn-adb2c-tenant-origin-group', 'polaris-trn-adb2c-tenant-origin')]",
              "properties": {
                "hostName": "rinppolaristrn.b2clogin.com",
                "httpPort": 80,
                "httpsPort": 443,
                "originHostHeader": "rinppolaristrn.b2clogin.com",
                "priority": 1,
                "weight": 1000,
                "enabledState": "Enabled",
                "enforceCertificateNameCheck": true
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-trn-adb2c-tenant-origin-group')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups/origins",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-trn-frontend-origingroup', 'polaris-trn-frontend-swa-origin')]",
              "properties": {
                "hostName": "ambitious-sky-04b26a903.4.azurestaticapps.net",
                "httpPort": 80,
                "httpsPort": 443,
                "originHostHeader": "ambitious-sky-04b26a903.4.azurestaticapps.net",
                "priority": 1,
                "weight": 1000,
                "enabledState": "Enabled",
                "enforceCertificateNameCheck": true
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-trn-frontend-origingroup')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups/origins",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-trn-spring-users-origin-group', 'polaris-trn-spring-users-origin')]",
              "properties": {
                "hostName": "spring-polaris-trn-uksouth-user-service.private.azuremicroservices.io",
                "httpPort": 80,
                "httpsPort": 443,
                "originHostHeader": "spring-polaris-trn-uksouth-user-service.private.azuremicroservices.io",
                "priority": 1,
                "weight": 1000,
                "enabledState": "Enabled",
                "sharedPrivateLinkResource": {
                  "privateLink": {
                    "id": "[parameters('privateLinkServices_pl_springapps_polaris_trn_externalid')]"
                  },
                  "privateLinkLocation": "uksouth",
                  "requestMessage": "please approve"
                },
                "enforceCertificateNameCheck": true
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-trn-spring-users-origin-group')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups/origins",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-trn-spring-courses-origin-group', 'polaris-trn-spring-courses-origin')]",
              "properties": {
                "hostName": "spring-polaris-trn-uksouth-course-service.private.azuremicroservices.io",
                "httpPort": 80,
                "httpsPort": 443,
                "originHostHeader": "spring-polaris-trn-uksouth-course-service.private.azuremicroservices.io",
                "priority": 1,
                "weight": 1000,
                "enabledState": "Enabled",
                "sharedPrivateLinkResource": {
                  "privateLink": {
                    "id": "[parameters('privateLinkServices_pl_springapps_polaris_trn_externalid')]"
                  },
                  "privateLinkLocation": "uksouth",
                  "requestMessage": "please approve"
                },
                "enforceCertificateNameCheck": true
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-trn-spring-courses-origin-group')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups/origins",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-trn-spring-participants-origin-group', 'polaris-trn-spring-participants-origin')]",
              "properties": {
                "hostName": "spring-polaris-trn-uksouth-participant-service.private.azuremicroservices.io",
                "httpPort": 80,
                "httpsPort": 443,
                "originHostHeader": "spring-polaris-trn-uksouth-participant-service.private.azuremicroservices.io",
                "priority": 1,
                "weight": 1000,
                "enabledState": "Enabled",
                "sharedPrivateLinkResource": {
                  "privateLink": {
                    "id": "[parameters('privateLinkServices_pl_springapps_polaris_trn_externalid')]"
                  },
                  "privateLinkLocation": "uksouth",
                  "requestMessage": "please approve"
                },
                "enforceCertificateNameCheck": true
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-trn-spring-participants-origin-group')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups/origins",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-trn-spring-communication-origin-group', 'polaris-trn-spring-communication-origin')]",
              "properties": {
                "hostName": "spring-polaris-trn-uksouth-communication-service.private.azuremicroservices.io",
                "httpPort": 80,
                "httpsPort": 443,
                "originHostHeader": "spring-polaris-trn-uksouth-communication-service.private.azuremicroservices.io",
                "priority": 1,
                "weight": 1000,
                "enabledState": "Enabled",
                "sharedPrivateLinkResource": {
                  "privateLink": {
                    "id": "[parameters('privateLinkServices_pl_springapps_polaris_trn_externalid')]"
                  },
                  "privateLinkLocation": "uksouth",
                  "requestMessage": "please approve"
                },
                "enforceCertificateNameCheck": true
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-trn-spring-communication-origin-group')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups/origins",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-trn-spring-directus-origin-group', 'polaris-trn-spring-directus-origin')]",
              "properties": {
                "hostName": "spring-polaris-trn-uksouth-directus-management-service.private.azuremicroservices.io",
                "httpPort": 80,
                "httpsPort": 443,
                "originHostHeader": "spring-polaris-trn-uksouth-directus-management-service.private.azuremicroservices.io",
                "priority": 1,
                "weight": 1000,
                "enabledState": "Enabled",
                "sharedPrivateLinkResource": {
                  "privateLink": {
                    "id": "[parameters('privateLinkServices_pl_springapps_polaris_trn_externalid')]"
                  },
                  "privateLinkLocation": "uksouth",
                  "requestMessage": "please approve"
                },
                "enforceCertificateNameCheck": true
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-trn-spring-directus-origin-group')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups/origins",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-trn-spring-calendar-origin-group', 'polaris-trn-spring-calendar-origin')]",
              "properties": {
                "hostName": "spring-polaris-trn-uksouth-calendar-service.private.azuremicroservices.io",
                "httpPort": 80,
                "httpsPort": 443,
                "originHostHeader": "spring-polaris-trn-uksouth-calendar-service.private.azuremicroservices.io",
                "priority": 1,
                "weight": 1000,
                "enabledState": "Enabled",
                "sharedPrivateLinkResource": {
                  "privateLink": {
                    "id": "[parameters('privateLinkServices_pl_springapps_polaris_trn_externalid')]"
                  },
                  "privateLinkLocation": "uksouth",
                  "requestMessage": "please approve"
                },
                "enforceCertificateNameCheck": true
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-trn-spring-calendar-origin-group')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups/origins",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-trn-spring-documents-origin-group', 'polaris-trn-spring-documents-origin')]",
              "properties": {
                "hostName": "spring-polaris-trn-uksouth-document-service.private.azuremicroservices.io",
                "httpPort": 80,
                "httpsPort": 443,
                "originHostHeader": "spring-polaris-trn-uksouth-document-service.private.azuremicroservices.io",
                "priority": 1,
                "weight": 1000,
                "enabledState": "Enabled",
                "sharedPrivateLinkResource": {
                  "privateLink": {
                    "id": "[parameters('privateLinkServices_pl_springapps_polaris_trn_externalid')]"
                  },
                  "privateLinkLocation": "uksouth",
                  "requestMessage": "Polaris trn AFD route documents upload"
                },
                "enforceCertificateNameCheck": true
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-trn-spring-documents-origin-group')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups/origins",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-trn-spring-recruitment-origin-group', 'polaris-trn-spring-recruitment-origin')]",
              "properties": {
                "hostName": "spring-polaris-trn-uksouth-recruitment-service.private.azuremicroservices.io",
                "httpPort": 80,
                "httpsPort": 443,
                "originHostHeader": "spring-polaris-trn-uksouth-recruitment-service.private.azuremicroservices.io",
                "priority": 1,
                "weight": 1000,
                "enabledState": "Enabled",
                "sharedPrivateLinkResource": {
                  "privateLink": {
                    "id": "[parameters('privateLinkServices_pl_springapps_polaris_trn_externalid')]"
                  },
                  "privateLinkLocation": "uksouth",
                  "requestMessage": "Polaris TRN AFD route recruitment"
                },
                "enforceCertificateNameCheck": true
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-trn-spring-recruitment-origin-group')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups/origins",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-prod-adb2c-custom-ui-origin-group', 'polaris-prod-adb2c-custom-ui-origin')]",
              "properties": {
                "hostName": "lively-flower-000141503.5.azurestaticapps.net",
                "httpPort": 80,
                "httpsPort": 443,
                "originHostHeader": "lively-flower-000141503.5.azurestaticapps.net",
                "priority": 1,
                "weight": 1000,
                "enabledState": "Enabled",
                "enforceCertificateNameCheck": true
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-prod-adb2c-custom-ui-origin-group')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups/origins",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-prod-adb2c-tenant-origin-group', 'polaris-prod-adb2c-tenant-origin')]",
              "properties": {
                "hostName": "rinppolarisprod.b2clogin.com",
                "httpPort": 80,
                "httpsPort": 443,
                "originHostHeader": "rinppolarisprod.b2clogin.com",
                "priority": 1,
                "weight": 1000,
                "enabledState": "Enabled",
                "enforceCertificateNameCheck": true
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-prod-adb2c-tenant-origin-group')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups/origins",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-prod-frontend-origingroup', 'polaris-prod-frontend-swa-origin')]",
              "properties": {
                "hostName": "lively-ocean-0b466c803.5.azurestaticapps.net",
                "httpPort": 80,
                "httpsPort": 443,
                "originHostHeader": "lively-ocean-0b466c803.5.azurestaticapps.net",
                "priority": 1,
                "weight": 1000,
                "enabledState": "Enabled",
                "enforceCertificateNameCheck": true
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-prod-frontend-origingroup')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups/origins",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-prod-spring-users-origin-group', 'polaris-prod-spring-users-origin')]",
              "properties": {
                "hostName": "spring-polaris-prod-uksouth-user-service.private.azuremicroservices.io",
                "httpPort": 80,
                "httpsPort": 443,
                "originHostHeader": "spring-polaris-prod-uksouth-user-service.private.azuremicroservices.io",
                "priority": 1,
                "weight": 1000,
                "enabledState": "Enabled",
                "sharedPrivateLinkResource": {
                  "privateLink": {
                    "id": "[parameters('privateLinkServices_pl_springapps_polaris_prod_externalid')]"
                  },
                  "privateLinkLocation": "uksouth",
                  "requestMessage": "please approve"
                },
                "enforceCertificateNameCheck": true
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-prod-spring-users-origin-group')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups/origins",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-prod-spring-courses-origin-group', 'polaris-prod-spring-courses-origin')]",
              "properties": {
                "hostName": "spring-polaris-prod-uksouth-course-service.private.azuremicroservices.io",
                "httpPort": 80,
                "httpsPort": 443,
                "originHostHeader": "spring-polaris-prod-uksouth-course-service.private.azuremicroservices.io",
                "priority": 1,
                "weight": 1000,
                "enabledState": "Enabled",
                "sharedPrivateLinkResource": {
                  "privateLink": {
                    "id": "[parameters('privateLinkServices_pl_springapps_polaris_prod_externalid')]"
                  },
                  "privateLinkLocation": "uksouth",
                  "requestMessage": "please approve"
                },
                "enforceCertificateNameCheck": true
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-prod-spring-courses-origin-group')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups/origins",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-prod-spring-participants-origin-group', 'polaris-prod-spring-participants-origin')]",
              "properties": {
                "hostName": "spring-polaris-prod-uksouth-participant-service.private.azuremicroservices.io",
                "httpPort": 80,
                "httpsPort": 443,
                "originHostHeader": "spring-polaris-prod-uksouth-participant-service.private.azuremicroservices.io",
                "priority": 1,
                "weight": 1000,
                "enabledState": "Enabled",
                "sharedPrivateLinkResource": {
                  "privateLink": {
                    "id": "[parameters('privateLinkServices_pl_springapps_polaris_prod_externalid')]"
                  },
                  "privateLinkLocation": "uksouth",
                  "requestMessage": "please approve"
                },
                "enforceCertificateNameCheck": true
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-prod-spring-participants-origin-group')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups/origins",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-prod-spring-communication-origin-group', 'polaris-prod-spring-communication-origin')]",
              "properties": {
                "hostName": "spring-polaris-prod-uksouth-communication-service.private.azuremicroservices.io",
                "httpPort": 80,
                "httpsPort": 443,
                "originHostHeader": "spring-polaris-prod-uksouth-communication-service.private.azuremicroservices.io",
                "priority": 1,
                "weight": 1000,
                "enabledState": "Enabled",
                "sharedPrivateLinkResource": {
                  "privateLink": {
                    "id": "[parameters('privateLinkServices_pl_springapps_polaris_prod_externalid')]"
                  },
                  "privateLinkLocation": "uksouth",
                  "requestMessage": "please approve"
                },
                "enforceCertificateNameCheck": true
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-prod-spring-communication-origin-group')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups/origins",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-prod-spring-directus-origin-group', 'polaris-prod-spring-directus-origin')]",
              "properties": {
                "hostName": "spring-polaris-prod-uksouth-directus-management-service.private.azuremicroservices.io",
                "httpPort": 80,
                "httpsPort": 443,
                "originHostHeader": "spring-polaris-prod-uksouth-directus-management-service.private.azuremicroservices.io",
                "priority": 1,
                "weight": 1000,
                "enabledState": "Enabled",
                "sharedPrivateLinkResource": {
                  "privateLink": {
                    "id": "[parameters('privateLinkServices_pl_springapps_polaris_prod_externalid')]"
                  },
                  "privateLinkLocation": "uksouth",
                  "requestMessage": "please approve"
                },
                "enforceCertificateNameCheck": true
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-prod-spring-directus-origin-group')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups/origins",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-prod-spring-calendar-origin-group', 'polaris-prod-spring-calendar-origin')]",
              "properties": {
                "hostName": "spring-polaris-prod-uksouth-calendar-service.private.azuremicroservices.io",
                "httpPort": 80,
                "httpsPort": 443,
                "originHostHeader": "spring-polaris-prod-uksouth-calendar-service.private.azuremicroservices.io",
                "priority": 1,
                "weight": 1000,
                "enabledState": "Enabled",
                "sharedPrivateLinkResource": {
                  "privateLink": {
                    "id": "[parameters('privateLinkServices_pl_springapps_polaris_prod_externalid')]"
                  },
                  "privateLinkLocation": "uksouth",
                  "requestMessage": "please approve"
                },
                "enforceCertificateNameCheck": true
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-prod-spring-calendar-origin-group')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups/origins",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-prod-spring-documents-origin-group', 'polaris-prod-spring-documents-origin')]",
              "properties": {
                "hostName": "spring-polaris-prod-uksouth-document-service.private.azuremicroservices.io",
                "httpPort": 80,
                "httpsPort": 443,
                "originHostHeader": "spring-polaris-prod-uksouth-document-service.private.azuremicroservices.io",
                "priority": 1,
                "weight": 1000,
                "enabledState": "Enabled",
                "sharedPrivateLinkResource": {
                  "privateLink": {
                    "id": "[parameters('privateLinkServices_pl_springapps_polaris_prod_externalid')]"
                  },
                  "privateLinkLocation": "uksouth",
                  "requestMessage": "Polaris prod AFD route documents upload"
                },
                "enforceCertificateNameCheck": true
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-prod-spring-documents-origin-group')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/originGroups/origins",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-prod-spring-recruitment-origin-group', 'polaris-prod-spring-recruitment-origin')]",
              "properties": {
                "hostName": "spring-polaris-prod-uksouth-recruitment-service.private.azuremicroservices.io",
                "httpPort": 80,
                "httpsPort": 443,
                "originHostHeader": "spring-polaris-prod-uksouth-recruitment-service.private.azuremicroservices.io",
                "priority": 1,
                "weight": 1000,
                "enabledState": "Enabled",
                "sharedPrivateLinkResource": {
                  "privateLink": {
                    "id": "[parameters('privateLinkServices_pl_springapps_polaris_prod_externalid')]"
                  },
                  "privateLinkLocation": "uksouth",
                  "requestMessage": "Polaris PROD AFD route recruitment"
                },
                "enforceCertificateNameCheck": true
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-prod-spring-recruitment-origin-group')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/securityPolicies",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}', parameters('profiles_afd_name'), 'polaris-test-security-policy')]",
              "properties": {
                "parameters": {
                  "wafPolicy": {
                    "id": "[parameters('wafpolaristestid')]"
                  },
                  "associations": [
                    {
                      "domains": [
                        {
                          "id": "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'test-polaris-reedinpartnership-co-uk')]"
                        }
                      ],
                      "patternsToMatch": [
                        "/*"
                      ]
                    }
                  ],
                  "type": "WebApplicationFirewall"
                }
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles', parameters('profiles_afd_name'))]",
                "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'test-polaris-reedinpartnership-co-uk')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/securityPolicies",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}', parameters('profiles_afd_name'), 'polaris-uat-security-policy')]",
              "properties": {
                "parameters": {
                  "wafPolicy": {
                    "id": "[parameters('wafpolarisuatid')]"
                  },
                  "associations": [
                    {
                      "domains": [
                        {
                          "id": "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'uat-polaris-reedinpartnership-co-uk')]"
                        }
                      ],
                      "patternsToMatch": [
                        "/*"
                      ]
                    }
                  ],
                  "type": "WebApplicationFirewall"
                }
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles', parameters('profiles_afd_name'))]",
                "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'uat-polaris-reedinpartnership-co-uk')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/securityPolicies",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}', parameters('profiles_afd_name'), 'polaris-trn-security-policy')]",
              "properties": {
                "parameters": {
                  "wafPolicy": {
                    "id": "[parameters('wafpolaristrnid')]"
                  },
                  "associations": [
                    {
                      "domains": [
                        {
                          "id": "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'trn-polaris-reedinpartnership-co-uk')]"
                        }
                      ],
                      "patternsToMatch": [
                        "/*"
                      ]
                    }
                  ],
                  "type": "WebApplicationFirewall"
                }
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles', parameters('profiles_afd_name'))]",
                "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'trn-polaris-reedinpartnership-co-uk')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/securityPolicies",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}', parameters('profiles_afd_name'), 'polaris-prod-security-policy')]",
              "properties": {
                "parameters": {
                  "wafPolicy": {
                    "id": "[parameters('wafpolarisprodid')]"
                  },
                  "associations": [
                    {
                      "domains": [
                        {
                          "id": "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'prod-polaris-reedinpartnership-co-uk')]"
                        }
                      ],
                      "patternsToMatch": [
                        "/*"
                      ]
                    }
                  ],
                  "type": "WebApplicationFirewall"
                }
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles', parameters('profiles_afd_name'))]",
                "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'prod-polaris-reedinpartnership-co-uk')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/afdEndpoints/routes",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-test', 'default-route')]",
              "properties": {
                "cacheConfiguration": {
                  "compressionSettings": {
                    "isCompressionEnabled": true,
                    "contentTypesToCompress": [
                      "application/eot",
                      "application/font",
                      "application/font-sfnt",
                      "application/javascript",
                      "application/json",
                      "application/opentype",
                      "application/otf",
                      "application/pkcs7-mime",
                      "application/truetype",
                      "application/ttf",
                      "application/vnd.ms-fontobject",
                      "application/xhtml+xml",
                      "application/xml",
                      "application/xml+rss",
                      "application/x-font-opentype",
                      "application/x-font-truetype",
                      "application/x-font-ttf",
                      "application/x-httpd-cgi",
                      "application/x-javascript",
                      "application/x-mpegurl",
                      "application/x-opentype",
                      "application/x-otf",
                      "application/x-perl",
                      "application/x-ttf",
                      "font/eot",
                      "font/ttf",
                      "font/otf",
                      "font/opentype",
                      "image/svg+xml",
                      "text/css",
                      "text/csv",
                      "text/html",
                      "text/javascript",
                      "text/js",
                      "text/plain",
                      "text/richtext",
                      "text/tab-separated-values",
                      "text/xml",
                      "text/x-script",
                      "text/x-component",
                      "text/x-java-source"
                    ]
                  },
                  "queryStringCachingBehavior": "UseQueryString"
                },
                "customDomains": [
                  {
                    "id": "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'test-polaris-reedinpartnership-co-uk')]"
                  }
                ],
                "originGroup": {
                  "id": "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-test-frontend-origingroup')]"
                },
                "ruleSets": [],
                "supportedProtocols": [
                  "Http",
                  "Https"
                ],
                "patternsToMatch": [
                  "/*"
                ],
                "forwardingProtocol": "HttpsOnly",
                "linkToDefaultDomain": "Disabled",
                "httpsRedirect": "Enabled",
                "enabledState": "Enabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/afdEndpoints', parameters('profiles_afd_name'), 'polaris-test')]",
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-test-frontend-origingroup')]",
                "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'test-polaris-reedinpartnership-co-uk')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/afdEndpoints/routes",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-test', 'identity-adb2c')]",
              "properties": {
                "customDomains": [
                  {
                    "id": "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'test-id-reedinpartnership-co-uk')]"
                  }
                ],
                "originGroup": {
                  "id": "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-test-adb2c-tenant-origin-group')]"
                },
                "ruleSets": [
                  {
                    "id": "[resourceId('Microsoft.Cdn/profiles/ruleSets', parameters('profiles_afd_name'), 'testcorsruleset')]"
                  }
                ],
                "supportedProtocols": [
                  "Http",
                  "Https"
                ],
                "patternsToMatch": [
                  "/*"
                ],
                "forwardingProtocol": "HttpsOnly",
                "linkToDefaultDomain": "Disabled",
                "httpsRedirect": "Enabled",
                "enabledState": "Enabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/afdEndpoints', parameters('profiles_afd_name'), 'polaris-test')]",
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-test-adb2c-tenant-origin-group')]",
                "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'test-id-reedinpartnership-co-uk')]",
                "[resourceId('Microsoft.Cdn/profiles/ruleSets', parameters('profiles_afd_name'), 'testcorsruleset')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/afdEndpoints/routes",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-test', 'identity-adb2c-custom-ui')]",
              "properties": {
                "cacheConfiguration": {
                  "compressionSettings": {
                    "isCompressionEnabled": true,
                    "contentTypesToCompress": [
                      "application/eot",
                      "application/font",
                      "application/font-sfnt",
                      "application/javascript",
                      "application/json",
                      "application/opentype",
                      "application/otf",
                      "application/pkcs7-mime",
                      "application/truetype",
                      "application/ttf",
                      "application/vnd.ms-fontobject",
                      "application/xhtml+xml",
                      "application/xml",
                      "application/xml+rss",
                      "application/x-font-opentype",
                      "application/x-font-truetype",
                      "application/x-font-ttf",
                      "application/x-httpd-cgi",
                      "application/x-javascript",
                      "application/x-mpegurl",
                      "application/x-opentype",
                      "application/x-otf",
                      "application/x-perl",
                      "application/x-ttf",
                      "font/eot",
                      "font/ttf",
                      "font/otf",
                      "font/opentype",
                      "image/svg+xml",
                      "text/css",
                      "text/csv",
                      "text/html",
                      "text/javascript",
                      "text/js",
                      "text/plain",
                      "text/richtext",
                      "text/tab-separated-values",
                      "text/xml",
                      "text/x-script",
                      "text/x-component",
                      "text/x-java-source"
                    ]
                  },
                  "queryStringCachingBehavior": "IgnoreQueryString"
                },
                "customDomains": [
                  {
                    "id": "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'test-id-reedinpartnership-co-uk')]"
                  }
                ],
                "originGroup": {
                  "id": "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-test-adb2c-custom-ui-origin-group')]"
                },
                "ruleSets": [
                  {
                    "id": "[resourceId('Microsoft.Cdn/profiles/ruleSets', parameters('profiles_afd_name'), 'testcorsruleset')]"
                  }
                ],
                "supportedProtocols": [
                  "Http",
                  "Https"
                ],
                "patternsToMatch": [
                  "/reedinpartnership/ui/*"
                ],
                "forwardingProtocol": "HttpsOnly",
                "linkToDefaultDomain": "Disabled",
                "httpsRedirect": "Enabled",
                "enabledState": "Enabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/afdEndpoints', parameters('profiles_afd_name'), 'polaris-test')]",
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-test-adb2c-custom-ui-origin-group')]",
                "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'test-id-reedinpartnership-co-uk')]",
                "[resourceId('Microsoft.Cdn/profiles/ruleSets', parameters('profiles_afd_name'), 'testcorsruleset')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/afdEndpoints/routes",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-test', 'services-users')]",
              "properties": {
                "customDomains": [
                  {
                    "id": "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'test-polaris-reedinpartnership-co-uk')]"
                  }
                ],
                "originGroup": {
                  "id": "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-test-spring-users-origin-group')]"
                },
                "originPath": "/",
                "ruleSets": [],
                "supportedProtocols": [
                  "Http",
                  "Https"
                ],
                "patternsToMatch": [
                  "/services/users/*"
                ],
                "forwardingProtocol": "HttpsOnly",
                "linkToDefaultDomain": "Disabled",
                "httpsRedirect": "Enabled",
                "enabledState": "Enabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/afdEndpoints', parameters('profiles_afd_name'), 'polaris-test')]",
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-test-spring-users-origin-group')]",
                "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'test-polaris-reedinpartnership-co-uk')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/afdEndpoints/routes",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-test', 'services-courses')]",
              "properties": {
                "customDomains": [
                  {
                    "id": "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'test-polaris-reedinpartnership-co-uk')]"
                  }
                ],
                "originGroup": {
                  "id": "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-test-spring-courses-origin-group')]"
                },
                "originPath": "/",
                "ruleSets": [],
                "supportedProtocols": [
                  "Http",
                  "Https"
                ],
                "patternsToMatch": [
                  "/services/courses/*"
                ],
                "forwardingProtocol": "HttpsOnly",
                "linkToDefaultDomain": "Disabled",
                "httpsRedirect": "Enabled",
                "enabledState": "Enabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-test-spring-courses-origin-group')]",
                "[resourceId('Microsoft.Cdn/profiles/afdEndpoints', parameters('profiles_afd_name'), 'polaris-test')]",
                "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'test-polaris-reedinpartnership-co-uk')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/afdEndpoints/routes",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-test', 'services-participants')]",
              "properties": {
                "customDomains": [
                  {
                    "id": "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'test-polaris-reedinpartnership-co-uk')]"
                  }
                ],
                "originGroup": {
                  "id": "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-test-spring-participants-origin-group')]"
                },
                "originPath": "/",
                "ruleSets": [],
                "supportedProtocols": [
                  "Http",
                  "Https"
                ],
                "patternsToMatch": [
                  "/services/participants/*"
                ],
                "forwardingProtocol": "HttpsOnly",
                "linkToDefaultDomain": "Disabled",
                "httpsRedirect": "Enabled",
                "enabledState": "Enabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-test-spring-participants-origin-group')]",
                "[resourceId('Microsoft.Cdn/profiles/afdEndpoints', parameters('profiles_afd_name'), 'polaris-test')]",
                "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'test-polaris-reedinpartnership-co-uk')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/afdEndpoints/routes",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-test', 'services-communication')]",
              "properties": {
                "customDomains": [
                  {
                    "id": "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'test-polaris-reedinpartnership-co-uk')]"
                  }
                ],
                "originGroup": {
                  "id": "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-test-spring-communication-origin-group')]"
                },
                "originPath": "/",
                "ruleSets": [],
                "supportedProtocols": [
                  "Http",
                  "Https"
                ],
                "patternsToMatch": [
                  "/services/communication/*"
                ],
                "forwardingProtocol": "HttpsOnly",
                "linkToDefaultDomain": "Disabled",
                "httpsRedirect": "Enabled",
                "enabledState": "Enabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-test-spring-communication-origin-group')]",
                "[resourceId('Microsoft.Cdn/profiles/afdEndpoints', parameters('profiles_afd_name'), 'polaris-test')]",
                "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'test-polaris-reedinpartnership-co-uk')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/afdEndpoints/routes",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-test', 'services-directus')]",
              "properties": {
                "customDomains": [
                  {
                    "id": "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'test-polaris-reedinpartnership-co-uk')]"
                  }
                ],
                "originGroup": {
                  "id": "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-test-spring-directus-origin-group')]"
                },
                "originPath": "/",
                "ruleSets": [],
                "supportedProtocols": [
                  "Http",
                  "Https"
                ],
                "patternsToMatch": [
                  "/services/directus/*"
                ],
                "forwardingProtocol": "HttpsOnly",
                "linkToDefaultDomain": "Disabled",
                "httpsRedirect": "Enabled",
                "enabledState": "Enabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-test-spring-directus-origin-group')]",
                "[resourceId('Microsoft.Cdn/profiles/afdEndpoints', parameters('profiles_afd_name'), 'polaris-test')]",
                "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'test-polaris-reedinpartnership-co-uk')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/afdEndpoints/routes",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-test', 'services-calendar')]",
              "properties": {
                "customDomains": [
                  {
                    "id": "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'test-polaris-reedinpartnership-co-uk')]"
                  }
                ],
                "originGroup": {
                  "id": "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-test-spring-calendar-origin-group')]"
                },
                "originPath": "/",
                "ruleSets": [],
                "supportedProtocols": [
                  "Http",
                  "Https"
                ],
                "patternsToMatch": [
                  "/services/calendar/*"
                ],
                "forwardingProtocol": "HttpsOnly",
                "linkToDefaultDomain": "Disabled",
                "httpsRedirect": "Enabled",
                "enabledState": "Enabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-test-spring-calendar-origin-group')]",
                "[resourceId('Microsoft.Cdn/profiles/afdEndpoints', parameters('profiles_afd_name'), 'polaris-test')]",
                "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'test-polaris-reedinpartnership-co-uk')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/afdEndpoints/routes",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-test', 'services-documents')]",
              "properties": {
                "customDomains": [
                  {
                    "id": "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'test-polaris-reedinpartnership-co-uk')]"
                  }
                ],
                "originGroup": {
                  "id": "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-test-spring-documents-origin-group')]"
                },
                "originPath": "/",
                "ruleSets": [],
                "supportedProtocols": [
                  "Http",
                  "Https"
                ],
                "patternsToMatch": [
                  "/services/documents/*"
                ],
                "forwardingProtocol": "HttpsOnly",
                "linkToDefaultDomain": "Disabled",
                "httpsRedirect": "Enabled",
                "enabledState": "Enabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-test-spring-documents-origin-group')]",
                "[resourceId('Microsoft.Cdn/profiles/afdEndpoints', parameters('profiles_afd_name'), 'polaris-test')]",
                "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'test-polaris-reedinpartnership-co-uk')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/afdEndpoints/routes",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-test', 'services-recruitment')]",
              "properties": {
                "customDomains": [
                  {
                    "id": "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'test-polaris-reedinpartnership-co-uk')]"
                  }
                ],
                "originGroup": {
                  "id": "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-test-spring-recruitment-origin-group')]"
                },
                "originPath": "/",
                "ruleSets": [],
                "supportedProtocols": [
                  "Http",
                  "Https"
                ],
                "patternsToMatch": [
                  "/services/recruitment/*"
                ],
                "forwardingProtocol": "HttpsOnly",
                "linkToDefaultDomain": "Disabled",
                "httpsRedirect": "Enabled",
                "enabledState": "Enabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-test-spring-recruitment-origin-group')]",
                "[resourceId('Microsoft.Cdn/profiles/afdEndpoints', parameters('profiles_afd_name'), 'polaris-test')]",
                "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'test-polaris-reedinpartnership-co-uk')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/afdEndpoints/routes",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-uat', 'default-route')]",
              "properties": {
                "cacheConfiguration": {
                  "compressionSettings": {
                    "isCompressionEnabled": true,
                    "contentTypesToCompress": [
                      "application/eot",
                      "application/font",
                      "application/font-sfnt",
                      "application/javascript",
                      "application/json",
                      "application/opentype",
                      "application/otf",
                      "application/pkcs7-mime",
                      "application/truetype",
                      "application/ttf",
                      "application/vnd.ms-fontobject",
                      "application/xhtml+xml",
                      "application/xml",
                      "application/xml+rss",
                      "application/x-font-opentype",
                      "application/x-font-truetype",
                      "application/x-font-ttf",
                      "application/x-httpd-cgi",
                      "application/x-javascript",
                      "application/x-mpegurl",
                      "application/x-opentype",
                      "application/x-otf",
                      "application/x-perl",
                      "application/x-ttf",
                      "font/eot",
                      "font/ttf",
                      "font/otf",
                      "font/opentype",
                      "image/svg+xml",
                      "text/css",
                      "text/csv",
                      "text/html",
                      "text/javascript",
                      "text/js",
                      "text/plain",
                      "text/richtext",
                      "text/tab-separated-values",
                      "text/xml",
                      "text/x-script",
                      "text/x-component",
                      "text/x-java-source"
                    ]
                  },
                  "queryStringCachingBehavior": "UseQueryString"
                },
                "customDomains": [
                  {
                    "id": "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'uat-polaris-reedinpartnership-co-uk')]"
                  }
                ],
                "originGroup": {
                  "id": "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-uat-frontend-origingroup')]"
                },
                "ruleSets": [],
                "supportedProtocols": [
                  "Http",
                  "Https"
                ],
                "patternsToMatch": [
                  "/*"
                ],
                "forwardingProtocol": "HttpsOnly",
                "linkToDefaultDomain": "Disabled",
                "httpsRedirect": "Enabled",
                "enabledState": "Enabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/afdEndpoints', parameters('profiles_afd_name'), 'polaris-uat')]",
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-uat-frontend-origingroup')]",
                "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'uat-polaris-reedinpartnership-co-uk')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/afdEndpoints/routes",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-uat', 'identity-adb2c')]",
              "properties": {
                "customDomains": [
                  {
                    "id": "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'uat-id-reedinpartnership-co-uk')]"
                  }
                ],
                "originGroup": {
                  "id": "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-uat-adb2c-tenant-origin-group')]"
                },
                "ruleSets": [
                  {
                    "id": "[resourceId('Microsoft.Cdn/profiles/ruleSets', parameters('profiles_afd_name'), 'uatcorsruleset')]"
                  }
                ],
                "supportedProtocols": [
                  "Http",
                  "Https"
                ],
                "patternsToMatch": [
                  "/*"
                ],
                "forwardingProtocol": "HttpsOnly",
                "linkToDefaultDomain": "Disabled",
                "httpsRedirect": "Enabled",
                "enabledState": "Enabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/afdEndpoints', parameters('profiles_afd_name'), 'polaris-uat')]",
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-uat-adb2c-tenant-origin-group')]",
                "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'uat-id-reedinpartnership-co-uk')]",
                "[resourceId('Microsoft.Cdn/profiles/ruleSets', parameters('profiles_afd_name'), 'uatcorsruleset')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/afdEndpoints/routes",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-uat', 'identity-adb2c-custom-ui')]",
              "properties": {
                "cacheConfiguration": {
                  "compressionSettings": {
                    "isCompressionEnabled": true,
                    "contentTypesToCompress": [
                      "application/eot",
                      "application/font",
                      "application/font-sfnt",
                      "application/javascript",
                      "application/json",
                      "application/opentype",
                      "application/otf",
                      "application/pkcs7-mime",
                      "application/truetype",
                      "application/ttf",
                      "application/vnd.ms-fontobject",
                      "application/xhtml+xml",
                      "application/xml",
                      "application/xml+rss",
                      "application/x-font-opentype",
                      "application/x-font-truetype",
                      "application/x-font-ttf",
                      "application/x-httpd-cgi",
                      "application/x-javascript",
                      "application/x-mpegurl",
                      "application/x-opentype",
                      "application/x-otf",
                      "application/x-perl",
                      "application/x-ttf",
                      "font/eot",
                      "font/ttf",
                      "font/otf",
                      "font/opentype",
                      "image/svg+xml",
                      "text/css",
                      "text/csv",
                      "text/html",
                      "text/javascript",
                      "text/js",
                      "text/plain",
                      "text/richtext",
                      "text/tab-separated-values",
                      "text/xml",
                      "text/x-script",
                      "text/x-component",
                      "text/x-java-source"
                    ]
                  },
                  "queryStringCachingBehavior": "IgnoreQueryString"
                },
                "customDomains": [
                  {
                    "id": "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'uat-id-reedinpartnership-co-uk')]"
                  }
                ],
                "originGroup": {
                  "id": "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-uat-adb2c-custom-ui-origin-group')]"
                },
                "ruleSets": [
                  {
                    "id": "[resourceId('Microsoft.Cdn/profiles/ruleSets', parameters('profiles_afd_name'), 'uatcorsruleset')]"
                  }
                ],
                "supportedProtocols": [
                  "Http",
                  "Https"
                ],
                "patternsToMatch": [
                  "/reedinpartnership/ui/*"
                ],
                "forwardingProtocol": "HttpsOnly",
                "linkToDefaultDomain": "Disabled",
                "httpsRedirect": "Enabled",
                "enabledState": "Enabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/afdEndpoints', parameters('profiles_afd_name'), 'polaris-uat')]",
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-uat-adb2c-custom-ui-origin-group')]",
                "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'uat-id-reedinpartnership-co-uk')]",
                "[resourceId('Microsoft.Cdn/profiles/ruleSets', parameters('profiles_afd_name'), 'uatcorsruleset')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/afdEndpoints/routes",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-uat', 'services-users')]",
              "properties": {
                "customDomains": [
                  {
                    "id": "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'uat-polaris-reedinpartnership-co-uk')]"
                  }
                ],
                "originGroup": {
                  "id": "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-uat-spring-users-origin-group')]"
                },
                "originPath": "/",
                "ruleSets": [],
                "supportedProtocols": [
                  "Http",
                  "Https"
                ],
                "patternsToMatch": [
                  "/services/users/*"
                ],
                "forwardingProtocol": "HttpsOnly",
                "linkToDefaultDomain": "Disabled",
                "httpsRedirect": "Enabled",
                "enabledState": "Enabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/afdEndpoints', parameters('profiles_afd_name'), 'polaris-uat')]",
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-uat-spring-users-origin-group')]",
                "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'uat-polaris-reedinpartnership-co-uk')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/afdEndpoints/routes",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-uat', 'services-courses')]",
              "properties": {
                "customDomains": [
                  {
                    "id": "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'uat-polaris-reedinpartnership-co-uk')]"
                  }
                ],
                "originGroup": {
                  "id": "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-uat-spring-courses-origin-group')]"
                },
                "originPath": "/",
                "ruleSets": [],
                "supportedProtocols": [
                  "Http",
                  "Https"
                ],
                "patternsToMatch": [
                  "/services/courses/*"
                ],
                "forwardingProtocol": "HttpsOnly",
                "linkToDefaultDomain": "Disabled",
                "httpsRedirect": "Enabled",
                "enabledState": "Enabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-uat-spring-courses-origin-group')]",
                "[resourceId('Microsoft.Cdn/profiles/afdEndpoints', parameters('profiles_afd_name'), 'polaris-uat')]",
                "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'uat-polaris-reedinpartnership-co-uk')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/afdEndpoints/routes",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-uat', 'services-participants')]",
              "properties": {
                "customDomains": [
                  {
                    "id": "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'uat-polaris-reedinpartnership-co-uk')]"
                  }
                ],
                "originGroup": {
                  "id": "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-uat-spring-participants-origin-group')]"
                },
                "originPath": "/",
                "ruleSets": [],
                "supportedProtocols": [
                  "Http",
                  "Https"
                ],
                "patternsToMatch": [
                  "/services/participants/*"
                ],
                "forwardingProtocol": "HttpsOnly",
                "linkToDefaultDomain": "Disabled",
                "httpsRedirect": "Enabled",
                "enabledState": "Enabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-uat-spring-participants-origin-group')]",
                "[resourceId('Microsoft.Cdn/profiles/afdEndpoints', parameters('profiles_afd_name'), 'polaris-uat')]",
                "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'uat-polaris-reedinpartnership-co-uk')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/afdEndpoints/routes",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-uat', 'services-communication')]",
              "properties": {
                "customDomains": [
                  {
                    "id": "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'uat-polaris-reedinpartnership-co-uk')]"
                  }
                ],
                "originGroup": {
                  "id": "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-uat-spring-communication-origin-group')]"
                },
                "originPath": "/",
                "ruleSets": [],
                "supportedProtocols": [
                  "Http",
                  "Https"
                ],
                "patternsToMatch": [
                  "/services/communication/*"
                ],
                "forwardingProtocol": "HttpsOnly",
                "linkToDefaultDomain": "Disabled",
                "httpsRedirect": "Enabled",
                "enabledState": "Enabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-uat-spring-communication-origin-group')]",
                "[resourceId('Microsoft.Cdn/profiles/afdEndpoints', parameters('profiles_afd_name'), 'polaris-uat')]",
                "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'uat-polaris-reedinpartnership-co-uk')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/afdEndpoints/routes",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-uat', 'services-directus')]",
              "properties": {
                "customDomains": [
                  {
                    "id": "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'uat-polaris-reedinpartnership-co-uk')]"
                  }
                ],
                "originGroup": {
                  "id": "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-uat-spring-directus-origin-group')]"
                },
                "originPath": "/",
                "ruleSets": [],
                "supportedProtocols": [
                  "Http",
                  "Https"
                ],
                "patternsToMatch": [
                  "/services/directus/*"
                ],
                "forwardingProtocol": "HttpsOnly",
                "linkToDefaultDomain": "Disabled",
                "httpsRedirect": "Enabled",
                "enabledState": "Enabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-uat-spring-directus-origin-group')]",
                "[resourceId('Microsoft.Cdn/profiles/afdEndpoints', parameters('profiles_afd_name'), 'polaris-uat')]",
                "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'uat-polaris-reedinpartnership-co-uk')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/afdEndpoints/routes",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-uat', 'services-calendar')]",
              "properties": {
                "customDomains": [
                  {
                    "id": "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'uat-polaris-reedinpartnership-co-uk')]"
                  }
                ],
                "originGroup": {
                  "id": "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-uat-spring-calendar-origin-group')]"
                },
                "originPath": "/",
                "ruleSets": [],
                "supportedProtocols": [
                  "Http",
                  "Https"
                ],
                "patternsToMatch": [
                  "/services/calendar/*"
                ],
                "forwardingProtocol": "HttpsOnly",
                "linkToDefaultDomain": "Disabled",
                "httpsRedirect": "Enabled",
                "enabledState": "Enabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-uat-spring-calendar-origin-group')]",
                "[resourceId('Microsoft.Cdn/profiles/afdEndpoints', parameters('profiles_afd_name'), 'polaris-uat')]",
                "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'uat-polaris-reedinpartnership-co-uk')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/afdEndpoints/routes",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-uat', 'services-documents')]",
              "properties": {
                "customDomains": [
                  {
                    "id": "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'uat-polaris-reedinpartnership-co-uk')]"
                  }
                ],
                "originGroup": {
                  "id": "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-uat-spring-documents-origin-group')]"
                },
                "originPath": "/",
                "ruleSets": [],
                "supportedProtocols": [
                  "Http",
                  "Https"
                ],
                "patternsToMatch": [
                  "/services/documents/*"
                ],
                "forwardingProtocol": "HttpsOnly",
                "linkToDefaultDomain": "Disabled",
                "httpsRedirect": "Enabled",
                "enabledState": "Enabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-uat-spring-documents-origin-group')]",
                "[resourceId('Microsoft.Cdn/profiles/afdEndpoints', parameters('profiles_afd_name'), 'polaris-uat')]",
                "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'uat-polaris-reedinpartnership-co-uk')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/afdEndpoints/routes",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-uat', 'services-recruitment')]",
              "properties": {
                "customDomains": [
                  {
                    "id": "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'uat-polaris-reedinpartnership-co-uk')]"
                  }
                ],
                "originGroup": {
                  "id": "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-uat-spring-recruitment-origin-group')]"
                },
                "originPath": "/",
                "ruleSets": [],
                "supportedProtocols": [
                  "Http",
                  "Https"
                ],
                "patternsToMatch": [
                  "/services/recruitment/*"
                ],
                "forwardingProtocol": "HttpsOnly",
                "linkToDefaultDomain": "Disabled",
                "httpsRedirect": "Enabled",
                "enabledState": "Enabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-uat-spring-recruitment-origin-group')]",
                "[resourceId('Microsoft.Cdn/profiles/afdEndpoints', parameters('profiles_afd_name'), 'polaris-uat')]",
                "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'uat-polaris-reedinpartnership-co-uk')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/afdEndpoints/routes",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-trn', 'default-route')]",
              "properties": {
                "cacheConfiguration": {
                  "compressionSettings": {
                    "isCompressionEnabled": true,
                    "contentTypesToCompress": [
                      "application/eot",
                      "application/font",
                      "application/font-sfnt",
                      "application/javascript",
                      "application/json",
                      "application/opentype",
                      "application/otf",
                      "application/pkcs7-mime",
                      "application/truetype",
                      "application/ttf",
                      "application/vnd.ms-fontobject",
                      "application/xhtml+xml",
                      "application/xml",
                      "application/xml+rss",
                      "application/x-font-opentype",
                      "application/x-font-truetype",
                      "application/x-font-ttf",
                      "application/x-httpd-cgi",
                      "application/x-javascript",
                      "application/x-mpegurl",
                      "application/x-opentype",
                      "application/x-otf",
                      "application/x-perl",
                      "application/x-ttf",
                      "font/eot",
                      "font/ttf",
                      "font/otf",
                      "font/opentype",
                      "image/svg+xml",
                      "text/css",
                      "text/csv",
                      "text/html",
                      "text/javascript",
                      "text/js",
                      "text/plain",
                      "text/richtext",
                      "text/tab-separated-values",
                      "text/xml",
                      "text/x-script",
                      "text/x-component",
                      "text/x-java-source"
                    ]
                  },
                  "queryStringCachingBehavior": "UseQueryString"
                },
                "customDomains": [
                  {
                    "id": "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'trn-polaris-reedinpartnership-co-uk')]"
                  }
                ],
                "originGroup": {
                  "id": "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-trn-frontend-origingroup')]"
                },
                "ruleSets": [],
                "supportedProtocols": [
                  "Http",
                  "Https"
                ],
                "patternsToMatch": [
                  "/*"
                ],
                "forwardingProtocol": "HttpsOnly",
                "linkToDefaultDomain": "Disabled",
                "httpsRedirect": "Enabled",
                "enabledState": "Enabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/afdEndpoints', parameters('profiles_afd_name'), 'polaris-trn')]",
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-trn-frontend-origingroup')]",
                "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'trn-polaris-reedinpartnership-co-uk')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/afdEndpoints/routes",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-trn', 'identity-adb2c')]",
              "properties": {
                "customDomains": [
                  {
                    "id": "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'trn-id-reedinpartnership-co-uk')]"
                  }
                ],
                "originGroup": {
                  "id": "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-trn-adb2c-tenant-origin-group')]"
                },
                "ruleSets": [
                  {
                    "id": "[resourceId('Microsoft.Cdn/profiles/ruleSets', parameters('profiles_afd_name'), 'trncorsruleset')]"
                  }
                ],
                "supportedProtocols": [
                  "Http",
                  "Https"
                ],
                "patternsToMatch": [
                  "/*"
                ],
                "forwardingProtocol": "HttpsOnly",
                "linkToDefaultDomain": "Disabled",
                "httpsRedirect": "Enabled",
                "enabledState": "Enabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/afdEndpoints', parameters('profiles_afd_name'), 'polaris-trn')]",
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-trn-adb2c-tenant-origin-group')]",
                "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'trn-id-reedinpartnership-co-uk')]",
                "[resourceId('Microsoft.Cdn/profiles/ruleSets', parameters('profiles_afd_name'), 'trncorsruleset')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/afdEndpoints/routes",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-trn', 'identity-adb2c-custom-ui')]",
              "properties": {
                "cacheConfiguration": {
                  "compressionSettings": {
                    "isCompressionEnabled": true,
                    "contentTypesToCompress": [
                      "application/eot",
                      "application/font",
                      "application/font-sfnt",
                      "application/javascript",
                      "application/json",
                      "application/opentype",
                      "application/otf",
                      "application/pkcs7-mime",
                      "application/truetype",
                      "application/ttf",
                      "application/vnd.ms-fontobject",
                      "application/xhtml+xml",
                      "application/xml",
                      "application/xml+rss",
                      "application/x-font-opentype",
                      "application/x-font-truetype",
                      "application/x-font-ttf",
                      "application/x-httpd-cgi",
                      "application/x-javascript",
                      "application/x-mpegurl",
                      "application/x-opentype",
                      "application/x-otf",
                      "application/x-perl",
                      "application/x-ttf",
                      "font/eot",
                      "font/ttf",
                      "font/otf",
                      "font/opentype",
                      "image/svg+xml",
                      "text/css",
                      "text/csv",
                      "text/html",
                      "text/javascript",
                      "text/js",
                      "text/plain",
                      "text/richtext",
                      "text/tab-separated-values",
                      "text/xml",
                      "text/x-script",
                      "text/x-component",
                      "text/x-java-source"
                    ]
                  },
                  "queryStringCachingBehavior": "IgnoreQueryString"
                },
                "customDomains": [
                  {
                    "id": "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'trn-id-reedinpartnership-co-uk')]"
                  }
                ],
                "originGroup": {
                  "id": "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-trn-adb2c-custom-ui-origin-group')]"
                },
                "ruleSets": [
                  {
                    "id": "[resourceId('Microsoft.Cdn/profiles/ruleSets', parameters('profiles_afd_name'), 'trncorsruleset')]"
                  }
                ],
                "supportedProtocols": [
                  "Http",
                  "Https"
                ],
                "patternsToMatch": [
                  "/reedinpartnership/ui/*"
                ],
                "forwardingProtocol": "HttpsOnly",
                "linkToDefaultDomain": "Disabled",
                "httpsRedirect": "Enabled",
                "enabledState": "Enabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/afdEndpoints', parameters('profiles_afd_name'), 'polaris-trn')]",
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-trn-adb2c-custom-ui-origin-group')]",
                "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'trn-id-reedinpartnership-co-uk')]",
                "[resourceId('Microsoft.Cdn/profiles/ruleSets', parameters('profiles_afd_name'), 'trncorsruleset')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/afdEndpoints/routes",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-trn', 'services-users')]",
              "properties": {
                "customDomains": [
                  {
                    "id": "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'trn-polaris-reedinpartnership-co-uk')]"
                  }
                ],
                "originGroup": {
                  "id": "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-trn-spring-users-origin-group')]"
                },
                "originPath": "/",
                "ruleSets": [],
                "supportedProtocols": [
                  "Http",
                  "Https"
                ],
                "patternsToMatch": [
                  "/services/users/*"
                ],
                "forwardingProtocol": "HttpsOnly",
                "linkToDefaultDomain": "Disabled",
                "httpsRedirect": "Enabled",
                "enabledState": "Enabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/afdEndpoints', parameters('profiles_afd_name'), 'polaris-trn')]",
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-trn-spring-users-origin-group')]",
                "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'trn-polaris-reedinpartnership-co-uk')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/afdEndpoints/routes",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-trn', 'services-courses')]",
              "properties": {
                "customDomains": [
                  {
                    "id": "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'trn-polaris-reedinpartnership-co-uk')]"
                  }
                ],
                "originGroup": {
                  "id": "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-trn-spring-courses-origin-group')]"
                },
                "originPath": "/",
                "ruleSets": [],
                "supportedProtocols": [
                  "Http",
                  "Https"
                ],
                "patternsToMatch": [
                  "/services/courses/*"
                ],
                "forwardingProtocol": "HttpsOnly",
                "linkToDefaultDomain": "Disabled",
                "httpsRedirect": "Enabled",
                "enabledState": "Enabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-trn-spring-courses-origin-group')]",
                "[resourceId('Microsoft.Cdn/profiles/afdEndpoints', parameters('profiles_afd_name'), 'polaris-trn')]",
                "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'trn-polaris-reedinpartnership-co-uk')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/afdEndpoints/routes",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-trn', 'services-participants')]",
              "properties": {
                "customDomains": [
                  {
                    "id": "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'trn-polaris-reedinpartnership-co-uk')]"
                  }
                ],
                "originGroup": {
                  "id": "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-trn-spring-participants-origin-group')]"
                },
                "originPath": "/",
                "ruleSets": [],
                "supportedProtocols": [
                  "Http",
                  "Https"
                ],
                "patternsToMatch": [
                  "/services/participants/*"
                ],
                "forwardingProtocol": "HttpsOnly",
                "linkToDefaultDomain": "Disabled",
                "httpsRedirect": "Enabled",
                "enabledState": "Enabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-trn-spring-participants-origin-group')]",
                "[resourceId('Microsoft.Cdn/profiles/afdEndpoints', parameters('profiles_afd_name'), 'polaris-trn')]",
                "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'trn-polaris-reedinpartnership-co-uk')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/afdEndpoints/routes",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-trn', 'services-communication')]",
              "properties": {
                "customDomains": [
                  {
                    "id": "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'trn-polaris-reedinpartnership-co-uk')]"
                  }
                ],
                "originGroup": {
                  "id": "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-trn-spring-communication-origin-group')]"
                },
                "originPath": "/",
                "ruleSets": [],
                "supportedProtocols": [
                  "Http",
                  "Https"
                ],
                "patternsToMatch": [
                  "/services/communication/*"
                ],
                "forwardingProtocol": "HttpsOnly",
                "linkToDefaultDomain": "Disabled",
                "httpsRedirect": "Enabled",
                "enabledState": "Enabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-trn-spring-communication-origin-group')]",
                "[resourceId('Microsoft.Cdn/profiles/afdEndpoints', parameters('profiles_afd_name'), 'polaris-trn')]",
                "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'trn-polaris-reedinpartnership-co-uk')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/afdEndpoints/routes",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-trn', 'services-directus')]",
              "properties": {
                "customDomains": [
                  {
                    "id": "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'trn-polaris-reedinpartnership-co-uk')]"
                  }
                ],
                "originGroup": {
                  "id": "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-trn-spring-directus-origin-group')]"
                },
                "originPath": "/",
                "ruleSets": [],
                "supportedProtocols": [
                  "Http",
                  "Https"
                ],
                "patternsToMatch": [
                  "/services/directus/*"
                ],
                "forwardingProtocol": "HttpsOnly",
                "linkToDefaultDomain": "Disabled",
                "httpsRedirect": "Enabled",
                "enabledState": "Enabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-trn-spring-directus-origin-group')]",
                "[resourceId('Microsoft.Cdn/profiles/afdEndpoints', parameters('profiles_afd_name'), 'polaris-trn')]",
                "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'trn-polaris-reedinpartnership-co-uk')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/afdEndpoints/routes",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-trn', 'services-calendar')]",
              "properties": {
                "customDomains": [
                  {
                    "id": "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'trn-polaris-reedinpartnership-co-uk')]"
                  }
                ],
                "originGroup": {
                  "id": "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-trn-spring-calendar-origin-group')]"
                },
                "originPath": "/",
                "ruleSets": [],
                "supportedProtocols": [
                  "Http",
                  "Https"
                ],
                "patternsToMatch": [
                  "/services/calendar/*"
                ],
                "forwardingProtocol": "HttpsOnly",
                "linkToDefaultDomain": "Disabled",
                "httpsRedirect": "Enabled",
                "enabledState": "Enabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-trn-spring-calendar-origin-group')]",
                "[resourceId('Microsoft.Cdn/profiles/afdEndpoints', parameters('profiles_afd_name'), 'polaris-trn')]",
                "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'trn-polaris-reedinpartnership-co-uk')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/afdEndpoints/routes",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-trn', 'services-documents')]",
              "properties": {
                "customDomains": [
                  {
                    "id": "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'trn-polaris-reedinpartnership-co-uk')]"
                  }
                ],
                "originGroup": {
                  "id": "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-trn-spring-documents-origin-group')]"
                },
                "originPath": "/",
                "ruleSets": [],
                "supportedProtocols": [
                  "Http",
                  "Https"
                ],
                "patternsToMatch": [
                  "/services/documents/*"
                ],
                "forwardingProtocol": "HttpsOnly",
                "linkToDefaultDomain": "Disabled",
                "httpsRedirect": "Enabled",
                "enabledState": "Enabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-trn-spring-documents-origin-group')]",
                "[resourceId('Microsoft.Cdn/profiles/afdEndpoints', parameters('profiles_afd_name'), 'polaris-trn')]",
                "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'trn-polaris-reedinpartnership-co-uk')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/afdEndpoints/routes",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-trn', 'services-recruitment')]",
              "properties": {
                "customDomains": [
                  {
                    "id": "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'trn-polaris-reedinpartnership-co-uk')]"
                  }
                ],
                "originGroup": {
                  "id": "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-trn-spring-recruitment-origin-group')]"
                },
                "originPath": "/",
                "ruleSets": [],
                "supportedProtocols": [
                  "Http",
                  "Https"
                ],
                "patternsToMatch": [
                  "/services/recruitment/*"
                ],
                "forwardingProtocol": "HttpsOnly",
                "linkToDefaultDomain": "Disabled",
                "httpsRedirect": "Enabled",
                "enabledState": "Enabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-trn-spring-recruitment-origin-group')]",
                "[resourceId('Microsoft.Cdn/profiles/afdEndpoints', parameters('profiles_afd_name'), 'polaris-trn')]",
                "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'trn-polaris-reedinpartnership-co-uk')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/afdEndpoints/routes",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-prod', 'default-route')]",
              "properties": {
                "cacheConfiguration": {
                  "compressionSettings": {
                    "isCompressionEnabled": true,
                    "contentTypesToCompress": [
                      "application/eot",
                      "application/font",
                      "application/font-sfnt",
                      "application/javascript",
                      "application/json",
                      "application/opentype",
                      "application/otf",
                      "application/pkcs7-mime",
                      "application/truetype",
                      "application/ttf",
                      "application/vnd.ms-fontobject",
                      "application/xhtml+xml",
                      "application/xml",
                      "application/xml+rss",
                      "application/x-font-opentype",
                      "application/x-font-truetype",
                      "application/x-font-ttf",
                      "application/x-httpd-cgi",
                      "application/x-javascript",
                      "application/x-mpegurl",
                      "application/x-opentype",
                      "application/x-otf",
                      "application/x-perl",
                      "application/x-ttf",
                      "font/eot",
                      "font/ttf",
                      "font/otf",
                      "font/opentype",
                      "image/svg+xml",
                      "text/css",
                      "text/csv",
                      "text/html",
                      "text/javascript",
                      "text/js",
                      "text/plain",
                      "text/richtext",
                      "text/tab-separated-values",
                      "text/xml",
                      "text/x-script",
                      "text/x-component",
                      "text/x-java-source"
                    ]
                  },
                  "queryStringCachingBehavior": "UseQueryString"
                },
                "customDomains": [
                  {
                    "id": "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'prod-polaris-reedinpartnership-co-uk')]"
                  }
                ],
                "originGroup": {
                  "id": "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-prod-frontend-origingroup')]"
                },
                "ruleSets": [],
                "supportedProtocols": [
                  "Http",
                  "Https"
                ],
                "patternsToMatch": [
                  "/*"
                ],
                "forwardingProtocol": "HttpsOnly",
                "linkToDefaultDomain": "Disabled",
                "httpsRedirect": "Enabled",
                "enabledState": "Enabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/afdEndpoints', parameters('profiles_afd_name'), 'polaris-prod')]",
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-prod-frontend-origingroup')]",
                "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'prod-polaris-reedinpartnership-co-uk')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/afdEndpoints/routes",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-prod', 'identity-adb2c')]",
              "properties": {
                "customDomains": [
                  {
                    "id": "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'prod-id-reedinpartnership-co-uk')]"
                  }
                ],
                "originGroup": {
                  "id": "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-prod-adb2c-tenant-origin-group')]"
                },
                "ruleSets": [
                  {
                    "id": "[resourceId('Microsoft.Cdn/profiles/ruleSets', parameters('profiles_afd_name'), 'prodcorsruleset')]"
                  }
                ],
                "supportedProtocols": [
                  "Http",
                  "Https"
                ],
                "patternsToMatch": [
                  "/*"
                ],
                "forwardingProtocol": "HttpsOnly",
                "linkToDefaultDomain": "Disabled",
                "httpsRedirect": "Enabled",
                "enabledState": "Enabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/ruleSets', parameters('profiles_afd_name'), 'prodcorsruleset')]",
                "[resourceId('Microsoft.Cdn/profiles/afdEndpoints', parameters('profiles_afd_name'), 'polaris-prod')]",
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-prod-adb2c-tenant-origin-group')]",
                "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'prod-id-reedinpartnership-co-uk')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/afdEndpoints/routes",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-prod', 'identity-adb2c-custom-ui')]",
              "properties": {
                "cacheConfiguration": {
                  "compressionSettings": {
                    "isCompressionEnabled": true,
                    "contentTypesToCompress": [
                      "application/eot",
                      "application/font",
                      "application/font-sfnt",
                      "application/javascript",
                      "application/json",
                      "application/opentype",
                      "application/otf",
                      "application/pkcs7-mime",
                      "application/truetype",
                      "application/ttf",
                      "application/vnd.ms-fontobject",
                      "application/xhtml+xml",
                      "application/xml",
                      "application/xml+rss",
                      "application/x-font-opentype",
                      "application/x-font-truetype",
                      "application/x-font-ttf",
                      "application/x-httpd-cgi",
                      "application/x-javascript",
                      "application/x-mpegurl",
                      "application/x-opentype",
                      "application/x-otf",
                      "application/x-perl",
                      "application/x-ttf",
                      "font/eot",
                      "font/ttf",
                      "font/otf",
                      "font/opentype",
                      "image/svg+xml",
                      "text/css",
                      "text/csv",
                      "text/html",
                      "text/javascript",
                      "text/js",
                      "text/plain",
                      "text/richtext",
                      "text/tab-separated-values",
                      "text/xml",
                      "text/x-script",
                      "text/x-component",
                      "text/x-java-source"
                    ]
                  },
                  "queryStringCachingBehavior": "IgnoreQueryString"
                },
                "customDomains": [
                  {
                    "id": "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'prod-id-reedinpartnership-co-uk')]"
                  }
                ],
                "originGroup": {
                  "id": "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-prod-adb2c-custom-ui-origin-group')]"
                },
                "ruleSets": [
                  {
                    "id": "[resourceId('Microsoft.Cdn/profiles/ruleSets', parameters('profiles_afd_name'), 'prodcorsruleset')]"
                  }
                ],
                "supportedProtocols": [
                  "Http",
                  "Https"
                ],
                "patternsToMatch": [
                  "/reedinpartnership/ui/*"
                ],
                "forwardingProtocol": "HttpsOnly",
                "linkToDefaultDomain": "Disabled",
                "httpsRedirect": "Enabled",
                "enabledState": "Enabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/ruleSets', parameters('profiles_afd_name'), 'prodcorsruleset')]",
                "[resourceId('Microsoft.Cdn/profiles/afdEndpoints', parameters('profiles_afd_name'), 'polaris-prod')]",
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-prod-adb2c-custom-ui-origin-group')]",
                "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'prod-id-reedinpartnership-co-uk')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/afdEndpoints/routes",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-prod', 'services-users')]",
              "properties": {
                "customDomains": [
                  {
                    "id": "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'prod-polaris-reedinpartnership-co-uk')]"
                  }
                ],
                "originGroup": {
                  "id": "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-prod-spring-users-origin-group')]"
                },
                "originPath": "/",
                "ruleSets": [],
                "supportedProtocols": [
                  "Http",
                  "Https"
                ],
                "patternsToMatch": [
                  "/services/users/*"
                ],
                "forwardingProtocol": "HttpsOnly",
                "linkToDefaultDomain": "Disabled",
                "httpsRedirect": "Enabled",
                "enabledState": "Enabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/afdEndpoints', parameters('profiles_afd_name'), 'polaris-prod')]",
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-prod-spring-users-origin-group')]",
                "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'prod-polaris-reedinpartnership-co-uk')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/afdEndpoints/routes",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-prod', 'services-courses')]",
              "properties": {
                "customDomains": [
                  {
                    "id": "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'prod-polaris-reedinpartnership-co-uk')]"
                  }
                ],
                "originGroup": {
                  "id": "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-prod-spring-courses-origin-group')]"
                },
                "originPath": "/",
                "ruleSets": [],
                "supportedProtocols": [
                  "Http",
                  "Https"
                ],
                "patternsToMatch": [
                  "/services/courses/*"
                ],
                "forwardingProtocol": "HttpsOnly",
                "linkToDefaultDomain": "Disabled",
                "httpsRedirect": "Enabled",
                "enabledState": "Enabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-prod-spring-courses-origin-group')]",
                "[resourceId('Microsoft.Cdn/profiles/afdEndpoints', parameters('profiles_afd_name'), 'polaris-prod')]",
                "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'prod-polaris-reedinpartnership-co-uk')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/afdEndpoints/routes",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-prod', 'services-participants')]",
              "properties": {
                "customDomains": [
                  {
                    "id": "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'prod-polaris-reedinpartnership-co-uk')]"
                  }
                ],
                "originGroup": {
                  "id": "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-prod-spring-participants-origin-group')]"
                },
                "originPath": "/",
                "ruleSets": [],
                "supportedProtocols": [
                  "Http",
                  "Https"
                ],
                "patternsToMatch": [
                  "/services/participants/*"
                ],
                "forwardingProtocol": "HttpsOnly",
                "linkToDefaultDomain": "Disabled",
                "httpsRedirect": "Enabled",
                "enabledState": "Enabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-prod-spring-participants-origin-group')]",
                "[resourceId('Microsoft.Cdn/profiles/afdEndpoints', parameters('profiles_afd_name'), 'polaris-prod')]",
                "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'prod-polaris-reedinpartnership-co-uk')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/afdEndpoints/routes",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-prod', 'services-communication')]",
              "properties": {
                "customDomains": [
                  {
                    "id": "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'prod-polaris-reedinpartnership-co-uk')]"
                  }
                ],
                "originGroup": {
                  "id": "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-prod-spring-communication-origin-group')]"
                },
                "originPath": "/",
                "ruleSets": [],
                "supportedProtocols": [
                  "Http",
                  "Https"
                ],
                "patternsToMatch": [
                  "/services/communication/*"
                ],
                "forwardingProtocol": "HttpsOnly",
                "linkToDefaultDomain": "Disabled",
                "httpsRedirect": "Enabled",
                "enabledState": "Enabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-prod-spring-communication-origin-group')]",
                "[resourceId('Microsoft.Cdn/profiles/afdEndpoints', parameters('profiles_afd_name'), 'polaris-prod')]",
                "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'prod-polaris-reedinpartnership-co-uk')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/afdEndpoints/routes",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-prod', 'services-directus')]",
              "properties": {
                "customDomains": [
                  {
                    "id": "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'prod-polaris-reedinpartnership-co-uk')]"
                  }
                ],
                "originGroup": {
                  "id": "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-prod-spring-directus-origin-group')]"
                },
                "originPath": "/",
                "ruleSets": [],
                "supportedProtocols": [
                  "Http",
                  "Https"
                ],
                "patternsToMatch": [
                  "/services/directus/*"
                ],
                "forwardingProtocol": "HttpsOnly",
                "linkToDefaultDomain": "Disabled",
                "httpsRedirect": "Enabled",
                "enabledState": "Enabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-prod-spring-directus-origin-group')]",
                "[resourceId('Microsoft.Cdn/profiles/afdEndpoints', parameters('profiles_afd_name'), 'polaris-prod')]",
                "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'prod-polaris-reedinpartnership-co-uk')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/afdEndpoints/routes",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-prod', 'services-calendar')]",
              "properties": {
                "customDomains": [
                  {
                    "id": "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'prod-polaris-reedinpartnership-co-uk')]"
                  }
                ],
                "originGroup": {
                  "id": "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-prod-spring-calendar-origin-group')]"
                },
                "originPath": "/",
                "ruleSets": [],
                "supportedProtocols": [
                  "Http",
                  "Https"
                ],
                "patternsToMatch": [
                  "/services/calendar/*"
                ],
                "forwardingProtocol": "HttpsOnly",
                "linkToDefaultDomain": "Disabled",
                "httpsRedirect": "Enabled",
                "enabledState": "Enabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-prod-spring-calendar-origin-group')]",
                "[resourceId('Microsoft.Cdn/profiles/afdEndpoints', parameters('profiles_afd_name'), 'polaris-prod')]",
                "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'prod-polaris-reedinpartnership-co-uk')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/afdEndpoints/routes",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-prod', 'services-documents')]",
              "properties": {
                "customDomains": [
                  {
                    "id": "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'prod-polaris-reedinpartnership-co-uk')]"
                  }
                ],
                "originGroup": {
                  "id": "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-prod-spring-documents-origin-group')]"
                },
                "originPath": "/",
                "ruleSets": [],
                "supportedProtocols": [
                  "Http",
                  "Https"
                ],
                "patternsToMatch": [
                  "/services/documents/*"
                ],
                "forwardingProtocol": "HttpsOnly",
                "linkToDefaultDomain": "Disabled",
                "httpsRedirect": "Enabled",
                "enabledState": "Enabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-prod-spring-documents-origin-group')]",
                "[resourceId('Microsoft.Cdn/profiles/afdEndpoints', parameters('profiles_afd_name'), 'polaris-prod')]",
                "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'prod-polaris-reedinpartnership-co-uk')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/afdEndpoints/routes",
              "apiVersion": "2022-11-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'polaris-prod', 'services-recruitment')]",
              "properties": {
                "customDomains": [
                  {
                    "id": "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'prod-polaris-reedinpartnership-co-uk')]"
                  }
                ],
                "originGroup": {
                  "id": "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-prod-spring-recruitment-origin-group')]"
                },
                "originPath": "/",
                "ruleSets": [],
                "supportedProtocols": [
                  "Http",
                  "Https"
                ],
                "patternsToMatch": [
                  "/services/recruitment/*"
                ],
                "forwardingProtocol": "HttpsOnly",
                "linkToDefaultDomain": "Disabled",
                "httpsRedirect": "Enabled",
                "enabledState": "Enabled"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('profiles_afd_name'), 'polaris-prod-spring-recruitment-origin-group')]",
                "[resourceId('Microsoft.Cdn/profiles/afdEndpoints', parameters('profiles_afd_name'), 'polaris-prod')]",
                "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('profiles_afd_name'), 'prod-polaris-reedinpartnership-co-uk')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/ruleSets",
              "apiVersion": "2023-07-01-preview",
              "name": "[format('{0}/{1}', parameters('profiles_afd_name'), 'testcorsruleset')]",
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles', parameters('profiles_afd_name'))]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/ruleSets",
              "apiVersion": "2023-07-01-preview",
              "name": "[format('{0}/{1}', parameters('profiles_afd_name'), 'uatcorsruleset')]",
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles', parameters('profiles_afd_name'))]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/ruleSets",
              "apiVersion": "2023-07-01-preview",
              "name": "[format('{0}/{1}', parameters('profiles_afd_name'), 'trncorsruleset')]",
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles', parameters('profiles_afd_name'))]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/ruleSets",
              "apiVersion": "2023-07-01-preview",
              "name": "[format('{0}/{1}', parameters('profiles_afd_name'), 'prodcorsruleset')]",
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles', parameters('profiles_afd_name'))]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/ruleSets/rules",
              "apiVersion": "2023-07-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'testcorsruleset', 'testcorsrule')]",
              "properties": {
                "actions": [
                  {
                    "name": "ModifyResponseHeader",
                    "parameters": {
                      "headerAction": "Overwrite",
                      "headerName": "Access-Control-Allow-Origin",
                      "typeName": "DeliveryRuleHeaderActionParameters",
                      "value": "https://test.polaris.reedinpartnership.co.uk"
                    }
                  }
                ],
                "matchProcessingBehavior": "Continue"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/ruleSets', parameters('profiles_afd_name'), 'testcorsruleset')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/ruleSets/rules",
              "apiVersion": "2023-07-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'uatcorsruleset', 'uatcorsrule')]",
              "properties": {
                "actions": [
                  {
                    "name": "ModifyResponseHeader",
                    "parameters": {
                      "headerAction": "Overwrite",
                      "headerName": "Access-Control-Allow-Origin",
                      "typeName": "DeliveryRuleHeaderActionParameters",
                      "value": "https://uat.polaris.reedinpartnership.co.uk"
                    }
                  }
                ],
                "matchProcessingBehavior": "Continue"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/ruleSets', parameters('profiles_afd_name'), 'uatcorsruleset')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/ruleSets/rules",
              "apiVersion": "2023-07-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'trncorsruleset', 'trncorsrule')]",
              "properties": {
                "actions": [
                  {
                    "name": "ModifyResponseHeader",
                    "parameters": {
                      "headerAction": "Overwrite",
                      "headerName": "Access-Control-Allow-Origin",
                      "typeName": "DeliveryRuleHeaderActionParameters",
                      "value": "https://trn.polaris.reedinpartnership.co.uk"
                    }
                  }
                ],
                "matchProcessingBehavior": "Continue"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/ruleSets', parameters('profiles_afd_name'), 'trncorsruleset')]"
              ]
            },
            {
              "type": "Microsoft.Cdn/profiles/ruleSets/rules",
              "apiVersion": "2023-07-01-preview",
              "name": "[format('{0}/{1}/{2}', parameters('profiles_afd_name'), 'prodcorsruleset', 'prodcorsrule')]",
              "properties": {
                "actions": [
                  {
                    "name": "ModifyResponseHeader",
                    "parameters": {
                      "headerAction": "Overwrite",
                      "headerName": "Access-Control-Allow-Origin",
                      "typeName": "DeliveryRuleHeaderActionParameters",
                      "value": "https://polaris.reedinpartnership.co.uk"
                    }
                  }
                ],
                "matchProcessingBehavior": "Continue"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles/ruleSets', parameters('profiles_afd_name'), 'prodcorsruleset')]"
              ]
            },
            {
              "condition": "[or(or(or(not(empty(parameters('diagnosticStorageAccountId'))), not(empty(parameters('diagnosticWorkspaceId')))), not(empty(parameters('diagnosticEventHubAuthorizationRuleId')))), not(empty(parameters('diagnosticEventHubName'))))]",
              "type": "Microsoft.Insights/diagnosticSettings",
              "apiVersion": "2021-05-01-preview",
              "scope": "[format('Microsoft.Cdn/profiles/{0}', parameters('profiles_afd_name'))]",
              "name": "[format('{0}-diagnosticSettings', parameters('profiles_afd_name'))]",
              "properties": {
                "storageAccountId": "[if(empty(parameters('diagnosticStorageAccountId')), null(), parameters('diagnosticStorageAccountId'))]",
                "workspaceId": "[if(empty(parameters('diagnosticWorkspaceId')), null(), parameters('diagnosticWorkspaceId'))]",
                "eventHubAuthorizationRuleId": "[if(empty(parameters('diagnosticEventHubAuthorizationRuleId')), null(), parameters('diagnosticEventHubAuthorizationRuleId'))]",
                "eventHubName": "[if(empty(parameters('diagnosticEventHubName')), null(), parameters('diagnosticEventHubName'))]",
                "metrics": "[if(and(and(and(empty(parameters('diagnosticStorageAccountId')), empty(parameters('diagnosticWorkspaceId'))), empty(parameters('diagnosticEventHubAuthorizationRuleId'))), empty(parameters('diagnosticEventHubName'))), null(), variables('diagnosticsMetrics'))]",
                "logs": "[if(and(and(and(empty(parameters('diagnosticStorageAccountId')), empty(parameters('diagnosticWorkspaceId'))), empty(parameters('diagnosticEventHubAuthorizationRuleId'))), empty(parameters('diagnosticEventHubName'))), null(), variables('diagnosticsLogs'))]"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles', parameters('profiles_afd_name'))]"
              ]
            },
            {
              "condition": "[or(or(or(not(empty(parameters('diagnosticStorageAccountId'))), not(empty(parameters('diagnosticWorkspaceIdAudit')))), not(empty(parameters('diagnosticEventHubAuthorizationRuleId')))), not(empty(parameters('diagnosticEventHubName'))))]",
              "type": "Microsoft.Insights/diagnosticSettings",
              "apiVersion": "2021-05-01-preview",
              "scope": "[format('Microsoft.Cdn/profiles/{0}', parameters('profiles_afd_name'))]",
              "name": "[format('{0}-diagnosticSettings-audit', parameters('profiles_afd_name'))]",
              "properties": {
                "storageAccountId": "[if(empty(parameters('diagnosticStorageAccountId')), null(), parameters('diagnosticStorageAccountId'))]",
                "workspaceId": "[if(empty(parameters('diagnosticWorkspaceIdAudit')), null(), parameters('diagnosticWorkspaceIdAudit'))]",
                "eventHubAuthorizationRuleId": "[if(empty(parameters('diagnosticEventHubAuthorizationRuleId')), null(), parameters('diagnosticEventHubAuthorizationRuleId'))]",
                "eventHubName": "[if(empty(parameters('diagnosticEventHubName')), null(), parameters('diagnosticEventHubName'))]",
                "logs": [
                  {
                    "category": "FrontDoorWebApplicationFirewallLog",
                    "categoryGroup": null,
                    "enabled": true,
                    "retentionPolicy": {
                      "days": 30,
                      "enabled": false
                    }
                  }
                ]
              },
              "dependsOn": [
                "[resourceId('Microsoft.Cdn/profiles', parameters('profiles_afd_name'))]"
              ]
            }
          ]
        }
      },
      "dependsOn": [
        "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', subscription().subscriptionId, 'rg-frontdoor'), 'Microsoft.Resources/deployments', format('{0}-afdwafrules-{1}', uniqueString(deployment().name), parameters('envshared')))]",
        "[subscriptionResourceId('Microsoft.Resources/deployments', format('lawop{0}{1}-001', parameters('tstenv'), uniqueString(deployment().name)))]"
      ]
    },
    {
      "type": "Microsoft.Resources/deployments",
      "apiVersion": "2022-09-01",
      "name": "[format('{0}-afdwafrules-{1}', uniqueString(deployment().name), parameters('envshared'))]",
      "resourceGroup": "rg-frontdoor",
      "properties": {
        "expressionEvaluationOptions": {
          "scope": "inner"
        },
        "mode": "Incremental",
        "parameters": {
          "IPAllowListTEST": {
            "value": "[parameters('IPAllowListTEST')]"
          },
          "IPAllowListUAT": {
            "value": "[parameters('IPAllowListUAT')]"
          },
          "IPAllowListTRN": {
            "value": "[parameters('IPAllowListTRN')]"
          },
          "IPAllowListPROD": {
            "value": "[parameters('IPAllowListPROD')]"
          },
          "waf_tst_name": {
            "value": "[parameters('waftstname')]"
          },
          "waf_uat_name": {
            "value": "[parameters('wafuatname')]"
          },
          "waf_trn_name": {
            "value": "[parameters('waftrnname')]"
          },
          "waf_prod_name": {
            "value": "[parameters('wafprodname')]"
          }
        },
        "template": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "1.0.0.0",
          "metadata": {
            "_generator": {
              "name": "bicep",
              "version": "0.28.1.47646",
              "templateHash": "11936706437904434355"
            }
          },
          "parameters": {
            "waf_tst_name": {
              "type": "string"
            },
            "IPAllowListTEST": {
              "type": "array"
            },
            "waf_uat_name": {
              "type": "string"
            },
            "IPAllowListUAT": {
              "type": "array"
            },
            "waf_trn_name": {
              "type": "string"
            },
            "IPAllowListTRN": {
              "type": "array"
            },
            "waf_prod_name": {
              "type": "string"
            },
            "IPAllowListPROD": {
              "type": "array"
            }
          },
          "resources": [
            {
              "type": "Microsoft.Network/FrontDoorWebApplicationFirewallPolicies",
              "apiVersion": "2022-05-01",
              "name": "[parameters('waf_tst_name')]",
              "location": "Global",
              "sku": {
                "name": "Premium_AzureFrontDoor"
              },
              "properties": {
                "policySettings": {
                  "enabledState": "Enabled",
                  "mode": "Prevention",
                  "customBlockResponseStatusCode": 403,
                  "customBlockResponseBody": "WW91IGFyZSBub3QgYXV0aG9yaXNlZCB0byBhY2Nlc3MgdGhpcyByZXNvdXJjZSwgcGxlYXNlIGNvbnRhY3QgSVQgdG8gcmVxdWVzdCBhY2Nlc3Mu",
                  "requestBodyCheck": "Enabled"
                },
                "customRules": {
                  "rules": [
                    {
                      "name": "IPAllowList",
                      "enabledState": "Enabled",
                      "priority": 100,
                      "ruleType": "MatchRule",
                      "rateLimitDurationInMinutes": 1,
                      "rateLimitThreshold": 100,
                      "matchConditions": [
                        {
                          "matchVariable": "SocketAddr",
                          "operator": "IPMatch",
                          "negateCondition": true,
                          "matchValue": "[parameters('IPAllowListTEST')]",
                          "transforms": []
                        }
                      ],
                      "action": "Block"
                    }
                  ]
                },
                "managedRules": {
                  "managedRuleSets": [
                    {
                      "ruleSetType": "Microsoft_DefaultRuleSet",
                      "ruleSetVersion": "2.1",
                      "ruleSetAction": "Block",
                      "ruleGroupOverrides": [
                        {
                          "ruleGroupName": "MS-ThreatIntel-CVEs",
                          "rules": [
                            {
                              "ruleId": "99001016",
                              "enabledState": "Enabled",
                              "action": "AnomalyScoring",
                              "exclusions": []
                            },
                            {
                              "ruleId": "99001015",
                              "enabledState": "Enabled",
                              "action": "AnomalyScoring",
                              "exclusions": []
                            },
                            {
                              "ruleId": "99001014",
                              "enabledState": "Enabled",
                              "action": "AnomalyScoring",
                              "exclusions": []
                            }
                          ],
                          "exclusions": []
                        },
                        {
                          "ruleGroupName": "MS-ThreatIntel-WebShells",
                          "rules": [
                            {
                              "ruleId": "99005006",
                              "enabledState": "Enabled",
                              "action": "AnomalyScoring",
                              "exclusions": []
                            }
                          ],
                          "exclusions": []
                        },
                        {
                          "ruleGroupName": "General",
                          "rules": [
                            {
                              "ruleId": "200003",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            },
                            {
                              "ruleId": "200002",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            }
                          ],
                          "exclusions": []
                        },
                        {
                          "ruleGroupName": "MS-ThreatIntel-SQLI",
                          "rules": [
                            {
                              "ruleId": "99031004",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            },
                            {
                              "ruleId": "99031002",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            },
                            {
                              "ruleId": "99031001",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            }
                          ],
                          "exclusions": []
                        },
                        {
                          "ruleGroupName": "PROTOCOL-ATTACK",
                          "rules": [
                            {
                              "ruleId": "921200",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            }
                          ],
                          "exclusions": []
                        },
                        {
                          "ruleGroupName": "PROTOCOL-ENFORCEMENT",
                          "rules": [
                            {
                              "ruleId": "920440",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            }
                          ],
                          "exclusions": []
                        },
                        {
                          "ruleGroupName": "RCE",
                          "rules": [
                            {
                              "ruleId": "932130",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            }
                          ],
                          "exclusions": []
                        },
                        {
                          "ruleGroupName": "SQLI",
                          "rules": [
                            {
                              "ruleId": "942410",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            },
                            {
                              "ruleId": "942400",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            },
                            {
                              "ruleId": "942370",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            },
                            {
                              "ruleId": "942300",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            },
                            {
                              "ruleId": "942200",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            },
                            {
                              "ruleId": "942190",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            },
                            {
                              "ruleId": "942180",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            },
                            {
                              "ruleId": "942120",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            },
                            {
                              "ruleId": "942330",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            }
                          ],
                          "exclusions": []
                        },
                        {
                          "ruleGroupName": "XSS",
                          "rules": [
                            {
                              "ruleId": "941340",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            },
                            {
                              "ruleId": "941320",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            },
                            {
                              "ruleId": "941160",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            },
                            {
                              "ruleId": "941150",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            },
                            {
                              "ruleId": "941100",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            }
                          ],
                          "exclusions": []
                        },
                        {
                          "ruleGroupName": "PHP",
                          "rules": [
                            {
                              "ruleId": "933210",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            }
                          ],
                          "exclusions": []
                        }
                      ],
                      "exclusions": []
                    },
                    {
                      "ruleSetType": "Microsoft_BotManagerRuleSet",
                      "ruleSetVersion": "1.0",
                      "ruleGroupOverrides": [],
                      "exclusions": []
                    }
                  ]
                }
              }
            },
            {
              "type": "Microsoft.Network/FrontDoorWebApplicationFirewallPolicies",
              "apiVersion": "2022-05-01",
              "name": "[parameters('waf_uat_name')]",
              "location": "Global",
              "sku": {
                "name": "Premium_AzureFrontDoor"
              },
              "properties": {
                "policySettings": {
                  "enabledState": "Enabled",
                  "mode": "Prevention",
                  "customBlockResponseStatusCode": 403,
                  "customBlockResponseBody": "WW91IGFyZSBub3QgYXV0aG9yaXNlZCB0byBhY2Nlc3MgdGhpcyByZXNvdXJjZSwgcGxlYXNlIGNvbnRhY3QgSVQgdG8gcmVxdWVzdCBhY2Nlc3Mu",
                  "requestBodyCheck": "Enabled"
                },
                "customRules": {
                  "rules": [
                    {
                      "name": "IPAllowList",
                      "enabledState": "Enabled",
                      "priority": 100,
                      "ruleType": "MatchRule",
                      "rateLimitDurationInMinutes": 1,
                      "rateLimitThreshold": 100,
                      "matchConditions": [
                        {
                          "matchVariable": "SocketAddr",
                          "operator": "IPMatch",
                          "negateCondition": true,
                          "matchValue": "[parameters('IPAllowListUAT')]",
                          "transforms": []
                        }
                      ],
                      "action": "Block"
                    }
                  ]
                },
                "managedRules": {
                  "managedRuleSets": [
                    {
                      "ruleSetType": "Microsoft_DefaultRuleSet",
                      "ruleSetVersion": "2.1",
                      "ruleSetAction": "Block",
                      "ruleGroupOverrides": [
                        {
                          "ruleGroupName": "MS-ThreatIntel-CVEs",
                          "rules": [
                            {
                              "ruleId": "99001016",
                              "enabledState": "Enabled",
                              "action": "AnomalyScoring",
                              "exclusions": []
                            },
                            {
                              "ruleId": "99001015",
                              "enabledState": "Enabled",
                              "action": "AnomalyScoring",
                              "exclusions": []
                            },
                            {
                              "ruleId": "99001014",
                              "enabledState": "Enabled",
                              "action": "AnomalyScoring",
                              "exclusions": []
                            }
                          ],
                          "exclusions": []
                        },
                        {
                          "ruleGroupName": "MS-ThreatIntel-WebShells",
                          "rules": [
                            {
                              "ruleId": "99005006",
                              "enabledState": "Enabled",
                              "action": "AnomalyScoring",
                              "exclusions": []
                            }
                          ],
                          "exclusions": []
                        },
                        {
                          "ruleGroupName": "General",
                          "rules": [
                            {
                              "ruleId": "200003",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            },
                            {
                              "ruleId": "200002",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            }
                          ],
                          "exclusions": []
                        },
                        {
                          "ruleGroupName": "MS-ThreatIntel-SQLI",
                          "rules": [
                            {
                              "ruleId": "99031004",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            },
                            {
                              "ruleId": "99031002",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            },
                            {
                              "ruleId": "99031001",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            }
                          ],
                          "exclusions": []
                        },
                        {
                          "ruleGroupName": "PROTOCOL-ATTACK",
                          "rules": [
                            {
                              "ruleId": "921200",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            }
                          ],
                          "exclusions": []
                        },
                        {
                          "ruleGroupName": "PROTOCOL-ENFORCEMENT",
                          "rules": [
                            {
                              "ruleId": "920440",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            }
                          ],
                          "exclusions": []
                        },
                        {
                          "ruleGroupName": "RCE",
                          "rules": [
                            {
                              "ruleId": "932130",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            }
                          ],
                          "exclusions": []
                        },
                        {
                          "ruleGroupName": "SQLI",
                          "rules": [
                            {
                              "ruleId": "942410",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            },
                            {
                              "ruleId": "942400",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            },
                            {
                              "ruleId": "942370",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            },
                            {
                              "ruleId": "942300",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            },
                            {
                              "ruleId": "942200",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            },
                            {
                              "ruleId": "942190",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            },
                            {
                              "ruleId": "942180",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            },
                            {
                              "ruleId": "942120",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            },
                            {
                              "ruleId": "942330",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            }
                          ],
                          "exclusions": []
                        },
                        {
                          "ruleGroupName": "XSS",
                          "rules": [
                            {
                              "ruleId": "941340",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            },
                            {
                              "ruleId": "941320",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            },
                            {
                              "ruleId": "941160",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            },
                            {
                              "ruleId": "941150",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            },
                            {
                              "ruleId": "941100",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            }
                          ],
                          "exclusions": []
                        },
                        {
                          "ruleGroupName": "PHP",
                          "rules": [
                            {
                              "ruleId": "933210",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            }
                          ],
                          "exclusions": []
                        }
                      ],
                      "exclusions": []
                    },
                    {
                      "ruleSetType": "Microsoft_BotManagerRuleSet",
                      "ruleSetVersion": "1.0",
                      "ruleGroupOverrides": [],
                      "exclusions": []
                    }
                  ]
                }
              },
              "dependsOn": [
                "[resourceId('Microsoft.Network/FrontDoorWebApplicationFirewallPolicies', parameters('waf_tst_name'))]"
              ]
            },
            {
              "type": "Microsoft.Network/FrontDoorWebApplicationFirewallPolicies",
              "apiVersion": "2022-05-01",
              "name": "[parameters('waf_trn_name')]",
              "location": "Global",
              "sku": {
                "name": "Premium_AzureFrontDoor"
              },
              "properties": {
                "policySettings": {
                  "enabledState": "Enabled",
                  "mode": "Prevention",
                  "customBlockResponseStatusCode": 403,
                  "customBlockResponseBody": "WW91IGFyZSBub3QgYXV0aG9yaXNlZCB0byBhY2Nlc3MgdGhpcyByZXNvdXJjZSwgcGxlYXNlIGNvbnRhY3QgSVQgdG8gcmVxdWVzdCBhY2Nlc3Mu",
                  "requestBodyCheck": "Enabled"
                },
                "customRules": {
                  "rules": [
                    {
                      "name": "IPAllowList",
                      "enabledState": "Enabled",
                      "priority": 100,
                      "ruleType": "MatchRule",
                      "rateLimitDurationInMinutes": 1,
                      "rateLimitThreshold": 100,
                      "matchConditions": [
                        {
                          "matchVariable": "SocketAddr",
                          "operator": "IPMatch",
                          "negateCondition": true,
                          "matchValue": "[parameters('IPAllowListTRN')]",
                          "transforms": []
                        }
                      ],
                      "action": "Block"
                    }
                  ]
                },
                "managedRules": {
                  "managedRuleSets": [
                    {
                      "ruleSetType": "Microsoft_DefaultRuleSet",
                      "ruleSetVersion": "2.1",
                      "ruleSetAction": "Block",
                      "ruleGroupOverrides": [
                        {
                          "ruleGroupName": "MS-ThreatIntel-CVEs",
                          "rules": [
                            {
                              "ruleId": "99001016",
                              "enabledState": "Enabled",
                              "action": "AnomalyScoring",
                              "exclusions": []
                            },
                            {
                              "ruleId": "99001015",
                              "enabledState": "Enabled",
                              "action": "AnomalyScoring",
                              "exclusions": []
                            },
                            {
                              "ruleId": "99001014",
                              "enabledState": "Enabled",
                              "action": "AnomalyScoring",
                              "exclusions": []
                            }
                          ],
                          "exclusions": []
                        },
                        {
                          "ruleGroupName": "MS-ThreatIntel-WebShells",
                          "rules": [
                            {
                              "ruleId": "99005006",
                              "enabledState": "Enabled",
                              "action": "AnomalyScoring",
                              "exclusions": []
                            }
                          ],
                          "exclusions": []
                        },
                        {
                          "ruleGroupName": "General",
                          "rules": [
                            {
                              "ruleId": "200003",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            },
                            {
                              "ruleId": "200002",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            }
                          ],
                          "exclusions": []
                        },
                        {
                          "ruleGroupName": "MS-ThreatIntel-SQLI",
                          "rules": [
                            {
                              "ruleId": "99031004",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            },
                            {
                              "ruleId": "99031002",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            },
                            {
                              "ruleId": "99031001",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            }
                          ],
                          "exclusions": []
                        },
                        {
                          "ruleGroupName": "PROTOCOL-ATTACK",
                          "rules": [
                            {
                              "ruleId": "921200",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            }
                          ],
                          "exclusions": []
                        },
                        {
                          "ruleGroupName": "PROTOCOL-ENFORCEMENT",
                          "rules": [
                            {
                              "ruleId": "920440",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            }
                          ],
                          "exclusions": []
                        },
                        {
                          "ruleGroupName": "RCE",
                          "rules": [
                            {
                              "ruleId": "932130",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            }
                          ],
                          "exclusions": []
                        },
                        {
                          "ruleGroupName": "SQLI",
                          "rules": [
                            {
                              "ruleId": "942410",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            },
                            {
                              "ruleId": "942400",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            },
                            {
                              "ruleId": "942370",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            },
                            {
                              "ruleId": "942300",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            },
                            {
                              "ruleId": "942200",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            },
                            {
                              "ruleId": "942190",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            },
                            {
                              "ruleId": "942180",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            },
                            {
                              "ruleId": "942120",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            },
                            {
                              "ruleId": "942330",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            }
                          ],
                          "exclusions": []
                        },
                        {
                          "ruleGroupName": "XSS",
                          "rules": [
                            {
                              "ruleId": "941340",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            },
                            {
                              "ruleId": "941320",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            },
                            {
                              "ruleId": "941160",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            },
                            {
                              "ruleId": "941150",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            },
                            {
                              "ruleId": "941100",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            }
                          ],
                          "exclusions": []
                        },
                        {
                          "ruleGroupName": "PHP",
                          "rules": [
                            {
                              "ruleId": "933210",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            }
                          ],
                          "exclusions": []
                        }
                      ],
                      "exclusions": []
                    },
                    {
                      "ruleSetType": "Microsoft_BotManagerRuleSet",
                      "ruleSetVersion": "1.0",
                      "ruleGroupOverrides": [],
                      "exclusions": []
                    }
                  ]
                }
              },
              "dependsOn": [
                "[resourceId('Microsoft.Network/FrontDoorWebApplicationFirewallPolicies', parameters('waf_uat_name'))]"
              ]
            },
            {
              "type": "Microsoft.Network/FrontDoorWebApplicationFirewallPolicies",
              "apiVersion": "2022-05-01",
              "name": "[parameters('waf_prod_name')]",
              "location": "Global",
              "sku": {
                "name": "Premium_AzureFrontDoor"
              },
              "properties": {
                "policySettings": {
                  "enabledState": "Enabled",
                  "mode": "Prevention",
                  "customBlockResponseStatusCode": 403,
                  "customBlockResponseBody": "WW91IGFyZSBub3QgYXV0aG9yaXNlZCB0byBhY2Nlc3MgdGhpcyByZXNvdXJjZSwgcGxlYXNlIGNvbnRhY3QgSVQgdG8gcmVxdWVzdCBhY2Nlc3Mu",
                  "requestBodyCheck": "Enabled"
                },
                "customRules": {
                  "rules": [
                    {
                      "name": "IPAllowList",
                      "enabledState": "Enabled",
                      "priority": 100,
                      "ruleType": "MatchRule",
                      "rateLimitDurationInMinutes": 1,
                      "rateLimitThreshold": 100,
                      "matchConditions": [
                        {
                          "matchVariable": "SocketAddr",
                          "operator": "IPMatch",
                          "negateCondition": true,
                          "matchValue": "[parameters('IPAllowListPROD')]",
                          "transforms": []
                        }
                      ],
                      "action": "Block"
                    }
                  ]
                },
                "managedRules": {
                  "managedRuleSets": [
                    {
                      "ruleSetType": "Microsoft_DefaultRuleSet",
                      "ruleSetVersion": "2.1",
                      "ruleSetAction": "Block",
                      "ruleGroupOverrides": [
                        {
                          "ruleGroupName": "MS-ThreatIntel-CVEs",
                          "rules": [
                            {
                              "ruleId": "99001016",
                              "enabledState": "Enabled",
                              "action": "AnomalyScoring",
                              "exclusions": []
                            },
                            {
                              "ruleId": "99001015",
                              "enabledState": "Enabled",
                              "action": "AnomalyScoring",
                              "exclusions": []
                            },
                            {
                              "ruleId": "99001014",
                              "enabledState": "Enabled",
                              "action": "AnomalyScoring",
                              "exclusions": []
                            }
                          ],
                          "exclusions": []
                        },
                        {
                          "ruleGroupName": "MS-ThreatIntel-WebShells",
                          "rules": [
                            {
                              "ruleId": "99005006",
                              "enabledState": "Enabled",
                              "action": "AnomalyScoring",
                              "exclusions": []
                            }
                          ],
                          "exclusions": []
                        },
                        {
                          "ruleGroupName": "General",
                          "rules": [
                            {
                              "ruleId": "200003",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            },
                            {
                              "ruleId": "200002",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            }
                          ],
                          "exclusions": []
                        },
                        {
                          "ruleGroupName": "MS-ThreatIntel-SQLI",
                          "rules": [
                            {
                              "ruleId": "99031004",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            },
                            {
                              "ruleId": "99031002",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            },
                            {
                              "ruleId": "99031001",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            }
                          ],
                          "exclusions": []
                        },
                        {
                          "ruleGroupName": "PROTOCOL-ATTACK",
                          "rules": [
                            {
                              "ruleId": "921200",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            }
                          ],
                          "exclusions": []
                        },
                        {
                          "ruleGroupName": "PROTOCOL-ENFORCEMENT",
                          "rules": [
                            {
                              "ruleId": "920440",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            }
                          ],
                          "exclusions": []
                        },
                        {
                          "ruleGroupName": "RCE",
                          "rules": [
                            {
                              "ruleId": "932130",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            }
                          ],
                          "exclusions": []
                        },
                        {
                          "ruleGroupName": "SQLI",
                          "rules": [
                            {
                              "ruleId": "942410",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            },
                            {
                              "ruleId": "942400",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            },
                            {
                              "ruleId": "942370",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            },
                            {
                              "ruleId": "942300",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            },
                            {
                              "ruleId": "942200",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            },
                            {
                              "ruleId": "942190",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            },
                            {
                              "ruleId": "942180",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            },
                            {
                              "ruleId": "942120",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            },
                            {
                              "ruleId": "942330",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            }
                          ],
                          "exclusions": []
                        },
                        {
                          "ruleGroupName": "XSS",
                          "rules": [
                            {
                              "ruleId": "941340",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            },
                            {
                              "ruleId": "941320",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            },
                            {
                              "ruleId": "941160",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            },
                            {
                              "ruleId": "941150",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            },
                            {
                              "ruleId": "941100",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            }
                          ],
                          "exclusions": []
                        },
                        {
                          "ruleGroupName": "PHP",
                          "rules": [
                            {
                              "ruleId": "933210",
                              "enabledState": "Enabled",
                              "action": "Log",
                              "exclusions": []
                            }
                          ],
                          "exclusions": []
                        }
                      ],
                      "exclusions": []
                    },
                    {
                      "ruleSetType": "Microsoft_BotManagerRuleSet",
                      "ruleSetVersion": "1.0",
                      "ruleGroupOverrides": [],
                      "exclusions": []
                    }
                  ]
                }
              },
              "dependsOn": [
                "[resourceId('Microsoft.Network/FrontDoorWebApplicationFirewallPolicies', parameters('waf_uat_name'))]"
              ]
            }
          ],
          "outputs": {
            "wafpolicyidtest": {
              "type": "string",
              "value": "[resourceId('Microsoft.Network/FrontDoorWebApplicationFirewallPolicies', parameters('waf_tst_name'))]"
            },
            "wafpolicytiduat": {
              "type": "string",
              "value": "[resourceId('Microsoft.Network/FrontDoorWebApplicationFirewallPolicies', parameters('waf_uat_name'))]"
            },
            "wafpolicyidtrn": {
              "type": "string",
              "value": "[resourceId('Microsoft.Network/FrontDoorWebApplicationFirewallPolicies', parameters('waf_trn_name'))]"
            },
            "wafpolicyidprod": {
              "type": "string",
              "value": "[resourceId('Microsoft.Network/FrontDoorWebApplicationFirewallPolicies', parameters('waf_prod_name'))]"
            }
          }
        }
      }
    }
  ]
}